{"version":3,"sources":["webpack://microsoftTeams/webpack/universalModuleDefinition","webpack://microsoftTeams/webpack/bootstrap","webpack://microsoftTeams/./src/internal/communication.ts","webpack://microsoftTeams/./src/internal/internalAPIs.ts","webpack://microsoftTeams/./src/public/constants.ts","webpack://microsoftTeams/./src/internal/handlers.ts","webpack://microsoftTeams/./src/internal/constants.ts","webpack://microsoftTeams/./src/internal/utils.ts","webpack://microsoftTeams/./src/internal/globalVars.ts","webpack://microsoftTeams/./src/public/interfaces.ts","webpack://microsoftTeams/./src/public/index.ts","webpack://microsoftTeams/./node_modules/uuid/lib/rng-browser.js","webpack://microsoftTeams/./node_modules/uuid/lib/bytesToUuid.js","webpack://microsoftTeams/./src/public/authentication.ts","webpack://microsoftTeams/./src/public/settings.ts","webpack://microsoftTeams/./src/private/logs.ts","webpack://microsoftTeams/./src/private/privateAPIs.ts","webpack://microsoftTeams/./src/private/menus.ts","webpack://microsoftTeams/./src/public/appWindow.ts","webpack://microsoftTeams/./src/public/media.ts","webpack://microsoftTeams/./src/internal/mediaUtil.ts","webpack://microsoftTeams/./src/index.ts","webpack://microsoftTeams/./src/private/index.ts","webpack://microsoftTeams/./src/private/bot.ts","webpack://microsoftTeams/./node_modules/uuid/index.js","webpack://microsoftTeams/./node_modules/uuid/v1.js","webpack://microsoftTeams/./node_modules/uuid/v4.js","webpack://microsoftTeams/./src/public/appInitialization.ts","webpack://microsoftTeams/./src/public/publicAPIs.ts","webpack://microsoftTeams/./src/public/navigation.ts","webpack://microsoftTeams/./src/public/tasks.ts","webpack://microsoftTeams/./src/public/location.ts","webpack://microsoftTeams/./src/public/meeting.ts","webpack://microsoftTeams/./src/public/monetization.ts","webpack://microsoftTeams/./src/public/people.ts","webpack://microsoftTeams/./src/public/video.ts","webpack://microsoftTeams/./src/public/sharing.ts","webpack://microsoftTeams/./src/private/interfaces.ts","webpack://microsoftTeams/./src/private/conversations.ts","webpack://microsoftTeams/./src/private/meetingRoom.ts","webpack://microsoftTeams/./src/private/remoteCamera.ts","webpack://microsoftTeams/./src/private/files.ts","webpack://microsoftTeams/./src/private/appEntity.ts","webpack://microsoftTeams/./src/private/teams.ts"],"names":[],"mappings":"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","file":"MicrosoftTeams.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"microsoftTeams\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"microsoftTeams\"] = factory();\n\telse\n\t\troot[\"microsoftTeams\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 19);\n","import { validOriginRegExp, version } from './constants';\r\nimport { GlobalVars } from './globalVars';\r\nimport { callHandler } from './handlers';\r\nimport { MessageResponse, MessageRequest, ExtendedWindow, DOMMessageEvent } from './interfaces';\r\n\r\nexport class Communication {\r\n  public static currentWindow: Window | any;\r\n  public static parentOrigin: string;\r\n  public static parentWindow: Window | any;\r\n  public static childWindow: Window;\r\n  public static childOrigin: string;\r\n}\r\n\r\nclass CommunicationPrivate {\r\n  public static parentMessageQueue: MessageRequest[] = [];\r\n  public static childMessageQueue: MessageRequest[] = [];\r\n  public static nextMessageId: number = 0;\r\n  public static callbacks: {\r\n    [id: number]: Function;\r\n  } = {};\r\n  public static messageListener: Function;\r\n}\r\n\r\nexport function initializeCommunication(callback: Function, validMessageOrigins: string[] | undefined): void {\r\n  // Listen for messages post to our window\r\n  CommunicationPrivate.messageListener = (evt: DOMMessageEvent): void => processMessage(evt);\r\n\r\n  // If we are in an iframe, our parent window is the one hosting us (i.e., window.parent); otherwise,\r\n  // it's the window that opened us (i.e., window.opener)\r\n  Communication.currentWindow = Communication.currentWindow || window;\r\n  Communication.parentWindow =\r\n    Communication.currentWindow.parent !== Communication.currentWindow.self\r\n      ? Communication.currentWindow.parent\r\n      : Communication.currentWindow.opener;\r\n\r\n  // Listen to messages from the parent or child frame.\r\n  // Frameless windows will only receive this event from child frames and if validMessageOrigins is passed.\r\n  if (Communication.parentWindow || validMessageOrigins) {\r\n    Communication.currentWindow.addEventListener('message', CommunicationPrivate.messageListener, false);\r\n  }\r\n\r\n  if (!Communication.parentWindow) {\r\n    GlobalVars.isFramelessWindow = true;\r\n    // @ts-ignore: window as ExtendedWindow\r\n    (window as ExtendedWindow).onNativeMessage = handleParentMessage;\r\n  }\r\n\r\n  try {\r\n    // Send the initialized message to any origin, because at this point we most likely don't know the origin\r\n    // of the parent window, and this message contains no data that could pose a security risk.\r\n    Communication.parentOrigin = '*';\r\n    sendMessageToParent('initialize', [version], callback);\r\n  } finally {\r\n    Communication.parentOrigin = null;\r\n  }\r\n}\r\n\r\nexport function uninitializeCommunication(): void {\r\n  Communication.currentWindow.removeEventListener('message', CommunicationPrivate.messageListener, false);\r\n\r\n  Communication.parentWindow = null;\r\n  Communication.parentOrigin = null;\r\n  Communication.childWindow = null;\r\n  Communication.childOrigin = null;\r\n  CommunicationPrivate.parentMessageQueue = [];\r\n  CommunicationPrivate.childMessageQueue = [];\r\n  CommunicationPrivate.nextMessageId = 0;\r\n  CommunicationPrivate.callbacks = {};\r\n}\r\n\r\n/**\r\n * Send a message to parent. Uses nativeInterface on mobile to communicate with parent context\r\n */\r\nexport function sendMessageToParent(actionName: string, callback?: Function): void;\r\n/**\r\n * Send a message to parent. Uses nativeInterface on mobile to communicate with parent context\r\n */\r\nexport function sendMessageToParent(actionName: string, args: any[], callback?: Function): void;\r\nexport function sendMessageToParent(actionName: string, argsOrCallback?: any[] | Function, callback?: Function): void {\r\n  let args: any[] | undefined;\r\n  if (argsOrCallback instanceof Function) {\r\n    callback = argsOrCallback;\r\n  } else if (argsOrCallback instanceof Array) {\r\n    args = argsOrCallback;\r\n  }\r\n\r\n  const targetWindow = Communication.parentWindow;\r\n  const request = createMessageRequest(actionName, args);\r\n  if (GlobalVars.isFramelessWindow) {\r\n    if (Communication.currentWindow && Communication.currentWindow.nativeInterface) {\r\n      (Communication.currentWindow as ExtendedWindow).nativeInterface.framelessPostMessage(JSON.stringify(request));\r\n    }\r\n  } else {\r\n    const targetOrigin = getTargetOrigin(targetWindow);\r\n\r\n    // If the target window isn't closed and we already know its origin, send the message right away; otherwise,\r\n    // queue the message and send it after the origin is established\r\n    if (targetWindow && targetOrigin) {\r\n      targetWindow.postMessage(request, targetOrigin);\r\n    } else {\r\n      getTargetMessageQueue(targetWindow).push(request);\r\n    }\r\n  }\r\n\r\n  if (callback) {\r\n    CommunicationPrivate.callbacks[request.id] = callback;\r\n  }\r\n}\r\n\r\nfunction processMessage(evt: DOMMessageEvent): void {\r\n  // Process only if we received a valid message\r\n  if (!evt || !evt.data || typeof evt.data !== 'object') {\r\n    return;\r\n  }\r\n\r\n  // Process only if the message is coming from a different window and a valid origin\r\n  // valid origins are either a pre-known\r\n  const messageSource = evt.source || (evt.originalEvent && evt.originalEvent.source);\r\n  const messageOrigin = evt.origin || (evt.originalEvent && evt.originalEvent.origin);\r\n  if (!shouldProcessMessage(messageSource, messageOrigin)) {\r\n    return;\r\n  }\r\n\r\n  // Update our parent and child relationships based on this message\r\n  updateRelationships(messageSource, messageOrigin);\r\n\r\n  // Handle the message\r\n  if (messageSource === Communication.parentWindow) {\r\n    handleParentMessage(evt);\r\n  } else if (messageSource === Communication.childWindow) {\r\n    handleChildMessage(evt);\r\n  }\r\n}\r\n\r\n/**\r\n * Validates the message source and origin, if it should be processed\r\n */\r\nfunction shouldProcessMessage(messageSource: Window, messageOrigin: string): boolean {\r\n  // Process if message source is a different window and if origin is either in\r\n  // Teams' pre-known whitelist or supplied as valid origin by user during initialization\r\n  if (Communication.currentWindow && messageSource === Communication.currentWindow) {\r\n    return false;\r\n  } else if (\r\n    Communication.currentWindow &&\r\n    Communication.currentWindow.location &&\r\n    messageOrigin &&\r\n    messageOrigin === Communication.currentWindow.location.origin\r\n  ) {\r\n    return true;\r\n  } else if (\r\n    validOriginRegExp.test(messageOrigin.toLowerCase()) ||\r\n    (GlobalVars.additionalValidOriginsRegexp &&\r\n      GlobalVars.additionalValidOriginsRegexp.test(messageOrigin.toLowerCase()))\r\n  ) {\r\n    return true;\r\n  }\r\n  return false;\r\n}\r\n\r\nfunction updateRelationships(messageSource: Window, messageOrigin: string): void {\r\n  // Determine whether the source of the message is our parent or child and update our\r\n  // window and origin pointer accordingly\r\n  // For frameless windows (i.e mobile), there is no parent frame, so the message must be from the child.\r\n  if (\r\n    !GlobalVars.isFramelessWindow &&\r\n    (!Communication.parentWindow || Communication.parentWindow.closed || messageSource === Communication.parentWindow)\r\n  ) {\r\n    Communication.parentWindow = messageSource;\r\n    Communication.parentOrigin = messageOrigin;\r\n  } else if (\r\n    !Communication.childWindow ||\r\n    Communication.childWindow.closed ||\r\n    messageSource === Communication.childWindow\r\n  ) {\r\n    Communication.childWindow = messageSource;\r\n    Communication.childOrigin = messageOrigin;\r\n  }\r\n\r\n  // Clean up pointers to closed parent and child windows\r\n  if (Communication.parentWindow && Communication.parentWindow.closed) {\r\n    Communication.parentWindow = null;\r\n    Communication.parentOrigin = null;\r\n  }\r\n  if (Communication.childWindow && Communication.childWindow.closed) {\r\n    Communication.childWindow = null;\r\n    Communication.childOrigin = null;\r\n  }\r\n\r\n  // If we have any messages in our queue, send them now\r\n  flushMessageQueue(Communication.parentWindow);\r\n  flushMessageQueue(Communication.childWindow);\r\n}\r\n\r\nfunction handleParentMessage(evt: DOMMessageEvent): void {\r\n  if ('id' in evt.data && typeof evt.data.id === 'number') {\r\n    // Call any associated Communication.callbacks\r\n    const message = evt.data as MessageResponse;\r\n    const callback = CommunicationPrivate.callbacks[message.id];\r\n    if (callback) {\r\n      callback.apply(null, [...message.args, message.isPartialResponse]);\r\n\r\n      // Remove the callback to ensure that the callback is called only once and to free up memory if response is a complete response\r\n      if (!isPartialResponse(evt)) {\r\n        delete CommunicationPrivate.callbacks[message.id];\r\n      }\r\n    }\r\n  } else if ('func' in evt.data && typeof evt.data.func === 'string') {\r\n    // Delegate the request to the proper handler\r\n    const message = evt.data as MessageRequest;\r\n    callHandler(message.func, message.args);\r\n  }\r\n}\r\n\r\nfunction isPartialResponse(evt: DOMMessageEvent): boolean {\r\n  return evt.data.isPartialResponse === true;\r\n}\r\n\r\nfunction handleChildMessage(evt: DOMMessageEvent): void {\r\n  if ('id' in evt.data && 'func' in evt.data) {\r\n    // Try to delegate the request to the proper handler, if defined\r\n    const message = evt.data as MessageRequest;\r\n    const [called, result] = callHandler(message.func, message.args);\r\n    if (called && typeof result !== 'undefined') {\r\n      sendMessageResponseToChild(message.id, Array.isArray(result) ? result : [result]);\r\n    } else {\r\n      // No handler, proxy to parent\r\n      // tslint:disable-next-line:no-any\r\n      sendMessageToParent(message.func, message.args, (...args: any[]): void => {\r\n        if (Communication.childWindow) {\r\n          const isPartialResponse = args.pop();\r\n          sendMessageResponseToChild(message.id, args, isPartialResponse);\r\n        }\r\n      });\r\n    }\r\n  }\r\n}\r\n\r\nfunction getTargetMessageQueue(targetWindow: Window): MessageRequest[] {\r\n  return targetWindow === Communication.parentWindow\r\n    ? CommunicationPrivate.parentMessageQueue\r\n    : targetWindow === Communication.childWindow\r\n    ? CommunicationPrivate.childMessageQueue\r\n    : [];\r\n}\r\n\r\nfunction getTargetOrigin(targetWindow: Window): string {\r\n  return targetWindow === Communication.parentWindow\r\n    ? Communication.parentOrigin\r\n    : targetWindow === Communication.childWindow\r\n    ? Communication.childOrigin\r\n    : null;\r\n}\r\n\r\nfunction flushMessageQueue(targetWindow: Window | any): void {\r\n  const targetOrigin = getTargetOrigin(targetWindow);\r\n  const targetMessageQueue = getTargetMessageQueue(targetWindow);\r\n  while (targetWindow && targetOrigin && targetMessageQueue.length > 0) {\r\n    targetWindow.postMessage(targetMessageQueue.shift(), targetOrigin);\r\n  }\r\n}\r\n\r\nexport function waitForMessageQueue(targetWindow: Window, callback: () => void): void {\r\n  const messageQueueMonitor = Communication.currentWindow.setInterval(() => {\r\n    if (getTargetMessageQueue(targetWindow).length === 0) {\r\n      clearInterval(messageQueueMonitor);\r\n      callback();\r\n    }\r\n  }, 100);\r\n}\r\n\r\n/**\r\n * Send a response to child for a message request that was from child\r\n */\r\nfunction sendMessageResponseToChild(\r\n  id: number,\r\n  // tslint:disable-next-line:no-any\r\n  args?: any[],\r\n  isPartialResponse?: boolean,\r\n): void {\r\n  const targetWindow = Communication.childWindow;\r\n  const response = createMessageResponse(id, args, isPartialResponse);\r\n  const targetOrigin = getTargetOrigin(targetWindow);\r\n  if (targetWindow && targetOrigin) {\r\n    targetWindow.postMessage(response, targetOrigin);\r\n  }\r\n}\r\n\r\n/**\r\n * Send a custom message object that can be sent to child window,\r\n * instead of a response message to a child\r\n */\r\nexport function sendMessageEventToChild(\r\n  actionName: string,\r\n  // tslint:disable-next-line: no-any\r\n  args?: any[],\r\n): void {\r\n  const targetWindow = Communication.childWindow;\r\n  const customEvent = createMessageEvent(actionName, args);\r\n  const targetOrigin = getTargetOrigin(targetWindow);\r\n\r\n  // If the target window isn't closed and we already know its origin, send the message right away; otherwise,\r\n  // queue the message and send it after the origin is established\r\n  if (targetWindow && targetOrigin) {\r\n    targetWindow.postMessage(customEvent, targetOrigin);\r\n  } else {\r\n    getTargetMessageQueue(targetWindow).push(customEvent);\r\n  }\r\n}\r\n\r\n// tslint:disable-next-line:no-any\r\nfunction createMessageRequest(func: string, args: any[]): MessageRequest {\r\n  return {\r\n    id: CommunicationPrivate.nextMessageId++,\r\n    func: func,\r\n    timestamp: Date.now(),\r\n    args: args || [],\r\n  };\r\n}\r\n\r\n// tslint:disable-next-line:no-any\r\nfunction createMessageResponse(id: number, args: any[], isPartialResponse: boolean): MessageResponse {\r\n  return {\r\n    id: id,\r\n    args: args || [],\r\n    isPartialResponse,\r\n  };\r\n}\r\n\r\n/**\r\n * Creates a message object without any id, used for custom actions being sent to child frame/window\r\n */\r\n// tslint:disable-next-line:no-any\r\nfunction createMessageEvent(func: string, args: any[]): MessageRequest {\r\n  return {\r\n    func: func,\r\n    args: args || [],\r\n  };\r\n}\r\n","import { userOriginUrlValidationRegExp, defaultSDKVersionForCompatCheck } from './constants';\r\nimport { GlobalVars } from './globalVars';\r\nimport { generateRegExpFromUrls, compareSDKVersions } from './utils';\r\n\r\nexport function ensureInitialized(...expectedFrameContexts: string[]): void {\r\n  if (!GlobalVars.initializeCalled) {\r\n    throw new Error('The library has not yet been initialized');\r\n  }\r\n\r\n  if (GlobalVars.frameContext && expectedFrameContexts && expectedFrameContexts.length > 0) {\r\n    let found = false;\r\n    for (let i = 0; i < expectedFrameContexts.length; i++) {\r\n      if (expectedFrameContexts[i] === GlobalVars.frameContext) {\r\n        found = true;\r\n        break;\r\n      }\r\n    }\r\n\r\n    if (!found) {\r\n      throw new Error(\"This call is not allowed in the '\" + GlobalVars.frameContext + \"' context\");\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Checks whether the platform has knowledge of this API by doing a comparison\r\n * on API required version and platform supported version of the SDK\r\n * @param requiredVersion SDK version required by the API\r\n */\r\nexport function isAPISupportedByPlatform(requiredVersion: string = defaultSDKVersionForCompatCheck): boolean {\r\n  const value = compareSDKVersions(GlobalVars.clientSupportedSDKVersion, requiredVersion);\r\n  if (isNaN(value)) {\r\n    return false;\r\n  }\r\n  return value >= 0;\r\n}\r\n\r\n/**\r\n * Processes the valid origins specifuied by the user, de-duplicates and converts them into a regexp\r\n * which is used later for message source/origin validation\r\n */\r\nexport function processAdditionalValidOrigins(validMessageOrigins: string[]): void {\r\n  let combinedOriginUrls = GlobalVars.additionalValidOrigins.concat(\r\n    validMessageOrigins.filter((_origin: string) => {\r\n      return typeof _origin === 'string' && userOriginUrlValidationRegExp.test(_origin);\r\n    }),\r\n  );\r\n  let dedupUrls: { [url: string]: boolean } = {};\r\n  combinedOriginUrls = combinedOriginUrls.filter(_originUrl => {\r\n    if (dedupUrls[_originUrl]) {\r\n      return false;\r\n    }\r\n    dedupUrls[_originUrl] = true;\r\n    return true;\r\n  });\r\n  GlobalVars.additionalValidOrigins = combinedOriginUrls;\r\n  if (GlobalVars.additionalValidOrigins.length > 0) {\r\n    GlobalVars.additionalValidOriginsRegexp = generateRegExpFromUrls(GlobalVars.additionalValidOrigins);\r\n  } else {\r\n    GlobalVars.additionalValidOriginsRegexp = null;\r\n  }\r\n}\r\n","export enum HostClientType {\r\n  desktop = 'desktop',\r\n  web = 'web',\r\n  android = 'android',\r\n  ios = 'ios',\r\n  /**\r\n   * @deprecated Use teamsRoomsWindows instead.\r\n   */\r\n  rigel = 'rigel',\r\n  surfaceHub = 'surfaceHub',\r\n  teamsRoomsWindows = 'teamsRoomsWindows',\r\n  teamsRoomsAndroid = 'teamsRoomsAndroid',\r\n  teamsPhones = 'teamsPhones',\r\n  teamsDisplays = 'teamsDisplays',\r\n}\r\n\r\n// Ensure these declarations stay in sync with the framework.\r\nexport enum FrameContexts {\r\n  settings = 'settings',\r\n  content = 'content',\r\n  authentication = 'authentication',\r\n  remove = 'remove',\r\n  task = 'task',\r\n  sidePanel = 'sidePanel',\r\n  stage = 'stage',\r\n  meetingStage = 'meetingStage',\r\n}\r\n\r\n/**\r\n * Indicates the team type, currently used to distinguish between different team\r\n * types in Office 365 for Education (team types 1, 2, 3, and 4).\r\n */\r\nexport enum TeamType {\r\n  Standard = 0,\r\n  Edu = 1,\r\n  Class = 2,\r\n  Plc = 3,\r\n  Staff = 4,\r\n}\r\n\r\n/**\r\n * Indicates the various types of roles of a user in a team.\r\n */\r\nexport enum UserTeamRole {\r\n  Admin = 0,\r\n  User = 1,\r\n  Guest = 2,\r\n}\r\n\r\n/**\r\n * Task module dimension enum\r\n */\r\nexport enum TaskModuleDimension {\r\n  Large = 'large',\r\n  Medium = 'medium',\r\n  Small = 'small',\r\n}\r\n\r\n/**\r\n * The type of the channel with which the content is associated.\r\n */\r\nexport enum ChannelType {\r\n  Regular = 'Regular',\r\n  Private = 'Private',\r\n  Shared = 'Shared',\r\n}\r\n","import { LoadContext, navigateBack } from '../public';\r\nimport { Communication, sendMessageEventToChild, sendMessageToParent } from './communication';\r\n\r\nclass HandlersPrivate {\r\n  public static handlers: {\r\n    [func: string]: Function;\r\n  } = {};\r\n  public static themeChangeHandler: (theme: string) => void;\r\n  public static backButtonPressHandler: () => boolean;\r\n  public static focusEnterHandler: (navigateForward: boolean) => void;\r\n  public static loadHandler: (context: LoadContext) => void;\r\n  public static beforeUnloadHandler: (readyToUnload: () => void) => boolean;\r\n}\r\n\r\nexport function initializeHandlers(): void {\r\n  // ::::::::::::::::::::MicrosoftTeams SDK Internal :::::::::::::::::\r\n  HandlersPrivate.handlers['themeChange'] = handleThemeChange;\r\n  HandlersPrivate.handlers['backButtonPress'] = handleBackButtonPress;\r\n  HandlersPrivate.handlers['load'] = handleLoad;\r\n  HandlersPrivate.handlers['beforeUnload'] = handleBeforeUnload;\r\n  HandlersPrivate.handlers['focusEnter'] = handleFocusEnter;\r\n}\r\n\r\nexport function callHandler(name: string, args?: any[]): [true, any] | [false, undefined] {\r\n  const handler = HandlersPrivate.handlers[name];\r\n  if (handler) {\r\n    const result = handler.apply(this, args);\r\n    return [true, result];\r\n  } else {\r\n    return [false, undefined];\r\n  }\r\n}\r\n\r\nexport function registerHandler(name: string, handler: Function, sendMessage: boolean = true, args: any[] = []): void {\r\n  if (handler) {\r\n    HandlersPrivate.handlers[name] = handler;\r\n    sendMessage && sendMessageToParent('registerHandler', [name, ...args]);\r\n  } else {\r\n    delete HandlersPrivate.handlers[name];\r\n  }\r\n}\r\n\r\nexport function removeHandler(name: string): void {\r\n  delete HandlersPrivate.handlers[name];\r\n}\r\n\r\nexport function registerOnThemeChangeHandler(handler: (theme: string) => void): void {\r\n  HandlersPrivate.themeChangeHandler = handler;\r\n  handler && sendMessageToParent('registerHandler', ['themeChange']);\r\n}\r\n\r\nexport function handleThemeChange(theme: string): void {\r\n  if (HandlersPrivate.themeChangeHandler) {\r\n    HandlersPrivate.themeChangeHandler(theme);\r\n  }\r\n\r\n  if (Communication.childWindow) {\r\n    sendMessageEventToChild('themeChange', [theme]);\r\n  }\r\n}\r\n\r\nexport function registerBackButtonHandler(handler: () => boolean): void {\r\n  HandlersPrivate.backButtonPressHandler = handler;\r\n  handler && sendMessageToParent('registerHandler', ['backButton']);\r\n}\r\n\r\nfunction handleBackButtonPress(): void {\r\n  if (!HandlersPrivate.backButtonPressHandler || !HandlersPrivate.backButtonPressHandler()) {\r\n    navigateBack();\r\n  }\r\n}\r\n\r\nexport function registerFocusEnterHandler(handler: (navigateForward: boolean) => void): void {\r\n  HandlersPrivate.focusEnterHandler = handler;\r\n  handler && sendMessageToParent('registerHandler', ['focusEnter']);\r\n}\r\n\r\nfunction handleFocusEnter(navigateForward: boolean): void {\r\n  if (HandlersPrivate.focusEnterHandler) {\r\n    HandlersPrivate.focusEnterHandler(navigateForward);\r\n  }\r\n}\r\n\r\nexport function registerOnLoadHandler(handler: (context: LoadContext) => void): void {\r\n  HandlersPrivate.loadHandler = handler;\r\n  handler && sendMessageToParent('registerHandler', ['load']);\r\n}\r\n\r\nfunction handleLoad(context: LoadContext): void {\r\n  if (HandlersPrivate.loadHandler) {\r\n    HandlersPrivate.loadHandler(context);\r\n  }\r\n\r\n  if (Communication.childWindow) {\r\n    sendMessageEventToChild('load', [context]);\r\n  }\r\n}\r\n\r\nexport function registerBeforeUnloadHandler(handler: (readyToUnload: () => void) => boolean): void {\r\n  HandlersPrivate.beforeUnloadHandler = handler;\r\n  handler && sendMessageToParent('registerHandler', ['beforeUnload']);\r\n}\r\n\r\nfunction handleBeforeUnload(): void {\r\n  const readyToUnload = (): void => {\r\n    sendMessageToParent('readyToUnload', []);\r\n  };\r\n\r\n  if (!HandlersPrivate.beforeUnloadHandler || !HandlersPrivate.beforeUnloadHandler(readyToUnload)) {\r\n    readyToUnload();\r\n  }\r\n}\r\n","import { generateRegExpFromUrls } from './utils';\r\n\r\nexport const version = '1.10.0';\r\n/**\r\n * The SDK version when all SDK APIs started to check platform compatibility for the APIs was 1.6.0.\r\n * Modified to 2.0.1 which is hightest till now so that if any client doesn't pass version in initialize function, it will be set to highest.\r\n * Mobile clients are passing versions, hence will be applicable to web and desktop clients only.\r\n */\r\nexport const defaultSDKVersionForCompatCheck = '2.0.1';\r\n\r\n/**\r\n * This is the SDK version when selectMedia API - VideoAndImage is supported on mobile.\r\n */\r\nexport const videoAndImageMediaAPISupportVersion = '2.0.2';\r\n\r\n/**\r\n * Minimum required client supported version for {@link getUserJoinedTeams} to be supported on {@link HostClientType.android}\r\n */\r\nexport const getUserJoinedTeamsSupportedAndroidClientVersion = '2.0.1';\r\n\r\n/**\r\n * This is the SDK version when location APIs (getLocation and showLocation) are supported.\r\n */\r\nexport const locationAPIsRequiredVersion = '1.9.0';\r\n\r\n/**\r\n * This is the SDK version when people picker API is supported on mobile.\r\n */\r\nexport const peoplePickerRequiredVersion = '2.0.0';\r\n\r\n/**\r\n * This is the SDK version when captureImage API is supported on mobile.\r\n */\r\nexport const captureImageMobileSupportVersion = '1.7.0';\r\n\r\n/**\r\n * This is the SDK version when media APIs are supported on all three platforms ios, android and web.\r\n */\r\nexport const mediaAPISupportVersion = '1.8.0';\r\n\r\n/**\r\n * This is the SDK version when getMedia API is supported via Callbacks on all three platforms ios, android and web.\r\n */\r\nexport const getMediaCallbackSupportVersion = '2.0.0';\r\n\r\n/**\r\n * This is the SDK version when scanBarCode API is supported on mobile.\r\n */\r\nexport const scanBarCodeAPIMobileSupportVersion = '1.9.0';\r\n\r\n/**\r\n * List of supported Host origins\r\n */\r\nexport const validOrigins = [\r\n  'https://teams.microsoft.com',\r\n  'https://teams.microsoft.us',\r\n  'https://gov.teams.microsoft.us',\r\n  'https://dod.teams.microsoft.us',\r\n  'https://int.teams.microsoft.com',\r\n  'https://teams.live.com',\r\n  'https://devspaces.skype.com',\r\n  'https://ssauth.skype.com',\r\n  'https://local.teams.live.com', // local development\r\n  'https://local.teams.live.com:8080', // local development\r\n  'https://local.teams.office.com', // local development\r\n  'https://local.teams.office.com:8080', // local development\r\n  'https://msft.spoppe.com',\r\n  'https://*.sharepoint.com',\r\n  'https://*.sharepoint-df.com',\r\n  'https://*.sharepointonline.com',\r\n  'https://outlook.office.com',\r\n  'https://outlook-sdf.office.com',\r\n  'https://*.teams.microsoft.com',\r\n  'https://www.office.com',\r\n  'https://word.office.com',\r\n  'https://excel.office.com',\r\n  'https://powerpoint.office.com',\r\n  'https://www.officeppe.com',\r\n  'https://*.www.office.com',\r\n];\r\n\r\nexport const validOriginRegExp = generateRegExpFromUrls(validOrigins);\r\n\r\n/**\r\n * USer specified message origins should satisfy this test\r\n */\r\nexport const userOriginUrlValidationRegExp = /^https\\:\\/\\//;\r\n","import * as uuid from 'uuid';\r\n// This will return a reg expression a given url\r\nfunction generateRegExpFromUrl(url: string): string {\r\n  let urlRegExpPart = '^';\r\n  const urlParts = url.split('.');\r\n  for (let j = 0; j < urlParts.length; j++) {\r\n    urlRegExpPart += (j > 0 ? '[.]' : '') + urlParts[j].replace('*', '[^/^.]+');\r\n  }\r\n  urlRegExpPart += '$';\r\n  return urlRegExpPart;\r\n}\r\n\r\n// This will return a reg expression for list of url\r\nexport function generateRegExpFromUrls(urls: string[]): RegExp {\r\n  let urlRegExp = '';\r\n  for (let i = 0; i < urls.length; i++) {\r\n    urlRegExp += (i === 0 ? '' : '|') + generateRegExpFromUrl(urls[i]);\r\n  }\r\n  return new RegExp(urlRegExp);\r\n}\r\n\r\nexport function getGenericOnCompleteHandler(errorMessage?: string): (success: boolean, reason?: string) => void {\r\n  return (success: boolean, reason: string): void => {\r\n    if (!success) {\r\n      throw new Error(errorMessage ? errorMessage : reason);\r\n    }\r\n  };\r\n}\r\n\r\n/**\r\n * Compares SDK versions.\r\n * @param v1 first version\r\n * @param v2 second version\r\n * returns NaN in case inputs are not in right format\r\n *         -1 if v1 < v2\r\n *          1 if v1 > v2\r\n *          0 otherwise\r\n * For example,\r\n *    compareSDKVersions('1.2', '1.2.0') returns 0\r\n *    compareSDKVersions('1.2a', '1.2b') returns NaN\r\n *    compareSDKVersions('1.2', '1.3') returns -1\r\n *    compareSDKVersions('2.0', '1.3.2') returns 1\r\n *    compareSDKVersions('2.0', 2.0) returns NaN\r\n */\r\nexport function compareSDKVersions(v1: string, v2: string): number {\r\n  if (typeof v1 !== 'string' || typeof v2 !== 'string') {\r\n    return NaN;\r\n  }\r\n\r\n  const v1parts = v1.split('.');\r\n  const v2parts = v2.split('.');\r\n\r\n  function isValidPart(x: string): boolean {\r\n    // input has to have one or more digits\r\n    // For ex - returns true for '11', false for '1a1', false for 'a', false for '2b'\r\n    return /^\\d+$/.test(x);\r\n  }\r\n\r\n  if (!v1parts.every(isValidPart) || !v2parts.every(isValidPart)) {\r\n    return NaN;\r\n  }\r\n\r\n  // Make length of both parts equal\r\n  while (v1parts.length < v2parts.length) {\r\n    v1parts.push('0');\r\n  }\r\n  while (v2parts.length < v1parts.length) {\r\n    v2parts.push('0');\r\n  }\r\n\r\n  for (let i = 0; i < v1parts.length; ++i) {\r\n    if (Number(v1parts[i]) == Number(v2parts[i])) {\r\n      continue;\r\n    } else if (Number(v1parts[i]) > Number(v2parts[i])) {\r\n      return 1;\r\n    } else {\r\n      return -1;\r\n    }\r\n  }\r\n  return 0;\r\n}\r\n\r\n/**\r\n * Generates a GUID\r\n */\r\nexport function generateGUID(): string {\r\n  return uuid.v4();\r\n}\r\n","import { FrameContexts } from '../public';\r\nexport class GlobalVars {\r\n  public static initializeCalled: boolean = false;\r\n  public static initializeCompleted: boolean = false;\r\n  public static additionalValidOrigins: string[] = [];\r\n  public static additionalValidOriginsRegexp: RegExp = null;\r\n  public static initializeCallbacks: { (): void }[] = [];\r\n  public static isFramelessWindow: boolean = false;\r\n  public static frameContext: FrameContexts;\r\n  public static hostClientType: string;\r\n  public static clientSupportedSDKVersion: string;\r\n  public static printCapabilityEnabled: boolean = false;\r\n}\r\n","import { TaskModuleDimension, HostClientType, TeamType, UserTeamRole, ChannelType } from './constants';\r\nimport { FrameContexts } from './constants';\r\n\r\n/**\r\n * Represents information about tabs for an app\r\n */\r\nexport interface TabInformation {\r\n  teamTabs: TabInstance[];\r\n}\r\n\r\n/**\r\n * Represents information about a tab instance\r\n */\r\nexport interface TabInstance {\r\n  /**\r\n   * The name of the tab\r\n   */\r\n  tabName: string;\r\n\r\n  /**\r\n   * Internal: do not use\r\n   * @protected\r\n   */\r\n  internalTabInstanceId?: string;\r\n\r\n  /**\r\n   * Last viewed time of this tab. null means unknown\r\n   */\r\n  lastViewUnixEpochTime?: string;\r\n\r\n  /**\r\n   * The developer-defined unique ID for the entity this content points to.\r\n   */\r\n  entityId?: string;\r\n\r\n  /**\r\n   * The Microsoft Teams ID for the channel with which the content is associated.\r\n   */\r\n  channelId?: string;\r\n\r\n  /**\r\n   * The name for the channel with which the content is associated.\r\n   */\r\n  channelName?: string;\r\n\r\n  /**\r\n   * Is this tab in a favorite channel?\r\n   */\r\n  channelIsFavorite?: boolean;\r\n\r\n  /**\r\n   * The Microsoft Teams ID for the team with which the content is associated.\r\n   */\r\n  teamId?: string;\r\n\r\n  /**\r\n   * The name for the team with which the content is associated.\r\n   */\r\n  teamName?: string;\r\n\r\n  /**\r\n   * Is this tab in a favorite team?\r\n   */\r\n  teamIsFavorite?: boolean;\r\n\r\n  /**\r\n   * The Office 365 group ID for the team with which the content is associated.\r\n   * This field is available only when the identity permission is requested in the manifest.\r\n   */\r\n  groupId?: string;\r\n\r\n  /**\r\n   * Content URL of this tab\r\n   */\r\n  url?: string;\r\n\r\n  /**\r\n   * Website URL of this tab\r\n   */\r\n  websiteUrl?: string;\r\n}\r\n\r\n/**\r\n * Indicates information about the tab instance for filtering purposes.\r\n */\r\nexport interface TabInstanceParameters {\r\n  /**\r\n   * Flag allowing to select favorite channels only\r\n   */\r\n  favoriteChannelsOnly?: boolean;\r\n\r\n  /**\r\n   * Flag allowing to select favorite teams only\r\n   */\r\n  favoriteTeamsOnly?: boolean;\r\n}\r\n\r\n/**\r\n * Represents Team Information\r\n */\r\nexport interface TeamInformation {\r\n  /**\r\n   * Id of the team\r\n   */\r\n  teamId: string;\r\n\r\n  /**\r\n   * Team display name\r\n   */\r\n  teamName: string;\r\n\r\n  /**\r\n   * Team description\r\n   */\r\n  teamDescription?: string;\r\n\r\n  /**\r\n   * Thumbnail Uri\r\n   */\r\n  thumbnailUri?: string;\r\n\r\n  /**\r\n   * The Office 365 group ID for the team with which the content is associated.\r\n   * This field is available only when the identity permission is requested in the manifest.\r\n   */\r\n  groupId?: string;\r\n\r\n  /**\r\n   * Role of current user in the team\r\n   */\r\n  userTeamRole?: UserTeamRole;\r\n\r\n  /**\r\n   * The type of the team.\r\n   */\r\n  teamType?: TeamType;\r\n\r\n  /**\r\n   * The locked status of the team\r\n   */\r\n  isTeamLocked?: boolean;\r\n\r\n  /**\r\n   * The archived status of the team\r\n   */\r\n  isTeamArchived?: boolean;\r\n}\r\n\r\n/**\r\n * Represents OS locale info used for formatting date and time data\r\n */\r\nexport interface LocaleInfo {\r\n  platform: 'windows' | 'macos';\r\n  regionalFormat: string;\r\n  shortDate: string;\r\n  longDate: string;\r\n  shortTime: string;\r\n  longTime: string;\r\n}\r\n\r\n/**\r\n * Allowed user file open preferences\r\n */\r\nexport enum FileOpenPreference {\r\n  Inline = 'inline',\r\n  Desktop = 'desktop',\r\n  Web = 'web',\r\n}\r\n\r\nexport interface Context {\r\n  /**\r\n   * The Office 365 group ID for the team with which the content is associated.\r\n   * This field is available only when the identity permission is requested in the manifest.\r\n   */\r\n  groupId?: string;\r\n\r\n  /**\r\n   * The Microsoft Teams ID for the team with which the content is associated.\r\n   */\r\n  teamId?: string;\r\n\r\n  /**\r\n   * The name for the team with which the content is associated.\r\n   */\r\n  teamName?: string;\r\n\r\n  /**\r\n   * The Microsoft Teams ID for the channel with which the content is associated.\r\n   */\r\n  channelId?: string;\r\n\r\n  /**\r\n   * The name for the channel with which the content is associated.\r\n   */\r\n  channelName?: string;\r\n\r\n  /**\r\n   * The type of the channel with which the content is associated.\r\n   */\r\n  channelType?: ChannelType;\r\n\r\n  /**\r\n   * The developer-defined unique ID for the entity this content points to.\r\n   */\r\n  entityId: string;\r\n\r\n  /**\r\n   * The developer-defined unique ID for the sub-entity this content points to.\r\n   * This field should be used to restore to a specific state within an entity,\r\n   * such as scrolling to or activating a specific piece of content.\r\n   */\r\n  subEntityId?: string;\r\n\r\n  /**\r\n   * The current locale that the user has configured for the app formatted as\r\n   * languageId-countryId (for example, en-us).\r\n   */\r\n  locale: string;\r\n\r\n  /**\r\n   * More detailed locale info from the user's OS if available. Can be used together with\r\n   * the @microsoft/globe NPM package to ensure your app respects the user's OS date and\r\n   * time format configuration\r\n   */\r\n  osLocaleInfo?: LocaleInfo;\r\n\r\n  /**\r\n   * @deprecated Use loginHint or userPrincipalName.\r\n   * The UPN of the current user.\r\n   * Because a malicious party can run your content in a browser, this value should\r\n   * be used only as a hint as to who the user is and never as proof of identity.\r\n   * This field is available only when the identity permission is requested in the manifest.\r\n   */\r\n  upn?: string;\r\n\r\n  /**\r\n   * The Azure AD tenant ID of the current user.\r\n   * Because a malicious party can run your content in a browser, this value should\r\n   * be used only as a hint as to who the user is and never as proof of identity.\r\n   * This field is available only when the identity permission is requested in the manifest.\r\n   */\r\n  tid?: string;\r\n\r\n  /**\r\n   * The current UI theme.\r\n   */\r\n  theme?: string;\r\n\r\n  /**\r\n   * Indication whether the tab is in full-screen mode.\r\n   */\r\n  isFullScreen?: boolean;\r\n\r\n  /**\r\n   * The type of the team.\r\n   */\r\n  teamType?: TeamType;\r\n\r\n  /**\r\n   * The root SharePoint site associated with the team.\r\n   */\r\n  teamSiteUrl?: string;\r\n\r\n  /**\r\n   * The domain of the root SharePoint site associated with the team.\r\n   */\r\n  teamSiteDomain?: string;\r\n\r\n  /**\r\n   * The relative path to the SharePoint site associated with the team.\r\n   */\r\n  teamSitePath?: string;\r\n\r\n  /**\r\n   * The tenant ID of the host team.\r\n   */\r\n  hostTeamTenantId?: string;\r\n\r\n  /**\r\n   * The AAD group ID of the host team.\r\n   */\r\n  hostTeamGroupId?: string;\r\n\r\n  /**\r\n   * The relative path to the SharePoint folder associated with the channel.\r\n   */\r\n  channelRelativeUrl?: string;\r\n\r\n  /**\r\n   * Unique ID for the current Teams session for use in correlating telemetry data.\r\n   */\r\n  sessionId?: string;\r\n\r\n  /**\r\n   * The user's role in the team.\r\n   * Because a malicious party can run your content in a browser, this value should\r\n   * be used only as a hint as to the user's role, and never as proof of her role.\r\n   */\r\n  userTeamRole?: UserTeamRole;\r\n\r\n  /**\r\n   * The Microsoft Teams ID for the chat with which the content is associated.\r\n   */\r\n  chatId?: string;\r\n\r\n  /**\r\n   * A value suitable for use as a login_hint when authenticating with Azure AD.\r\n   * Because a malicious party can run your content in a browser, this value should\r\n   * be used only as a hint as to who the user is and never as proof of identity.\r\n   * This field is available only when the identity permission is requested in the manifest.\r\n   */\r\n  loginHint?: string;\r\n\r\n  /**\r\n   * The UPN of the current user. This may be an externally-authenticated UPN (e.g., guest users).\r\n   * Because a malicious party run your content in a browser, this value should\r\n   * be used only as a hint as to who the user is and never as proof of identity.\r\n   * This field is available only when the identity permission is requested in the manifest.\r\n   */\r\n  userPrincipalName?: string;\r\n\r\n  /**\r\n   * The Azure AD object id of the current user.\r\n   * Because a malicious party run your content in a browser, this value should\r\n   * be used only as a hint as to who the user is and never as proof of identity.\r\n   * This field is available only when the identity permission is requested in the manifest.\r\n   */\r\n  userObjectId?: string;\r\n\r\n  /**\r\n   * Indicates whether team is archived.\r\n   * Apps should use this as a signal to prevent any changes to content associated with archived teams.\r\n   */\r\n  isTeamArchived?: boolean;\r\n\r\n  /**\r\n   * The type of the host client. Possible values are : android, ios, web, desktop, rigel(deprecated, use teamsRoomsWindows instead),\r\n   * teamsRoomsWindows, teamsRoomsAndroid, teamsPhones, teamsDisplays\r\n   */\r\n  hostClientType?: HostClientType;\r\n\r\n  /**\r\n   * The context where tab url is loaded (content, task, setting, remove, sidePanel)\r\n   */\r\n  frameContext?: FrameContexts;\r\n\r\n  /**\r\n   * SharePoint context. This is only available when hosted in SharePoint.\r\n   */\r\n  sharepoint?: any;\r\n\r\n  /**\r\n   * The type of license for the current users tenant.\r\n   */\r\n  tenantSKU?: string;\r\n\r\n  /**\r\n   * The license type for the current user.\r\n   */\r\n  userLicenseType?: string;\r\n\r\n  /**\r\n   * The ID of the parent message from which this task module was launched.\r\n   * This is only available in task modules launched from bot cards.\r\n   */\r\n  parentMessageId?: string;\r\n\r\n  /**\r\n   * Current ring ID\r\n   */\r\n  ringId?: string;\r\n\r\n  /**\r\n   * Unique ID for the current session for use in correlating telemetry data.\r\n   */\r\n  appSessionId?: string;\r\n\r\n  /**\r\n   * ID for the current visible app which is different for across cached sessions. Used for correlating telemetry data``\r\n   */\r\n  appLaunchId?: string;\r\n\r\n  /**\r\n   * Represents whether calling is allowed for the current logged in User\r\n   */\r\n  isCallingAllowed?: boolean;\r\n\r\n  /**\r\n   * Represents whether PSTN calling is allowed for the current logged in User\r\n   */\r\n  isPSTNCallingAllowed?: boolean;\r\n\r\n  /**\r\n   * Meeting Id used by tab when running in meeting context\r\n   */\r\n  meetingId?: string;\r\n\r\n  /**\r\n   * The OneNote section ID that is linked to the channel.\r\n   */\r\n  defaultOneNoteSectionId?: string;\r\n\r\n  /**\r\n   * Indication whether the tab is in a pop out window\r\n   */\r\n  isMultiWindow?: boolean;\r\n\r\n  /**\r\n   * Personal app icon y coordinate position\r\n   */\r\n  appIconPosition?: number;\r\n\r\n  /**\r\n   * Source origin from where the tab is opened\r\n   */\r\n  sourceOrigin?: string;\r\n\r\n  /**\r\n   * Time when the user clicked on the tab\r\n   */\r\n  userClickTime?: number;\r\n\r\n  /**\r\n   * Team Template ID if there was a Team Template associated with the creation of the team.\r\n   */\r\n  teamTemplateId?: string;\r\n\r\n  /**\r\n   * Where the user prefers the file to be opened from by default during file open\r\n   */\r\n  userFileOpenPreference?: FileOpenPreference;\r\n\r\n  /**\r\n   * Teamsite ID, aka sharepoint site id.\r\n   */\r\n  teamSiteId?: string;\r\n}\r\n\r\nexport interface DeepLinkParameters {\r\n  /**\r\n   * The developer-defined unique ID for the sub-entity to which this deep link points in the current entity.\r\n   * This field should be used to restore to a specific state within an entity, such as scrolling to or activating a specific piece of content.\r\n   */\r\n  subEntityId: string;\r\n\r\n  /**\r\n   * The label for the sub-entity that should be displayed when the deep link is rendered in a client.\r\n   */\r\n  subEntityLabel: string;\r\n\r\n  /**\r\n   * The fallback URL to which to navigate the user if the client cannot render the page.\r\n   * This URL should lead directly to the sub-entity.\r\n   */\r\n  subEntityWebUrl?: string;\r\n}\r\n\r\nexport interface TaskInfo {\r\n  /**\r\n   * The url to be rendered in the webview/iframe.\r\n   */\r\n  url?: string;\r\n\r\n  /**\r\n   * JSON defining an adaptive card.\r\n   */\r\n  card?: string;\r\n\r\n  /**\r\n   * The requested height of the webview/iframe.\r\n   */\r\n  height?: TaskModuleDimension | number;\r\n\r\n  /**\r\n   * The requested width of the webview/iframe.\r\n   */\r\n  width?: TaskModuleDimension | number;\r\n\r\n  /**\r\n   * Title of the task module.\r\n   */\r\n  title?: string;\r\n\r\n  /**\r\n   * If client doesnt support the URL, the URL that needs to be opened in the browser.\r\n   */\r\n  fallbackUrl?: string;\r\n\r\n  /**\r\n   * Specifies a bot ID to send the result of the user's interaction with the task module.\r\n   * If specified, the bot will receive a task/complete invoke event with a JSON object\r\n   * in the event payload.\r\n   */\r\n  completionBotId?: string;\r\n}\r\n\r\n/**\r\n * @private\r\n * Hide from docs.\r\n * ------\r\n */\r\nexport interface OpenConversationRequest {\r\n  /**\r\n   * The Id of the subEntity where the conversation is taking place\r\n   */\r\n  subEntityId: string;\r\n\r\n  /**\r\n   * The title of the conversation\r\n   */\r\n  title: string;\r\n\r\n  /**\r\n   * The Id of the conversation. This is optional and should be specified whenever a previous conversation about a specific sub-entity has already been started before\r\n   */\r\n  conversationId?: string;\r\n\r\n  /**\r\n   * The Id of the channel. This is optional and should be specified whenever a conversation is started or opened in a personal app scope\r\n   */\r\n  channelId?: string;\r\n\r\n  /**\r\n   * The entity Id of the tab\r\n   */\r\n  entityId: string;\r\n\r\n  /**\r\n   * A function that is called once the conversation Id has been created\r\n   */\r\n  onStartConversation?: (conversationResponse: ConversationResponse) => void;\r\n\r\n  /**\r\n   * A function that is called if the pane is closed\r\n   */\r\n  onCloseConversation?: (conversationResponse: ConversationResponse) => void;\r\n}\r\n\r\n/**\r\n * @private\r\n * Hide from docs.\r\n * ------\r\n */\r\nexport interface ConversationResponse {\r\n  /**\r\n   * The Id of the subEntity where the conversation is taking place\r\n   */\r\n  subEntityId: string;\r\n\r\n  /**\r\n   * The Id of the conversation. This is optional and should be specified whenever a previous conversation about a specific sub-entity has already been started before\r\n   */\r\n  conversationId?: string;\r\n\r\n  /**\r\n   * The Id of the channel. This is optional and should be specified whenever a conversation is started or opened in a personal app scope\r\n   */\r\n  channelId?: string;\r\n\r\n  /**\r\n   * The entity Id of the tab\r\n   */\r\n  entityId?: string;\r\n}\r\n\r\n/**\r\n * @private\r\n * Hide from docs.\r\n */\r\nexport interface LoadContext {\r\n  /**\r\n   * The enitity that is requested to be loaded\r\n   */\r\n  entityId: string;\r\n\r\n  /**\r\n   * The content URL that is requested to be loaded\r\n   */\r\n  contentUrl: string;\r\n}\r\n\r\nexport interface FrameContext {\r\n  /**\r\n   * The current URL that needs to be used in the iframe if the tab is reloaded\r\n   */\r\n  contentUrl: string;\r\n\r\n  /**\r\n   * The current URL that needs to be used for opening the website when the user clicks on 'Go to website'\r\n   */\r\n  websiteUrl: string;\r\n}\r\n\r\nexport interface SdkError {\r\n  /**\r\n  error code\r\n  */\r\n  errorCode: ErrorCode;\r\n  /**\r\n  Optional description for the error. This may contain useful information for web-app developers.\r\n  This string will not be localized and is not for end-user consumption. \r\n  App should not depend on the string content. The exact value may change. This is only for debugging purposes.\r\n  */\r\n  message?: string;\r\n}\r\n\r\nexport enum ErrorCode {\r\n  /**\r\n   * API not supported in the current platform.\r\n   */\r\n  NOT_SUPPORTED_ON_PLATFORM = 100,\r\n  /**\r\n   * Internal error encountered while performing the required operation.\r\n   */\r\n  INTERNAL_ERROR = 500,\r\n  /**\r\n   * API is not supported in the current context\r\n   */\r\n  NOT_SUPPORTED_IN_CURRENT_CONTEXT = 501,\r\n  /**\r\n  Permissions denied by user\r\n  */\r\n  PERMISSION_DENIED = 1000,\r\n  /**\r\n   * Network issue\r\n   */\r\n  NETWORK_ERROR = 2000,\r\n  /**\r\n   * Underlying hardware doesn't support the capability\r\n   */\r\n  NO_HW_SUPPORT = 3000,\r\n  /**\r\n   * One or more arguments are invalid\r\n   */\r\n  INVALID_ARGUMENTS = 4000,\r\n  /**\r\n   * User is not authorized for this operation\r\n   */\r\n  UNAUTHORIZED_USER_OPERATION = 5000,\r\n  /**\r\n   * Could not complete the operation due to insufficient resources\r\n   */\r\n  INSUFFICIENT_RESOURCES = 6000,\r\n  /**\r\n   * Platform throttled the request because of API was invoked too frequently\r\n   */\r\n  THROTTLE = 7000,\r\n  /**\r\n   * User aborted the operation\r\n   */\r\n  USER_ABORT = 8000,\r\n  /**\r\n   * Could not complete the operation in the given time interval\r\n   */\r\n  OPERATION_TIMED_OUT = 8001,\r\n  /**\r\n   * Platform code is old and doesn't implement this API\r\n   */\r\n  OLD_PLATFORM = 9000,\r\n  /**\r\n   * The file specified was not found on the given location\r\n   */\r\n  FILE_NOT_FOUND = 404,\r\n  /**\r\n   * The return value is too big and has exceeded our size boundries\r\n   */\r\n  SIZE_EXCEEDED = 10000,\r\n}\r\n","export { appInitialization } from './appInitialization';\r\nexport { authentication } from './authentication';\r\nexport { FrameContexts, HostClientType, TaskModuleDimension, TeamType, UserTeamRole, ChannelType } from './constants';\r\nexport {\r\n  Context,\r\n  DeepLinkParameters,\r\n  ErrorCode,\r\n  LoadContext,\r\n  SdkError,\r\n  TabInformation,\r\n  TabInstance,\r\n  TabInstanceParameters,\r\n  TaskInfo,\r\n  TeamInformation,\r\n  FileOpenPreference,\r\n} from './interfaces';\r\nexport {\r\n  enablePrintCapability,\r\n  executeDeepLink,\r\n  getContext,\r\n  getMruTabInstances,\r\n  getTabInstances,\r\n  initialize,\r\n  initializeWithFrameContext,\r\n  print,\r\n  registerBackButtonHandler,\r\n  registerBeforeUnloadHandler,\r\n  registerFocusEnterHandler,\r\n  registerEnterSettingsHandler,\r\n  registerFullScreenHandler,\r\n  registerOnLoadHandler,\r\n  registerOnThemeChangeHandler,\r\n  registerAppButtonClickHandler,\r\n  registerAppButtonHoverEnterHandler,\r\n  registerAppButtonHoverLeaveHandler,\r\n  setFrameContext,\r\n  shareDeepLink,\r\n} from './publicAPIs';\r\nexport { returnFocus, navigateBack, navigateCrossDomain, navigateToTab } from './navigation';\r\nexport { settings } from './settings';\r\nexport { tasks } from './tasks';\r\nexport { ChildAppWindow, IAppWindow, ParentAppWindow } from './appWindow';\r\nexport { media } from './media';\r\nexport { location } from './location';\r\nexport { meeting } from './meeting';\r\nexport { monetization } from './monetization';\r\nexport { people } from './people';\r\nexport { video } from './video';\r\nexport { sharing } from './sharing';\r\n","// Unique ID creation requires a high quality random # generator.  In the\n// browser this is a little complicated due to unknown quality of Math.random()\n// and inconsistent support for the `crypto` API.  We do the best we can via\n// feature-detection\n\n// getRandomValues needs to be invoked in a context where \"this\" is a Crypto\n// implementation. Also, find the complete implementation of crypto on IE11.\nvar getRandomValues = (typeof(crypto) != 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto)) ||\n                      (typeof(msCrypto) != 'undefined' && typeof window.msCrypto.getRandomValues == 'function' && msCrypto.getRandomValues.bind(msCrypto));\n\nif (getRandomValues) {\n  // WHATWG crypto RNG - http://wiki.whatwg.org/wiki/Crypto\n  var rnds8 = new Uint8Array(16); // eslint-disable-line no-undef\n\n  module.exports = function whatwgRNG() {\n    getRandomValues(rnds8);\n    return rnds8;\n  };\n} else {\n  // Math.random()-based (RNG)\n  //\n  // If all else fails, use Math.random().  It's fast, but is of unspecified\n  // quality.\n  var rnds = new Array(16);\n\n  module.exports = function mathRNG() {\n    for (var i = 0, r; i < 16; i++) {\n      if ((i & 0x03) === 0) r = Math.random() * 0x100000000;\n      rnds[i] = r >>> ((i & 0x03) << 3) & 0xff;\n    }\n\n    return rnds;\n  };\n}\n","/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\nvar byteToHex = [];\nfor (var i = 0; i < 256; ++i) {\n  byteToHex[i] = (i + 0x100).toString(16).substr(1);\n}\n\nfunction bytesToUuid(buf, offset) {\n  var i = offset || 0;\n  var bth = byteToHex;\n  // join used to fix memory issue caused by concatenation: https://bugs.chromium.org/p/v8/issues/detail?id=3175#c4\n  return ([bth[buf[i++]], bth[buf[i++]], \n\tbth[buf[i++]], bth[buf[i++]], '-',\n\tbth[buf[i++]], bth[buf[i++]], '-',\n\tbth[buf[i++]], bth[buf[i++]], '-',\n\tbth[buf[i++]], bth[buf[i++]], '-',\n\tbth[buf[i++]], bth[buf[i++]],\n\tbth[buf[i++]], bth[buf[i++]],\n\tbth[buf[i++]], bth[buf[i++]]]).join('');\n}\n\nmodule.exports = bytesToUuid;\n","import { ensureInitialized } from '../internal/internalAPIs';\r\nimport { GlobalVars } from '../internal/globalVars';\r\nimport { FrameContexts, HostClientType } from './constants';\r\nimport {\r\n  Communication,\r\n  sendMessageToParent,\r\n  sendMessageEventToChild,\r\n  waitForMessageQueue,\r\n} from '../internal/communication';\r\nimport { registerHandler, removeHandler } from '../internal/handlers';\r\n\r\n/**\r\n * Namespace to interact with the authentication-specific part of the SDK.\r\n * This object is used for starting or completing authentication flows.\r\n */\r\nexport namespace authentication {\r\n  let authParams: AuthenticateParameters;\r\n  let authWindowMonitor: number;\r\n\r\n  export function initialize(): void {\r\n    registerHandler('authentication.authenticate.success', handleSuccess, false);\r\n    registerHandler('authentication.authenticate.failure', handleFailure, false);\r\n  }\r\n\r\n  /**\r\n   * Registers the authentication Communication.handlers\r\n   * @param authenticateParameters A set of values that configure the authentication pop-up.\r\n   */\r\n  export function registerAuthenticationHandlers(authenticateParameters: AuthenticateParameters): void {\r\n    authParams = authenticateParameters;\r\n  }\r\n\r\n  /**\r\n   * Initiates an authentication request, which opens a new window with the specified settings.\r\n   */\r\n  export function authenticate(authenticateParameters?: AuthenticateParameters): void {\r\n    const authenticateParams = authenticateParameters !== undefined ? authenticateParameters : authParams;\r\n    ensureInitialized(\r\n      FrameContexts.content,\r\n      FrameContexts.sidePanel,\r\n      FrameContexts.settings,\r\n      FrameContexts.remove,\r\n      FrameContexts.task,\r\n      FrameContexts.stage,\r\n      FrameContexts.meetingStage,\r\n    );\r\n    if (\r\n      GlobalVars.hostClientType === HostClientType.desktop ||\r\n      GlobalVars.hostClientType === HostClientType.android ||\r\n      GlobalVars.hostClientType === HostClientType.ios ||\r\n      GlobalVars.hostClientType === HostClientType.rigel ||\r\n      GlobalVars.hostClientType === HostClientType.teamsRoomsWindows ||\r\n      GlobalVars.hostClientType === HostClientType.teamsRoomsAndroid ||\r\n      GlobalVars.hostClientType === HostClientType.teamsPhones ||\r\n      GlobalVars.hostClientType === HostClientType.teamsDisplays\r\n    ) {\r\n      // Convert any relative URLs into absolute URLs before sending them over to the parent window.\r\n      const link = document.createElement('a');\r\n      link.href = authenticateParams.url;\r\n      // Ask the parent window to open an authentication window with the parameters provided by the caller.\r\n      sendMessageToParent(\r\n        'authentication.authenticate',\r\n        [link.href, authenticateParams.width, authenticateParams.height],\r\n        (success: boolean, response: string) => {\r\n          if (success) {\r\n            authenticateParams.successCallback(response);\r\n          } else {\r\n            authenticateParams.failureCallback(response);\r\n          }\r\n        },\r\n      );\r\n    } else {\r\n      // Open an authentication window with the parameters provided by the caller.\r\n      openAuthenticationWindow(authenticateParams);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Requests an Azure AD token to be issued on behalf of the app. The token is acquired from the cache\r\n   * if it is not expired. Otherwise a request is sent to Azure AD to obtain a new token.\r\n   * @param authTokenRequest A set of values that configure the token request.\r\n   */\r\n  export function getAuthToken(authTokenRequest: AuthTokenRequest): void {\r\n    ensureInitialized();\r\n    sendMessageToParent(\r\n      'authentication.getAuthToken',\r\n      [authTokenRequest.resources, authTokenRequest.claims, authTokenRequest.silent],\r\n      (success: boolean, result: string) => {\r\n        if (success) {\r\n          authTokenRequest.successCallback(result);\r\n        } else {\r\n          authTokenRequest.failureCallback(result);\r\n        }\r\n      },\r\n    );\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * Hide from docs.\r\n   * ------\r\n   * Requests the decoded Azure AD user identity on behalf of the app.\r\n   */\r\n  export function getUser(userRequest: UserRequest): void {\r\n    ensureInitialized();\r\n    sendMessageToParent('authentication.getUser', (success: boolean, result: UserProfile | string) => {\r\n      if (success) {\r\n        userRequest.successCallback(result as UserProfile);\r\n      } else {\r\n        userRequest.failureCallback(result as string);\r\n      }\r\n    });\r\n  }\r\n\r\n  function closeAuthenticationWindow(): void {\r\n    // Stop monitoring the authentication window\r\n    stopAuthenticationWindowMonitor();\r\n    // Try to close the authentication window and clear all properties associated with it\r\n    try {\r\n      if (Communication.childWindow) {\r\n        Communication.childWindow.close();\r\n      }\r\n    } finally {\r\n      Communication.childWindow = null;\r\n      Communication.childOrigin = null;\r\n    }\r\n  }\r\n\r\n  function openAuthenticationWindow(authenticateParameters: AuthenticateParameters): void {\r\n    authParams = authenticateParameters;\r\n    // Close the previously opened window if we have one\r\n    closeAuthenticationWindow();\r\n    // Start with a sensible default size\r\n    let width = authParams.width || 600;\r\n    let height = authParams.height || 400;\r\n    // Ensure that the new window is always smaller than our app's window so that it never fully covers up our app\r\n    width = Math.min(width, Communication.currentWindow.outerWidth - 400);\r\n    height = Math.min(height, Communication.currentWindow.outerHeight - 200);\r\n    // Convert any relative URLs into absolute URLs before sending them over to the parent window\r\n    const link = document.createElement('a');\r\n    link.href = authParams.url;\r\n    // We are running in the browser, so we need to center the new window ourselves\r\n    let left: number =\r\n      typeof Communication.currentWindow.screenLeft !== 'undefined'\r\n        ? Communication.currentWindow.screenLeft\r\n        : Communication.currentWindow.screenX;\r\n    let top: number =\r\n      typeof Communication.currentWindow.screenTop !== 'undefined'\r\n        ? Communication.currentWindow.screenTop\r\n        : Communication.currentWindow.screenY;\r\n    left += Communication.currentWindow.outerWidth / 2 - width / 2;\r\n    top += Communication.currentWindow.outerHeight / 2 - height / 2;\r\n    // Open a child window with a desired set of standard browser features\r\n    Communication.childWindow = Communication.currentWindow.open(\r\n      link.href,\r\n      '_blank',\r\n      'toolbar=no, location=yes, status=no, menubar=no, scrollbars=yes, top=' +\r\n        top +\r\n        ', left=' +\r\n        left +\r\n        ', width=' +\r\n        width +\r\n        ', height=' +\r\n        height,\r\n    );\r\n    if (Communication.childWindow) {\r\n      // Start monitoring the authentication window so that we can detect if it gets closed before the flow completes\r\n      startAuthenticationWindowMonitor();\r\n    } else {\r\n      // If we failed to open the window, fail the authentication flow\r\n      handleFailure('FailedToOpenWindow');\r\n    }\r\n  }\r\n\r\n  function stopAuthenticationWindowMonitor(): void {\r\n    if (authWindowMonitor) {\r\n      clearInterval(authWindowMonitor);\r\n      authWindowMonitor = 0;\r\n    }\r\n    removeHandler('initialize');\r\n    removeHandler('navigateCrossDomain');\r\n  }\r\n\r\n  function startAuthenticationWindowMonitor(): void {\r\n    // Stop the previous window monitor if one is running\r\n    stopAuthenticationWindowMonitor();\r\n    // Create an interval loop that\r\n    // - Notifies the caller of failure if it detects that the authentication window is closed\r\n    // - Keeps pinging the authentication window while it is open to re-establish\r\n    //   contact with any pages along the authentication flow that need to communicate\r\n    //   with us\r\n    authWindowMonitor = Communication.currentWindow.setInterval(() => {\r\n      if (!Communication.childWindow || Communication.childWindow.closed) {\r\n        handleFailure('CancelledByUser');\r\n      } else {\r\n        const savedChildOrigin = Communication.childOrigin;\r\n        try {\r\n          Communication.childOrigin = '*';\r\n          sendMessageEventToChild('ping');\r\n        } finally {\r\n          Communication.childOrigin = savedChildOrigin;\r\n        }\r\n      }\r\n    }, 100);\r\n    // Set up an initialize-message handler that gives the authentication window its frame context\r\n    registerHandler('initialize', () => {\r\n      return [FrameContexts.authentication, GlobalVars.hostClientType];\r\n    });\r\n    // Set up a navigateCrossDomain message handler that blocks cross-domain re-navigation attempts\r\n    // in the authentication window. We could at some point choose to implement this method via a call to\r\n    // authenticationWindow.location.href = url; however, we would first need to figure out how to\r\n    // validate the URL against the tab's list of valid domains.\r\n    registerHandler('navigateCrossDomain', () => {\r\n      return false;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Notifies the frame that initiated this authentication request that the request was successful.\r\n   * This function is usable only on the authentication window.\r\n   * This call causes the authentication window to be closed.\r\n   * @param result Specifies a result for the authentication. If specified, the frame that initiated the authentication pop-up receives this value in its callback.\r\n   * @param callbackUrl Specifies the url to redirect back to if the client is Win32 Outlook.\r\n   */\r\n  export function notifySuccess(result?: string, callbackUrl?: string): void {\r\n    redirectIfWin32Outlook(callbackUrl, 'result', result);\r\n    ensureInitialized(FrameContexts.authentication);\r\n    sendMessageToParent('authentication.authenticate.success', [result]);\r\n    // Wait for the message to be sent before closing the window\r\n    waitForMessageQueue(Communication.parentWindow, () => setTimeout(() => Communication.currentWindow.close(), 200));\r\n  }\r\n\r\n  /**\r\n   * Notifies the frame that initiated this authentication request that the request failed.\r\n   * This function is usable only on the authentication window.\r\n   * This call causes the authentication window to be closed.\r\n   * @param result Specifies a result for the authentication. If specified, the frame that initiated the authentication pop-up receives this value in its callback.\r\n   * @param callbackUrl Specifies the url to redirect back to if the client is Win32 Outlook.\r\n   */\r\n  export function notifyFailure(reason?: string, callbackUrl?: string): void {\r\n    redirectIfWin32Outlook(callbackUrl, 'reason', reason);\r\n    ensureInitialized(FrameContexts.authentication);\r\n    sendMessageToParent('authentication.authenticate.failure', [reason]);\r\n    // Wait for the message to be sent before closing the window\r\n    waitForMessageQueue(Communication.parentWindow, () => setTimeout(() => Communication.currentWindow.close(), 200));\r\n  }\r\n\r\n  function handleSuccess(result?: string): void {\r\n    try {\r\n      if (authParams && authParams.successCallback) {\r\n        authParams.successCallback(result);\r\n      }\r\n    } finally {\r\n      authParams = null;\r\n      closeAuthenticationWindow();\r\n    }\r\n  }\r\n\r\n  function handleFailure(reason?: string): void {\r\n    try {\r\n      if (authParams && authParams.failureCallback) {\r\n        authParams.failureCallback(reason);\r\n      }\r\n    } finally {\r\n      authParams = null;\r\n      closeAuthenticationWindow();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Validates that the callbackUrl param is a valid connector url, appends the result/reason and authSuccess/authFailure as URL fragments and redirects the window\r\n   * @param callbackUrl - the connectors url to redirect to\r\n   * @param key - \"result\" in case of success and \"reason\" in case of failure\r\n   * @param value - the value of the passed result/reason parameter\r\n   */\r\n  function redirectIfWin32Outlook(callbackUrl?: string, key?: string, value?: string): void {\r\n    if (callbackUrl) {\r\n      const link = document.createElement('a');\r\n      link.href = decodeURIComponent(callbackUrl);\r\n      if (\r\n        link.host &&\r\n        link.host !== window.location.host &&\r\n        link.host === 'outlook.office.com' &&\r\n        link.search.indexOf('client_type=Win32_Outlook') > -1\r\n      ) {\r\n        if (key && key === 'result') {\r\n          if (value) {\r\n            link.href = updateUrlParameter(link.href, 'result', value);\r\n          }\r\n          Communication.currentWindow.location.assign(updateUrlParameter(link.href, 'authSuccess', ''));\r\n        }\r\n        if (key && key === 'reason') {\r\n          if (value) {\r\n            link.href = updateUrlParameter(link.href, 'reason', value);\r\n          }\r\n          Communication.currentWindow.location.assign(updateUrlParameter(link.href, 'authFailure', ''));\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Appends either result or reason as a fragment to the 'callbackUrl'\r\n   * @param uri - the url to modify\r\n   * @param key - the fragment key\r\n   * @param value - the fragment value\r\n   */\r\n  function updateUrlParameter(uri: string, key: string, value: string): string {\r\n    const i = uri.indexOf('#');\r\n    let hash = i === -1 ? '#' : uri.substr(i);\r\n    hash = hash + '&' + key + (value !== '' ? '=' + value : '');\r\n    uri = i === -1 ? uri : uri.substr(0, i);\r\n    return uri + hash;\r\n  }\r\n\r\n  export interface AuthenticateParameters {\r\n    /**\r\n     * The URL for the authentication pop-up.\r\n     */\r\n    url: string;\r\n    /**\r\n     * The preferred width for the pop-up. This value can be ignored if outside the acceptable bounds.\r\n     */\r\n    width?: number;\r\n    /**\r\n     * The preferred height for the pop-up. This value can be ignored if outside the acceptable bounds.\r\n     */\r\n    height?: number;\r\n    /**\r\n     * A function that is called if the authentication succeeds, with the result returned from the authentication pop-up.\r\n     */\r\n    successCallback?: (result?: string) => void;\r\n    /**\r\n     * A function that is called if the authentication fails, with the reason for the failure returned from the authentication pop-up.\r\n     */\r\n    failureCallback?: (reason?: string) => void;\r\n  }\r\n\r\n  export interface AuthTokenRequest {\r\n    /**\r\n     * An optional list of resource for which to acquire the access token; only used for full trust apps.\r\n     */\r\n    resources?: string[];\r\n    /**\r\n     * An optional list of claims which to pass to AAD when requesting the access token.\r\n     */\r\n    claims?: string[];\r\n    /**\r\n     * An optional flag indicating whether to attempt the token acquisition silently or allow a prompt to be shown.\r\n     */\r\n    silent?: boolean;\r\n    /**\r\n     * A function that is called if the token request succeeds, with the resulting token.\r\n     */\r\n    successCallback?: (token: string) => void;\r\n    /**\r\n     * A function that is called if the token request fails, with the reason for the failure.\r\n     */\r\n    failureCallback?: (reason: string) => void;\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * Hide from docs.\r\n   * ------\r\n   */\r\n  export interface UserRequest {\r\n    /**\r\n     * A function that is called if the token request succeeds, with the resulting token.\r\n     */\r\n    successCallback?: (user: UserProfile) => void;\r\n    /**\r\n     * A function that is called if the token request fails, with the reason for the failure.\r\n     */\r\n    failureCallback?: (reason: string) => void;\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * Hide from docs.\r\n   * ------\r\n   */\r\n  export interface UserProfile {\r\n    /**\r\n     * The intended recipient of the token. The application that receives the token must verify that the audience\r\n     * value is correct and reject any tokens intended for a different audience.\r\n     */\r\n    aud: string;\r\n    /**\r\n     * Identifies how the subject of the token was authenticated.\r\n     */\r\n    amr: string[];\r\n    /**\r\n     * Stores the time at which the token was issued. It is often used to measure token freshness.\r\n     */\r\n    iat: number;\r\n    /**\r\n     * Identifies the security token service (STS) that constructs and returns the token. In the tokens that Azure AD\r\n     * returns, the issuer is sts.windows.net. The GUID in the issuer claim value is the tenant ID of the Azure AD\r\n     * directory. The tenant ID is an immutable and reliable identifier of the directory.\r\n     */\r\n    iss: string;\r\n    /**\r\n     * Provides the last name, surname, or family name of the user as defined in the Azure AD user object.\r\n     */\r\n    family_name: string;\r\n    /**\r\n     * Provides the first or \"given\" name of the user, as set on the Azure AD user object.\r\n     */\r\n    given_name: string;\r\n    /**\r\n     * Provides a human-readable value that identifies the subject of the token. This value is not guaranteed to\r\n     * be unique within a tenant and is designed to be used only for display purposes.\r\n     */\r\n    unique_name: string;\r\n    /**\r\n     * Contains a unique identifier of an object in Azure AD. This value is immutable and cannot be reassigned or\r\n     * reused. Use the object ID to identify an object in queries to Azure AD.\r\n     */\r\n    oid: string;\r\n    /**\r\n     * Identifies the principal about which the token asserts information, such as the user of an application.\r\n     * This value is immutable and cannot be reassigned or reused, so it can be used to perform authorization\r\n     * checks safely. Because the subject is always present in the tokens the Azure AD issues, we recommended\r\n     * using this value in a general-purpose authorization system.\r\n     */\r\n    sub: string;\r\n    /**\r\n     * An immutable, non-reusable identifier that identifies the directory tenant that issued the token. You can\r\n     * use this value to access tenant-specific directory resources in a multitenant application. For example,\r\n     * you can use this value to identify the tenant in a call to the Graph API.\r\n     */\r\n    tid: string;\r\n    /**\r\n     * Defines the time interval within which a token is valid. The service that validates the token should verify\r\n     * that the current date is within the token lifetime; otherwise it should reject the token. The service might\r\n     * allow for up to five minutes beyond the token lifetime to account for any differences in clock time (\"time\r\n     * skew\") between Azure AD and the service.\r\n     */\r\n    exp: number;\r\n    nbf: number;\r\n    /**\r\n     * Stores the user name of the user principal.\r\n     */\r\n    upn: string;\r\n    /**\r\n     * Stores the version number of the token.\r\n     */\r\n    ver: string;\r\n  }\r\n}\r\n","import { ensureInitialized } from '../internal/internalAPIs';\r\nimport { FrameContexts } from './constants';\r\nimport { getGenericOnCompleteHandler } from '../internal/utils';\r\nimport { sendMessageToParent } from '../internal/communication';\r\nimport { registerHandler } from '../internal/handlers';\r\n\r\n/**\r\n * Namespace to interact with the settings-specific part of the SDK.\r\n * This object is usable only on the settings frame.\r\n */\r\nexport namespace settings {\r\n  let saveHandler: (evt: SaveEvent) => void;\r\n  let removeHandler: (evt: RemoveEvent) => void;\r\n\r\n  export function initialize(): void {\r\n    registerHandler('settings.save', handleSave, false);\r\n    registerHandler('settings.remove', handleRemove, false);\r\n  }\r\n\r\n  /**\r\n   * Sets the validity state for the settings.\r\n   * The initial value is false, so the user cannot save the settings until this is called with true.\r\n   * @param validityState Indicates whether the save or remove button is enabled for the user.\r\n   */\r\n  export function setValidityState(validityState: boolean): void {\r\n    ensureInitialized(FrameContexts.settings, FrameContexts.remove);\r\n    sendMessageToParent('settings.setValidityState', [validityState]);\r\n  }\r\n\r\n  /**\r\n   * Gets the settings for the current instance.\r\n   * @param callback The callback to invoke when the {@link Settings} object is retrieved.\r\n   */\r\n  export function getSettings(callback: (instanceSettings: Settings) => void): void {\r\n    ensureInitialized(FrameContexts.content, FrameContexts.settings, FrameContexts.remove, FrameContexts.sidePanel);\r\n    sendMessageToParent('settings.getSettings', callback);\r\n  }\r\n\r\n  /**\r\n   * Sets the settings for the current instance.\r\n   * This is an asynchronous operation; calls to getSettings are not guaranteed to reflect the changed state.\r\n   * @param settings The desired settings for this instance.\r\n   */\r\n  export function setSettings(\r\n    instanceSettings: Settings,\r\n    onComplete?: (status: boolean, reason?: string) => void,\r\n  ): void {\r\n    ensureInitialized(FrameContexts.content, FrameContexts.settings, FrameContexts.sidePanel);\r\n    sendMessageToParent(\r\n      'settings.setSettings',\r\n      [instanceSettings],\r\n      onComplete ? onComplete : getGenericOnCompleteHandler(),\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Registers a handler for when the user attempts to save the settings. This handler should be used\r\n   * to create or update the underlying resource powering the content.\r\n   * The object passed to the handler must be used to notify whether to proceed with the save.\r\n   * Only one handler can be registered at a time. A subsequent registration replaces an existing registration.\r\n   * @param handler The handler to invoke when the user selects the save button.\r\n   */\r\n  export function registerOnSaveHandler(handler: (evt: SaveEvent) => void): void {\r\n    ensureInitialized(FrameContexts.settings);\r\n    saveHandler = handler;\r\n    handler && sendMessageToParent('registerHandler', ['save']);\r\n  }\r\n\r\n  /**\r\n   * Registers a handler for user attempts to remove content. This handler should be used\r\n   * to remove the underlying resource powering the content.\r\n   * The object passed to the handler must be used to indicate whether to proceed with the removal.\r\n   * Only one handler may be registered at a time. Subsequent registrations will override the first.\r\n   * @param handler The handler to invoke when the user selects the remove button.\r\n   */\r\n  export function registerOnRemoveHandler(handler: (evt: RemoveEvent) => void): void {\r\n    ensureInitialized(FrameContexts.remove, FrameContexts.settings);\r\n    removeHandler = handler;\r\n    handler && sendMessageToParent('registerHandler', ['remove']);\r\n  }\r\n\r\n  function handleSave(result?: SaveParameters): void {\r\n    const saveEvent = new SaveEventImpl(result);\r\n    if (saveHandler) {\r\n      saveHandler(saveEvent);\r\n    } else {\r\n      // If no handler is registered, we assume success.\r\n      saveEvent.notifySuccess();\r\n    }\r\n  }\r\n\r\n  export interface Settings {\r\n    /**\r\n     * A suggested display name for the new content.\r\n     * In the settings for an existing instance being updated, this call has no effect.\r\n     */\r\n    suggestedDisplayName?: string;\r\n    /**\r\n     * Sets the URL to use for the content of this instance.\r\n     */\r\n    contentUrl: string;\r\n    /**\r\n     * Sets the URL for the removal configuration experience.\r\n     */\r\n    removeUrl?: string;\r\n    /**\r\n     * Sets the URL to use for the external link to view the underlying resource in a browser.\r\n     */\r\n    websiteUrl?: string;\r\n    /**\r\n     * The developer-defined unique ID for the entity to which this content points.\r\n     */\r\n    entityId?: string;\r\n  }\r\n\r\n  export interface SaveEvent {\r\n    /**\r\n     * Object containing properties passed as arguments to the settings.save event.\r\n     */\r\n    result: SaveParameters;\r\n    /**\r\n     * Indicates that the underlying resource has been created and the settings can be saved.\r\n     */\r\n    notifySuccess(): void;\r\n    /**\r\n     * Indicates that creation of the underlying resource failed and that the settings cannot be saved.\r\n     * @param reason Specifies a reason for the failure. If provided, this string is displayed to the user; otherwise a generic error is displayed.\r\n     */\r\n    notifyFailure(reason?: string): void;\r\n  }\r\n\r\n  export interface RemoveEvent {\r\n    /**\r\n     * Indicates that the underlying resource has been removed and the content can be removed.\r\n     */\r\n    notifySuccess(): void;\r\n    /**\r\n     * Indicates that removal of the underlying resource failed and that the content cannot be removed.\r\n     * @param reason Specifies a reason for the failure. If provided, this string is displayed to the user; otherwise a generic error is displayed.\r\n     */\r\n    notifyFailure(reason?: string): void;\r\n  }\r\n\r\n  export interface SaveParameters {\r\n    /**\r\n     * Connector's webhook Url returned as arguments to settings.save event as part of user clicking on Save\r\n     */\r\n    webhookUrl?: string;\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * Hide from docs, since this class is not directly used.\r\n   */\r\n  class SaveEventImpl implements SaveEvent {\r\n    public notified: boolean = false;\r\n    public result: SaveParameters;\r\n    public constructor(result?: SaveParameters) {\r\n      this.result = result ? result : {};\r\n    }\r\n    public notifySuccess(): void {\r\n      this.ensureNotNotified();\r\n      sendMessageToParent('settings.save.success');\r\n      this.notified = true;\r\n    }\r\n    public notifyFailure(reason?: string): void {\r\n      this.ensureNotNotified();\r\n      sendMessageToParent('settings.save.failure', [reason]);\r\n      this.notified = true;\r\n    }\r\n    private ensureNotNotified(): void {\r\n      if (this.notified) {\r\n        throw new Error('The SaveEvent may only notify success or failure once.');\r\n      }\r\n    }\r\n  }\r\n\r\n  function handleRemove(): void {\r\n    const removeEvent = new RemoveEventImpl();\r\n    if (removeHandler) {\r\n      removeHandler(removeEvent);\r\n    } else {\r\n      // If no handler is registered, we assume success.\r\n      removeEvent.notifySuccess();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * Hide from docs, since this class is not directly used.\r\n   */\r\n  class RemoveEventImpl implements RemoveEvent {\r\n    public notified: boolean = false;\r\n\r\n    public notifySuccess(): void {\r\n      this.ensureNotNotified();\r\n      sendMessageToParent('settings.remove.success');\r\n      this.notified = true;\r\n    }\r\n\r\n    public notifyFailure(reason?: string): void {\r\n      this.ensureNotNotified();\r\n      sendMessageToParent('settings.remove.failure', [reason]);\r\n      this.notified = true;\r\n    }\r\n\r\n    private ensureNotNotified(): void {\r\n      if (this.notified) {\r\n        throw new Error('The removeEvent may only notify success or failure once.');\r\n      }\r\n    }\r\n  }\r\n}\r\n","import { ensureInitialized } from '../internal/internalAPIs';\r\nimport { sendMessageToParent } from '../internal/communication';\r\nimport { registerHandler, removeHandler } from '../internal/handlers';\r\n\r\n/**\r\n * Namespace to interact with the logging part of the SDK.\r\n * This object is used to send the app logs on demand to the host client\r\n *\r\n * @private\r\n * Hide from docs\r\n */\r\nexport namespace logs {\r\n  /**\r\n   * @private\r\n   * Hide from docs\r\n   * ------\r\n   * Registers a handler for getting app log\r\n   * @param handler The handler to invoke to get the app log\r\n   */\r\n  export function registerGetLogHandler(handler: () => string): void {\r\n    ensureInitialized();\r\n\r\n    if (handler) {\r\n      registerHandler('log.request', () => {\r\n        const log: string = handler();\r\n        sendMessageToParent('log.receive', [log]);\r\n      });\r\n    } else {\r\n      removeHandler('log.request');\r\n    }\r\n  }\r\n}\r\n","import { ensureInitialized, isAPISupportedByPlatform } from '../internal/internalAPIs';\r\nimport { FrameContexts, HostClientType } from '../public/constants';\r\nimport {\r\n  ChatMembersInformation,\r\n  ShowNotificationParameters,\r\n  FilePreviewParameters,\r\n  TeamInstanceParameters,\r\n  UserJoinedTeamsInformation,\r\n  UserSettingTypes,\r\n} from './interfaces';\r\nimport { getGenericOnCompleteHandler } from '../internal/utils';\r\nimport { Communication, sendMessageToParent, sendMessageEventToChild } from '../internal/communication';\r\nimport { menus } from './menus';\r\nimport { registerHandler } from '../internal/handlers';\r\nimport { GlobalVars } from '../internal/globalVars';\r\nimport { ErrorCode, SdkError } from '../public/interfaces';\r\nimport { getUserJoinedTeamsSupportedAndroidClientVersion } from '../internal/constants';\r\n\r\nexport function initializePrivateApis(): void {\r\n  menus.initialize();\r\n}\r\n\r\n/**\r\n * @private\r\n * Hide from docs\r\n * ------\r\n * Allows an app to retrieve information of all user joined teams\r\n * @param callback The callback to invoke when the {@link TeamInstanceParameters} object is retrieved.\r\n * @param teamInstanceParameters OPTIONAL Flags that specify whether to scope call to favorite teams\r\n */\r\nexport function getUserJoinedTeams(\r\n  callback: (userJoinedTeamsInformation: UserJoinedTeamsInformation) => void,\r\n  teamInstanceParameters?: TeamInstanceParameters,\r\n): void {\r\n  ensureInitialized();\r\n\r\n  if (\r\n    (GlobalVars.hostClientType === HostClientType.android ||\r\n      GlobalVars.hostClientType === HostClientType.teamsRoomsAndroid ||\r\n      GlobalVars.hostClientType === HostClientType.teamsPhones ||\r\n      GlobalVars.hostClientType === HostClientType.teamsDisplays) &&\r\n    !isAPISupportedByPlatform(getUserJoinedTeamsSupportedAndroidClientVersion)\r\n  ) {\r\n    const oldPlatformError: SdkError = { errorCode: ErrorCode.OLD_PLATFORM };\r\n    throw new Error(JSON.stringify(oldPlatformError));\r\n  }\r\n\r\n  sendMessageToParent('getUserJoinedTeams', [teamInstanceParameters], callback);\r\n}\r\n\r\n/**\r\n * @private\r\n * Hide from docs\r\n * ------\r\n * Place the tab into full-screen mode.\r\n */\r\nexport function enterFullscreen(): void {\r\n  ensureInitialized(FrameContexts.content);\r\n  sendMessageToParent('enterFullscreen', []);\r\n}\r\n\r\n/**\r\n * @private\r\n * Hide from docs\r\n * ------\r\n * Reverts the tab into normal-screen mode.\r\n */\r\nexport function exitFullscreen(): void {\r\n  ensureInitialized(FrameContexts.content);\r\n  sendMessageToParent('exitFullscreen', []);\r\n}\r\n\r\n/**\r\n * @private\r\n * Hide from docs.\r\n * ------\r\n * Opens a client-friendly preview of the specified file.\r\n * @param file The file to preview.\r\n */\r\nexport function openFilePreview(filePreviewParameters: FilePreviewParameters): void {\r\n  ensureInitialized(FrameContexts.content);\r\n\r\n  const params = [\r\n    filePreviewParameters.entityId,\r\n    filePreviewParameters.title,\r\n    filePreviewParameters.description,\r\n    filePreviewParameters.type,\r\n    filePreviewParameters.objectUrl,\r\n    filePreviewParameters.downloadUrl,\r\n    filePreviewParameters.webPreviewUrl,\r\n    filePreviewParameters.webEditUrl,\r\n    filePreviewParameters.baseUrl,\r\n    filePreviewParameters.editFile,\r\n    filePreviewParameters.subEntityId,\r\n    filePreviewParameters.viewerAction,\r\n    filePreviewParameters.fileOpenPreference,\r\n  ];\r\n\r\n  sendMessageToParent('openFilePreview', params);\r\n}\r\n\r\n/**\r\n * @private\r\n * Hide from docs.\r\n * ------\r\n * display notification API.\r\n * @param message Notification message.\r\n * @param notificationType Notification type\r\n */\r\nexport function showNotification(showNotificationParameters: ShowNotificationParameters): void {\r\n  ensureInitialized(FrameContexts.content);\r\n  const params = [showNotificationParameters.message, showNotificationParameters.notificationType];\r\n  sendMessageToParent('showNotification', params);\r\n}\r\n\r\n/**\r\n * @private\r\n * Hide from docs.\r\n * ------\r\n * Upload a custom App manifest directly to both team and personal scopes.\r\n * This method works just for the first party Apps.\r\n */\r\nexport function uploadCustomApp(manifestBlob: Blob, onComplete?: (status: boolean, reason?: string) => void): void {\r\n  ensureInitialized();\r\n\r\n  sendMessageToParent('uploadCustomApp', [manifestBlob], onComplete ? onComplete : getGenericOnCompleteHandler());\r\n}\r\n\r\n/**\r\n * @private\r\n * Internal use only\r\n * Sends a custom action MessageRequest to Teams or parent window\r\n * @param actionName Specifies name of the custom action to be sent\r\n * @param args Specifies additional arguments passed to the action\r\n * @param callback Optionally specify a callback to receive response parameters from the parent\r\n * @returns id of sent message\r\n */\r\nexport function sendCustomMessage(\r\n  actionName: string,\r\n  // tslint:disable-next-line:no-any\r\n  args?: any[],\r\n  // tslint:disable-next-line:no-any\r\n  callback?: (...args: any[]) => void,\r\n): void {\r\n  ensureInitialized();\r\n\r\n  sendMessageToParent(actionName, args, callback);\r\n}\r\n\r\n/**\r\n * @private\r\n * Internal use only\r\n * Sends a custom action MessageEvent to a child iframe/window, only if you are not using auth popup.\r\n * Otherwise it will go to the auth popup (which becomes the child)\r\n * @param actionName Specifies name of the custom action to be sent\r\n * @param args Specifies additional arguments passed to the action\r\n * @returns id of sent message\r\n */\r\nexport function sendCustomEvent(\r\n  actionName: string,\r\n  // tslint:disable-next-line:no-any\r\n  args?: any[],\r\n): void {\r\n  ensureInitialized();\r\n\r\n  //validate childWindow\r\n  if (!Communication.childWindow) {\r\n    throw new Error('The child window has not yet been initialized or is not present');\r\n  }\r\n  sendMessageEventToChild(actionName, args);\r\n}\r\n\r\n/**\r\n * @private\r\n * Internal use only\r\n * Adds a handler for an action sent by a child window or parent window\r\n * @param actionName Specifies name of the action message to handle\r\n * @param customHandler The callback to invoke when the action message is received. The return value is sent to the child\r\n */\r\nexport function registerCustomHandler(\r\n  actionName: string,\r\n  customHandler: (\r\n    // tslint:disable-next-line:no-any\r\n    ...args: any[]\r\n  ) => any[],\r\n): void {\r\n  ensureInitialized();\r\n  registerHandler(actionName, (...args: any[]) => {\r\n    return customHandler.apply(this, args);\r\n  });\r\n}\r\n\r\n/**\r\n * @private\r\n * Hide from docs\r\n * ------\r\n * Allows an app to retrieve information of all chat members\r\n * Because a malicious party run your content in a browser, this value should\r\n * be used only as a hint as to who the members are and never as proof of membership.\r\n * @param callback The callback to invoke when the {@link ChatMembersInformation} object is retrieved.\r\n */\r\nexport function getChatMembers(callback: (chatMembersInformation: ChatMembersInformation) => void): void {\r\n  ensureInitialized();\r\n\r\n  sendMessageToParent('getChatMembers', callback);\r\n}\r\n\r\n/**\r\n * @private\r\n * Hide from docs\r\n * ------\r\n * Allows an app to get the configuration setting value\r\n * @param callback The callback to invoke when the value is retrieved.\r\n * @param key The key for the config setting\r\n */\r\nexport function getConfigSetting(callback: (value: string) => void, key: string): void {\r\n  ensureInitialized();\r\n\r\n  sendMessageToParent('getConfigSetting', [key], callback);\r\n}\r\n\r\n/**\r\n * @private\r\n * register a handler to be called when a user setting changes. The changed setting type & value is provided in the callback.\r\n * @param settingTypes List of user setting changes to subscribe\r\n * @param handler When a subscribed setting is updated this handler is called\r\n */\r\nexport function registerUserSettingsChangeHandler(\r\n  settingTypes: UserSettingTypes[],\r\n  handler: (settingType: UserSettingTypes, value: any) => void,\r\n): void {\r\n  ensureInitialized();\r\n\r\n  registerHandler('userSettingsChange', handler, true, [settingTypes]);\r\n}\r\n","import { ensureInitialized } from '../internal/internalAPIs';\r\nimport { sendMessageToParent } from '../internal/communication';\r\nimport { registerHandler } from '../internal/handlers';\r\n/**\r\n * Namespace to interact with the menu-specific part of the SDK.\r\n * This object is used to show View Configuration, Action Menu and Navigation Bar Menu.\r\n *\r\n * @private\r\n * Hide from docs until feature is complete\r\n */\r\nexport namespace menus {\r\n  /**\r\n   * Represents information about item in View Configuration.\r\n   */\r\n  export interface ViewConfiguration {\r\n    /**\r\n     * Unique identifier of view.\r\n     */\r\n    id: string;\r\n    /**\r\n     * Display title of the view.\r\n     */\r\n    title: string;\r\n    /**\r\n     * Additional information for accessibility.\r\n     */\r\n    contentDescription?: string;\r\n  }\r\n  /**\r\n   * Represents information about menu item for Action Menu and Navigation Bar Menu.\r\n   */\r\n  export class MenuItem {\r\n    /**\r\n     * Unique identifier for the menu item.\r\n     */\r\n    public id: string;\r\n    /**\r\n     * Display title of the menu item.\r\n     */\r\n    public title: string;\r\n    /**\r\n     * Display icon of the menu item. The icon value must be a string having SVG icon content.\r\n     */\r\n    public icon: string;\r\n    /**\r\n     * Selected state display icon of the menu item. The icon value must be a string having SVG icon content.\r\n     */\r\n    public iconSelected?: string;\r\n    /**\r\n     * Additional information for accessibility.\r\n     */\r\n    public contentDescription?: string;\r\n    /**\r\n     * State of the menu item\r\n     */\r\n    public enabled: boolean = true;\r\n    /**\r\n     * Interface to show list of items on selection of menu item.\r\n     */\r\n    public viewData: ViewData;\r\n    /**\r\n     * Whether the menu item is selected or not\r\n     */\r\n    public selected: boolean = false;\r\n  }\r\n  /**\r\n   * Represents information about view to show on Navigation Bar Menu item selection\r\n   */\r\n  export interface ViewData {\r\n    /**\r\n     * Display header title of the item list.\r\n     */\r\n    listTitle?: string;\r\n    /**\r\n     * Type of the menu item.\r\n     */\r\n    listType: MenuListType;\r\n    /**\r\n     * Array of MenuItem. Icon value will be required for all items in the list.\r\n     */\r\n    listItems: MenuItem[];\r\n  }\r\n  /**\r\n   * Represents information about type of list to display in Navigation Bar Menu.\r\n   */\r\n  export enum MenuListType {\r\n    dropDown = 'dropDown',\r\n    popOver = 'popOver',\r\n  }\r\n  let navBarMenuItemPressHandler: (id: string) => boolean;\r\n  let actionMenuItemPressHandler: (id: string) => boolean;\r\n  let viewConfigItemPressHandler: (id: string) => boolean;\r\n\r\n  export function initialize(): void {\r\n    registerHandler('navBarMenuItemPress', handleNavBarMenuItemPress, false);\r\n    registerHandler('actionMenuItemPress', handleActionMenuItemPress, false);\r\n    registerHandler('setModuleView', handleViewConfigItemPress, false);\r\n  }\r\n  /**\r\n   * Registers list of view configurations and it's handler.\r\n   * Handler is responsible for listening selection of View Configuration.\r\n   * @param viewConfig List of view configurations. Minimum 1 value is required.\r\n   * @param handler The handler to invoke when the user selects view configuration.\r\n   */\r\n  export function setUpViews(viewConfig: ViewConfiguration[], handler: (id: string) => boolean): void {\r\n    ensureInitialized();\r\n    viewConfigItemPressHandler = handler;\r\n    sendMessageToParent('setUpViews', [viewConfig]);\r\n  }\r\n  function handleViewConfigItemPress(id: string): void {\r\n    if (!viewConfigItemPressHandler || !viewConfigItemPressHandler(id)) {\r\n      ensureInitialized();\r\n      sendMessageToParent('viewConfigItemPress', [id]);\r\n    }\r\n  }\r\n  /**\r\n   * Used to set menu items on the Navigation Bar. If icon is available, icon will be shown, otherwise title will be shown.\r\n   * @param items List of MenuItems for Navigation Bar Menu.\r\n   * @param handler The handler to invoke when the user selects menu item.\r\n   */\r\n  export function setNavBarMenu(items: MenuItem[], handler: (id: string) => boolean): void {\r\n    ensureInitialized();\r\n    navBarMenuItemPressHandler = handler;\r\n    sendMessageToParent('setNavBarMenu', [items]);\r\n  }\r\n  function handleNavBarMenuItemPress(id: string): void {\r\n    if (!navBarMenuItemPressHandler || !navBarMenuItemPressHandler(id)) {\r\n      ensureInitialized();\r\n      sendMessageToParent('handleNavBarMenuItemPress', [id]);\r\n    }\r\n  }\r\n  export interface ActionMenuParameters {\r\n    /**\r\n     * Display title for Action Menu\r\n     */\r\n    title: string;\r\n    /**\r\n     * List of MenuItems for Action Menu\r\n     */\r\n    items: MenuItem[];\r\n  }\r\n  /**\r\n   * Used to show Action Menu.\r\n   * @param params Parameters for Menu Parameters\r\n   * @param handler The handler to invoke when the user selects menu item.\r\n   */\r\n  export function showActionMenu(params: ActionMenuParameters, handler: (id: string) => boolean): void {\r\n    ensureInitialized();\r\n    actionMenuItemPressHandler = handler;\r\n    sendMessageToParent('showActionMenu', [params]);\r\n  }\r\n  function handleActionMenuItemPress(id: string): void {\r\n    if (!actionMenuItemPressHandler || !actionMenuItemPressHandler(id)) {\r\n      ensureInitialized();\r\n      sendMessageToParent('handleActionMenuItemPress', [id]);\r\n    }\r\n  }\r\n}\r\n","import { ensureInitialized } from '../internal/internalAPIs';\r\nimport { FrameContexts } from './constants';\r\nimport { getGenericOnCompleteHandler } from '../internal/utils';\r\nimport { sendMessageToParent } from '../internal/communication';\r\nimport { registerHandler } from '../internal/handlers';\r\n\r\nexport interface IAppWindow {\r\n  postMessage(message): void;\r\n  addEventListener(type: string, listener: Function): void;\r\n}\r\n\r\nexport class ChildAppWindow implements IAppWindow {\r\n  public postMessage(message: any, onComplete?: (status: boolean, reason?: string) => void): void {\r\n    ensureInitialized();\r\n    sendMessageToParent('messageForChild', [message], onComplete ? onComplete : getGenericOnCompleteHandler());\r\n  }\r\n\r\n  public addEventListener(type: string, listener: (message: any) => void): void {\r\n    if (type === 'message') {\r\n      registerHandler('messageForParent', listener);\r\n    }\r\n  }\r\n}\r\n\r\nexport class ParentAppWindow implements IAppWindow {\r\n  private static _instance: ParentAppWindow;\r\n  public static get Instance(): IAppWindow {\r\n    // Do you need arguments? Make it a regular method instead.\r\n    return this._instance || (this._instance = new this());\r\n  }\r\n\r\n  public postMessage(message: any, onComplete?: (status: boolean, reason?: string) => void): void {\r\n    ensureInitialized(FrameContexts.task);\r\n    sendMessageToParent('messageForParent', [message], onComplete ? onComplete : getGenericOnCompleteHandler());\r\n  }\r\n\r\n  public addEventListener(type: string, listener: (message: any) => void): void {\r\n    if (type === 'message') {\r\n      registerHandler('messageForChild', listener);\r\n    }\r\n  }\r\n}\r\n","import { GlobalVars } from '../internal/globalVars';\r\nimport { SdkError, ErrorCode } from './interfaces';\r\nimport { ensureInitialized, isAPISupportedByPlatform } from '../internal/internalAPIs';\r\nimport { FrameContexts, HostClientType } from './constants';\r\nimport { generateGUID } from '../internal/utils';\r\nimport {\r\n  createFile,\r\n  decodeAttachment,\r\n  validateSelectMediaInputs,\r\n  validateGetMediaInputs,\r\n  validateViewImagesInput,\r\n  validateScanBarCodeInput,\r\n  isMediaCallForVideoAndImageInputs,\r\n} from '../internal/mediaUtil';\r\nimport { sendMessageToParent } from '../internal/communication';\r\nimport { registerHandler, removeHandler } from '../internal/handlers';\r\nimport {\r\n  captureImageMobileSupportVersion,\r\n  mediaAPISupportVersion,\r\n  getMediaCallbackSupportVersion,\r\n  scanBarCodeAPIMobileSupportVersion,\r\n  videoAndImageMediaAPISupportVersion,\r\n} from '../internal/constants';\r\n\r\nexport namespace media {\r\n  /**\r\n   * Enum for file formats supported\r\n   */\r\n  export enum FileFormat {\r\n    Base64 = 'base64',\r\n    ID = 'id',\r\n  }\r\n\r\n  /**\r\n   * File object that can be used to represent image or video or audio\r\n   */\r\n  export class File {\r\n    /**\r\n     * Content of the file. When format is Base64, this is the base64 content\r\n     * When format is ID, this is id mapping to the URI\r\n     * When format is base64 and app needs to use this directly in HTML tags, it should convert this to dataUrl.\r\n     */\r\n    public content: string;\r\n\r\n    /**\r\n     * Format of the content\r\n     */\r\n    public format: FileFormat;\r\n\r\n    /**\r\n     *Size of the file in KB\r\n     */\r\n    public size: number;\r\n\r\n    /**\r\n     *MIME type. This can be used for constructing a dataUrl, if needed.\r\n     */\r\n    public mimeType: string;\r\n\r\n    /**\r\n     *Optional: Name of the file\r\n     */\r\n    public name?: string;\r\n  }\r\n\r\n  /**\r\n   * Launch camera, capture image or choose image from gallery and return the images as a File[] object to the callback.\r\n   * Callback will be called with an error, if there are any. App should first check the error.\r\n   * If it is present the user can be updated with appropriate error message.\r\n   * If error is null or undefined, then files will have the required result.\r\n   * Note: Currently we support getting one File through this API, i.e. the file arrays size will be one.\r\n   * Note: For desktop, this API is not supported. Callback will be resolved with ErrorCode.NotSupported.\r\n   * @see File\r\n   * @see SdkError\r\n   */\r\n  export function captureImage(callback: (error: SdkError, files: File[]) => void): void {\r\n    if (!callback) {\r\n      throw new Error('[captureImage] Callback cannot be null');\r\n    }\r\n    ensureInitialized(FrameContexts.content, FrameContexts.task);\r\n\r\n    if (!GlobalVars.isFramelessWindow) {\r\n      const notSupportedError: SdkError = { errorCode: ErrorCode.NOT_SUPPORTED_ON_PLATFORM };\r\n      callback(notSupportedError, undefined);\r\n      return;\r\n    }\r\n\r\n    if (!isAPISupportedByPlatform(captureImageMobileSupportVersion)) {\r\n      const oldPlatformError: SdkError = { errorCode: ErrorCode.OLD_PLATFORM };\r\n      callback(oldPlatformError, undefined);\r\n      return;\r\n    }\r\n\r\n    sendMessageToParent('captureImage', callback);\r\n  }\r\n\r\n  /**\r\n   * Media object returned by the select Media API\r\n   */\r\n  export class Media extends File {\r\n    constructor(that: Media = null) {\r\n      super();\r\n      if (that) {\r\n        this.content = that.content;\r\n        this.format = that.format;\r\n        this.mimeType = that.mimeType;\r\n        this.name = that.name;\r\n        this.preview = that.preview;\r\n        this.size = that.size;\r\n      }\r\n    }\r\n\r\n    /**\r\n     * A preview of the file which is a lightweight representation.\r\n     * In case of images this will be a thumbnail/compressed image in base64 encoding.\r\n     */\r\n    public preview: string;\r\n\r\n    /**\r\n     * Gets the media in chunks irrespecitve of size, these chunks are assembled and sent back to the webapp as file/blob\r\n     * @param callback returns blob of media\r\n     */\r\n    public getMedia(callback: (error: SdkError, blob: Blob) => void): void {\r\n      if (!callback) {\r\n        throw new Error('[get Media] Callback cannot be null');\r\n      }\r\n      ensureInitialized(FrameContexts.content, FrameContexts.task);\r\n      if (!isAPISupportedByPlatform(mediaAPISupportVersion)) {\r\n        const oldPlatformError: SdkError = { errorCode: ErrorCode.OLD_PLATFORM };\r\n        callback(oldPlatformError, null);\r\n        return;\r\n      }\r\n      if (!validateGetMediaInputs(this.mimeType, this.format, this.content)) {\r\n        const invalidInput: SdkError = { errorCode: ErrorCode.INVALID_ARGUMENTS };\r\n        callback(invalidInput, null);\r\n        return;\r\n      }\r\n      // Call the new get media implementation via callbacks if the client version is greater than or equal to '2.0.0'\r\n      if (isAPISupportedByPlatform(getMediaCallbackSupportVersion)) {\r\n        this.getMediaViaCallback(callback);\r\n      } else {\r\n        this.getMediaViaHandler(callback);\r\n      }\r\n    }\r\n\r\n    private getMediaViaCallback(callback: (error: SdkError, blob: Blob) => void): void {\r\n      const helper: MediaHelper = {\r\n        mediaMimeType: this.mimeType,\r\n        assembleAttachment: [],\r\n      };\r\n      const localUriId = [this.content];\r\n      function handleGetMediaCallbackRequest(mediaResult: MediaResult): void {\r\n        if (callback) {\r\n          if (mediaResult && mediaResult.error) {\r\n            callback(mediaResult.error, null);\r\n          } else {\r\n            if (mediaResult && mediaResult.mediaChunk) {\r\n              // If the chunksequence number is less than equal to 0 implies EOF\r\n              // create file/blob when all chunks have arrived and we get 0/-1 as chunksequence number\r\n              if (mediaResult.mediaChunk.chunkSequence <= 0) {\r\n                const file = createFile(helper.assembleAttachment, helper.mediaMimeType);\r\n                callback(mediaResult.error, file);\r\n              } else {\r\n                // Keep pushing chunks into assemble attachment\r\n                const assemble: AssembleAttachment = decodeAttachment(mediaResult.mediaChunk, helper.mediaMimeType);\r\n                helper.assembleAttachment.push(assemble);\r\n              }\r\n            } else {\r\n              callback({ errorCode: ErrorCode.INTERNAL_ERROR, message: 'data receieved is null' }, null);\r\n            }\r\n          }\r\n        }\r\n      }\r\n      sendMessageToParent('getMedia', localUriId, handleGetMediaCallbackRequest);\r\n    }\r\n\r\n    private getMediaViaHandler(callback: (error: SdkError, blob: Blob) => void): void {\r\n      const actionName = generateGUID();\r\n      const helper: MediaHelper = {\r\n        mediaMimeType: this.mimeType,\r\n        assembleAttachment: [],\r\n      };\r\n      const params = [actionName, this.content];\r\n      this.content && callback && sendMessageToParent('getMedia', params);\r\n      function handleGetMediaRequest(response: string): void {\r\n        if (callback) {\r\n          const mediaResult: MediaResult = JSON.parse(response);\r\n          if (mediaResult.error) {\r\n            callback(mediaResult.error, null);\r\n            removeHandler('getMedia' + actionName);\r\n          } else {\r\n            if (mediaResult.mediaChunk) {\r\n              // If the chunksequence number is less than equal to 0 implies EOF\r\n              // create file/blob when all chunks have arrived and we get 0/-1 as chunksequence number\r\n              if (mediaResult.mediaChunk.chunkSequence <= 0) {\r\n                const file = createFile(helper.assembleAttachment, helper.mediaMimeType);\r\n                callback(mediaResult.error, file);\r\n                removeHandler('getMedia' + actionName);\r\n              } else {\r\n                // Keep pushing chunks into assemble attachment\r\n                const assemble: AssembleAttachment = decodeAttachment(mediaResult.mediaChunk, helper.mediaMimeType);\r\n                helper.assembleAttachment.push(assemble);\r\n              }\r\n            } else {\r\n              callback({ errorCode: ErrorCode.INTERNAL_ERROR, message: 'data receieved is null' }, null);\r\n              removeHandler('getMedia' + actionName);\r\n            }\r\n          }\r\n        }\r\n      }\r\n\r\n      registerHandler('getMedia' + actionName, handleGetMediaRequest);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Input parameter supplied to the select Media API\r\n   */\r\n  export interface MediaInputs {\r\n    /**\r\n     * Only one media type can be selected at a time\r\n     */\r\n    mediaType: MediaType;\r\n\r\n    /**\r\n     * max limit of media allowed to be selected in one go, current max limit is 10 set by office lens.\r\n     */\r\n    maxMediaCount: number;\r\n\r\n    /**\r\n     * Additional properties for customization of select media - Image in mobile devices\r\n     */\r\n    imageProps?: ImageProps;\r\n\r\n    /**\r\n     * Additional properties for customization of select media - VideoAndImage in mobile devices\r\n     */\r\n    videoAndImageProps?: VideoAndImageProps;\r\n\r\n    /**\r\n     * Additional properties for audio capture flows.\r\n     */\r\n    audioProps?: AudioProps;\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * Hide from docs\r\n   * --------\r\n   * All properties common to Image and Video Props\r\n   */\r\n  interface MediaProps {\r\n    /**\r\n     * Optional; Lets the developer specify the media source, more than one can be specified.\r\n     * Default value is both camera and gallery\r\n     */\r\n    sources?: Source[];\r\n\r\n    /**\r\n     * Optional; Specify in which mode the camera will be opened.\r\n     * Default value is Photo\r\n     */\r\n    startMode?: CameraStartMode;\r\n\r\n    /**\r\n     * Optional; indicate if user is allowed to move between front and back camera\r\n     * Default value is true\r\n     */\r\n    cameraSwitcher?: boolean;\r\n  }\r\n\r\n  /**\r\n   *  All properties in ImageProps are optional and have default values in the platform\r\n   */\r\n  export interface ImageProps extends MediaProps {\r\n    /**\r\n     * Optional; indicate if inking on the selected Image is allowed or not\r\n     * Default value is true\r\n     */\r\n    ink?: boolean;\r\n\r\n    /**\r\n     * Optional; indicate if putting text stickers on the selected Image is allowed or not\r\n     * Default value is true\r\n     */\r\n    textSticker?: boolean;\r\n\r\n    /**\r\n     * Optional; indicate if image filtering mode is enabled on the selected image\r\n     * Default value is false\r\n     */\r\n    enableFilter?: boolean;\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * Hide from docs\r\n   * --------\r\n   * All properties in VideoProps are optional and have default values in the platform\r\n   */\r\n  interface VideoProps extends MediaProps {\r\n    /**\r\n     * Optional; the maximum duration in minutes after which the recording should terminate automatically.\r\n     * Default value is defined by the platform serving the API.\r\n     */\r\n    maxDuration?: number;\r\n  }\r\n\r\n  /**\r\n   * All properties in VideoAndImageProps are optional and have default values in the platform\r\n   */\r\n  export interface VideoAndImageProps extends ImageProps, VideoProps {}\r\n\r\n  /**\r\n   *  All properties in AudioProps are optional and have default values in the platform\r\n   */\r\n  export interface AudioProps {\r\n    /**\r\n     * Optional; the maximum duration in minutes after which the recording should terminate automatically.\r\n     * Default value is defined by the platform serving the API.\r\n     */\r\n    maxDuration?: number;\r\n  }\r\n\r\n  /**\r\n   * The modes in which camera can be launched in select Media API\r\n   */\r\n  export enum CameraStartMode {\r\n    Photo = 1,\r\n    Document = 2,\r\n    Whiteboard = 3,\r\n    BusinessCard = 4,\r\n  }\r\n\r\n  /**\r\n   * Specifies the image source\r\n   */\r\n  export enum Source {\r\n    Camera = 1,\r\n    Gallery = 2,\r\n  }\r\n\r\n  /**\r\n   * Specifies the type of Media\r\n   */\r\n  export enum MediaType {\r\n    Image = 1,\r\n    // Video = 2, // Not implemented yet\r\n    VideoAndImage = 3,\r\n    Audio = 4,\r\n  }\r\n\r\n  /**\r\n   * Input for view images API\r\n   */\r\n  export interface ImageUri {\r\n    value: string;\r\n    type: ImageUriType;\r\n  }\r\n\r\n  /**\r\n   * ID contains a mapping for content uri on platform's side, URL is generic\r\n   */\r\n  export enum ImageUriType {\r\n    ID = 1,\r\n    URL = 2,\r\n  }\r\n\r\n  /**\r\n   * Media chunks an output of getMedia API from platform\r\n   */\r\n  export interface MediaChunk {\r\n    /**\r\n     * Base 64 data for the requested uri\r\n     */\r\n    chunk: string;\r\n\r\n    /**\r\n     * chunk sequence number\r\n     */\r\n    chunkSequence: number;\r\n  }\r\n\r\n  /**\r\n   * Output of getMedia API from platform\r\n   */\r\n  interface MediaResult {\r\n    /**\r\n     * error encountered in getMedia API\r\n     */\r\n    error: SdkError;\r\n\r\n    /**\r\n     * Media chunk which will be assemebled and converted into a blob\r\n     */\r\n    mediaChunk: MediaChunk;\r\n  }\r\n\r\n  /**\r\n   * Helper object to assembled media chunks\r\n   */\r\n  export interface AssembleAttachment {\r\n    sequence: number;\r\n    file: Blob;\r\n  }\r\n\r\n  /**\r\n   * Helper class for assembling media\r\n   */\r\n  interface MediaHelper {\r\n    mediaMimeType: string;\r\n    assembleAttachment: AssembleAttachment[];\r\n  }\r\n\r\n  /**\r\n   * Select an attachment using camera/gallery\r\n   * @param mediaInputs The input params to customize the media to be selected\r\n   * @param callback The callback to invoke after fetching the media\r\n   */\r\n  export function selectMedia(\r\n    mediaInputs: MediaInputs,\r\n    callback: (error: SdkError, attachments: Media[]) => void,\r\n  ): void {\r\n    if (!callback) {\r\n      throw new Error('[select Media] Callback cannot be null');\r\n    }\r\n\r\n    ensureInitialized(FrameContexts.content, FrameContexts.task);\r\n    if (!isAPISupportedByPlatform(mediaAPISupportVersion)) {\r\n      const oldPlatformError: SdkError = { errorCode: ErrorCode.OLD_PLATFORM };\r\n      callback(oldPlatformError, null);\r\n      return;\r\n    }\r\n\r\n    if (isMediaCallForVideoAndImageInputs(mediaInputs)) {\r\n      if (GlobalVars.hostClientType != HostClientType.android && GlobalVars.hostClientType != HostClientType.ios) {\r\n        const notSupportedError: SdkError = { errorCode: ErrorCode.NOT_SUPPORTED_ON_PLATFORM };\r\n        callback(notSupportedError, null);\r\n        return;\r\n      } else if (!isAPISupportedByPlatform(videoAndImageMediaAPISupportVersion)) {\r\n        const oldPlatformError: SdkError = { errorCode: ErrorCode.OLD_PLATFORM };\r\n        callback(oldPlatformError, null);\r\n        return;\r\n      }\r\n    }\r\n\r\n    if (!validateSelectMediaInputs(mediaInputs)) {\r\n      const invalidInput: SdkError = { errorCode: ErrorCode.INVALID_ARGUMENTS };\r\n      callback(invalidInput, null);\r\n      return;\r\n    }\r\n\r\n    const params = [mediaInputs];\r\n    // What comes back from native at attachments would just be objects and will be missing getMedia method on them.\r\n    sendMessageToParent('selectMedia', params, (err: SdkError, localAttachments: Media[]) => {\r\n      if (!localAttachments) {\r\n        callback(err, null);\r\n        return;\r\n      }\r\n      let mediaArray: Media[] = [];\r\n      for (let attachment of localAttachments) {\r\n        mediaArray.push(new Media(attachment));\r\n      }\r\n      callback(err, mediaArray);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * View images using native image viewer\r\n   * @param uriList urilist of images to be viewed - can be content uri or server url. supports upto 10 Images in one go\r\n   * @param callback returns back error if encountered, returns null in case of success\r\n   */\r\n  export function viewImages(uriList: ImageUri[], callback: (error?: SdkError) => void): void {\r\n    if (!callback) {\r\n      throw new Error('[view images] Callback cannot be null');\r\n    }\r\n    ensureInitialized(FrameContexts.content, FrameContexts.task);\r\n\r\n    if (!isAPISupportedByPlatform(mediaAPISupportVersion)) {\r\n      const oldPlatformError: SdkError = { errorCode: ErrorCode.OLD_PLATFORM };\r\n      callback(oldPlatformError);\r\n      return;\r\n    }\r\n    if (!validateViewImagesInput(uriList)) {\r\n      const invalidInput: SdkError = { errorCode: ErrorCode.INVALID_ARGUMENTS };\r\n      callback(invalidInput);\r\n      return;\r\n    }\r\n\r\n    const params = [uriList];\r\n    sendMessageToParent('viewImages', params, callback);\r\n  }\r\n\r\n  /**\r\n   * Barcode configuration supplied to scanBarCode API to customize barcode scanning experience in mobile\r\n   * All properties in BarCodeConfig are optional and have default values in the platform\r\n   */\r\n  export interface BarCodeConfig {\r\n    /**\r\n     * Optional; Lets the developer specify the scan timeout interval in seconds\r\n     * Default value is 30 seconds and max allowed value is 60 seconds\r\n     */\r\n    timeOutIntervalInSec?: number;\r\n  }\r\n\r\n  /**\r\n   * Scan Barcode/QRcode using camera\r\n   * Note: For desktop and web, this API is not supported. Callback will be resolved with ErrorCode.NotSupported.\r\n   * @param callback callback to invoke after scanning the barcode\r\n   * @param config optional input configuration to customize the barcode scanning experience\r\n   */\r\n  export function scanBarCode(callback: (error: SdkError, decodedText: string) => void, config?: BarCodeConfig): void {\r\n    if (!callback) {\r\n      throw new Error('[media.scanBarCode] Callback cannot be null');\r\n    }\r\n    ensureInitialized(FrameContexts.content, FrameContexts.task);\r\n\r\n    if (\r\n      GlobalVars.hostClientType === HostClientType.desktop ||\r\n      GlobalVars.hostClientType === HostClientType.web ||\r\n      GlobalVars.hostClientType === HostClientType.rigel ||\r\n      GlobalVars.hostClientType === HostClientType.teamsRoomsWindows ||\r\n      GlobalVars.hostClientType === HostClientType.teamsRoomsAndroid ||\r\n      GlobalVars.hostClientType === HostClientType.teamsPhones ||\r\n      GlobalVars.hostClientType === HostClientType.teamsDisplays\r\n    ) {\r\n      const notSupportedError: SdkError = { errorCode: ErrorCode.NOT_SUPPORTED_ON_PLATFORM };\r\n      callback(notSupportedError, null);\r\n      return;\r\n    }\r\n\r\n    if (!isAPISupportedByPlatform(scanBarCodeAPIMobileSupportVersion)) {\r\n      const oldPlatformError: SdkError = { errorCode: ErrorCode.OLD_PLATFORM };\r\n      callback(oldPlatformError, null);\r\n      return;\r\n    }\r\n\r\n    if (!validateScanBarCodeInput(config)) {\r\n      const invalidInput: SdkError = { errorCode: ErrorCode.INVALID_ARGUMENTS };\r\n      callback(invalidInput, null);\r\n      return;\r\n    }\r\n\r\n    sendMessageToParent('media.scanBarCode', [config], callback);\r\n  }\r\n}\r\n","import { people } from '../public/people';\r\nimport { media } from '../public/media';\r\n\r\n/**\r\n * Helper function to create a blob from media chunks based on their sequence\r\n */\r\nexport function createFile(assembleAttachment: media.AssembleAttachment[], mimeType: string): Blob {\r\n  if (assembleAttachment == null || mimeType == null || assembleAttachment.length <= 0) {\r\n    return null;\r\n  }\r\n  let file: Blob;\r\n  let sequence = 1;\r\n  assembleAttachment.sort((a, b) => (a.sequence > b.sequence ? 1 : -1));\r\n  assembleAttachment.forEach(item => {\r\n    if (item.sequence == sequence) {\r\n      if (file) {\r\n        file = new Blob([file, item.file], { type: mimeType });\r\n      } else {\r\n        file = new Blob([item.file], { type: mimeType });\r\n      }\r\n      sequence++;\r\n    }\r\n  });\r\n  return file;\r\n}\r\n\r\n/**\r\n * Helper function to convert Media chunks into another object type which can be later assemebled\r\n * Converts base 64 encoded string to byte array and then into an array of blobs\r\n */\r\nexport function decodeAttachment(attachment: media.MediaChunk, mimeType: string): media.AssembleAttachment {\r\n  if (attachment == null || mimeType == null) {\r\n    return null;\r\n  }\r\n  const decoded = atob(attachment.chunk);\r\n  const byteNumbers = new Array(decoded.length);\r\n  for (let i = 0; i < decoded.length; i++) {\r\n    byteNumbers[i] = decoded.charCodeAt(i);\r\n  }\r\n  const byteArray = new Uint8Array(byteNumbers);\r\n  const blob: Blob = new Blob([byteArray], { type: mimeType });\r\n  const assemble: media.AssembleAttachment = {\r\n    sequence: attachment.chunkSequence,\r\n    file: blob,\r\n  };\r\n  return assemble;\r\n}\r\n\r\n/**\r\n * Returns true if the mediaInput params are valid and false otherwise\r\n */\r\nexport function validateSelectMediaInputs(mediaInputs: media.MediaInputs): boolean {\r\n  if (mediaInputs == null || mediaInputs.maxMediaCount > 10) {\r\n    return false;\r\n  }\r\n  return true;\r\n}\r\n\r\n/**\r\n * Returns true if the mediaInput params are called for mediatype VideoAndImage and false otherwise\r\n */\r\nexport function isMediaCallForVideoAndImageInputs(mediaInputs: media.MediaInputs): boolean {\r\n  if (mediaInputs) {\r\n    if (mediaInputs.mediaType == media.MediaType.VideoAndImage || mediaInputs.videoAndImageProps) {\r\n      return true;\r\n    }\r\n  }\r\n  return false;\r\n}\r\n\r\n/**\r\n * Returns true if the get Media params are valid and false otherwise\r\n */\r\nexport function validateGetMediaInputs(mimeType: string, format: media.FileFormat, content: string): boolean {\r\n  if (mimeType == null || format == null || format != media.FileFormat.ID || content == null) {\r\n    return false;\r\n  }\r\n  return true;\r\n}\r\n\r\n/**\r\n * Returns true if the view images param is valid and false otherwise\r\n */\r\nexport function validateViewImagesInput(uriList: media.ImageUri[]): boolean {\r\n  if (uriList == null || uriList.length <= 0 || uriList.length > 10) {\r\n    return false;\r\n  }\r\n  return true;\r\n}\r\n\r\n/**\r\n * Returns true if the scan barcode param is valid and false otherwise\r\n */\r\nexport function validateScanBarCodeInput(barCodeConfig: media.BarCodeConfig): boolean {\r\n  if (barCodeConfig) {\r\n    if (\r\n      barCodeConfig.timeOutIntervalInSec === null ||\r\n      barCodeConfig.timeOutIntervalInSec <= 0 ||\r\n      barCodeConfig.timeOutIntervalInSec > 60\r\n    ) {\r\n      return false;\r\n    }\r\n  }\r\n  return true;\r\n}\r\n\r\n/**\r\n * Returns true if the people picker params are valid and false otherwise\r\n */\r\nexport function validatePeoplePickerInput(peoplePickerInputs: people.PeoplePickerInputs): boolean {\r\n  if (peoplePickerInputs) {\r\n    if (peoplePickerInputs.title) {\r\n      if (typeof peoplePickerInputs.title !== 'string') {\r\n        return false;\r\n      }\r\n    }\r\n\r\n    if (peoplePickerInputs.setSelected) {\r\n      if (typeof peoplePickerInputs.setSelected !== 'object') {\r\n        return false;\r\n      }\r\n    }\r\n\r\n    if (peoplePickerInputs.openOrgWideSearchInChatOrChannel) {\r\n      if (typeof peoplePickerInputs.openOrgWideSearchInChatOrChannel !== 'boolean') {\r\n        return false;\r\n      }\r\n    }\r\n    if (peoplePickerInputs.singleSelect) {\r\n      if (typeof peoplePickerInputs.singleSelect !== 'boolean') {\r\n        return false;\r\n      }\r\n    }\r\n  }\r\n  return true;\r\n}\r\n","export * from './private/index';\r\nexport * from './public/index';\r\n","export { bot } from './bot';\r\nexport { menus } from './menus';\r\nexport { logs } from './logs';\r\nexport {\r\n  ChatMembersInformation,\r\n  FilePreviewParameters,\r\n  NotificationTypes,\r\n  ShowNotificationParameters,\r\n  TeamInstanceParameters,\r\n  ThreadMember,\r\n  UserJoinedTeamsInformation,\r\n  ViewerActionTypes,\r\n  UserSettingTypes,\r\n} from './interfaces';\r\nexport {\r\n  enterFullscreen,\r\n  exitFullscreen,\r\n  getChatMembers,\r\n  getConfigSetting,\r\n  getUserJoinedTeams,\r\n  openFilePreview,\r\n  sendCustomMessage,\r\n  showNotification,\r\n  sendCustomEvent,\r\n  registerCustomHandler,\r\n  uploadCustomApp,\r\n  registerUserSettingsChangeHandler,\r\n} from './privateAPIs';\r\nexport { conversations } from './conversations';\r\nexport { meetingRoom } from './meetingRoom';\r\nexport { remoteCamera } from './remoteCamera';\r\nexport { files } from './files';\r\nexport { appEntity } from './appEntity';\r\nexport { teams } from './teams';\r\n","import { sendMessageToParent } from '../internal/communication';\r\nimport { ensureInitialized } from '../internal/internalAPIs';\r\n\r\n/**\r\n * @private\r\n * Namespace to interact with bots using the SDK.\r\n */\r\nexport namespace bot {\r\n  /**\r\n   * @private\r\n   * Hide from docs until release.\r\n   * ------\r\n   * Sends query to bot in order to retrieve data.\r\n   * @param botRequest query to send to bot.\r\n   * @param onSuccess callback to invoke when data is retrieved from bot\r\n   * @param onError callback to invoke should an error occur\r\n   */\r\n  export function sendQuery(\r\n    botRequest: QueryRequest,\r\n    onSuccess?: (data: QueryResponse) => void,\r\n    onError?: (error: string) => void,\r\n  ): void {\r\n    ensureInitialized();\r\n\r\n    sendMessageToParent('bot.executeQuery', [botRequest], (success: boolean, response: string | QueryResponse) => {\r\n      if (success) {\r\n        onSuccess(response as QueryResponse);\r\n      } else {\r\n        onError(response as string);\r\n      }\r\n    });\r\n  }\r\n  /**\r\n   * @private\r\n   * Hide from docs until release.\r\n   * -----\r\n   * Retrieves list of support commands from bot\r\n   * @param onSuccess callback to invoke when data is retrieved from bot\r\n   * @param onError callback to invoke should an error occur\r\n   */\r\n  export function getSupportedCommands(\r\n    onSuccess?: (response: Command[]) => void,\r\n    onError?: (error: string) => void,\r\n  ): void {\r\n    ensureInitialized();\r\n\r\n    sendMessageToParent('bot.getSupportedCommands', (success: boolean, response: string | Command[]) => {\r\n      if (success) {\r\n        onSuccess(response as Command[]);\r\n      } else {\r\n        onError(response as string);\r\n      }\r\n    });\r\n  }\r\n  /**\r\n   * @private\r\n   * Hide from docs until release.\r\n   * -----\r\n   * Authenticates a user for json tab\r\n   * @param authRequest callback to invoke when data is retrieved from bot\r\n   * @param onSuccess callback to invoke when user is authenticated\r\n   * @param onError callback to invoke should an error occur\r\n   */\r\n  export function authenticate(\r\n    authRequest: AuthQueryRequest,\r\n    onSuccess?: (results: Results) => void,\r\n    onError?: (error: string) => void,\r\n  ): void {\r\n    ensureInitialized();\r\n\r\n    sendMessageToParent('bot.authenticate', [authRequest], (success: boolean, response: string | Results) => {\r\n      if (success) {\r\n        onSuccess(response as Results);\r\n      } else {\r\n        onError(response as string);\r\n      }\r\n    });\r\n  }\r\n\r\n  export interface QueryRequest {\r\n    /**\r\n     * Query to search for\r\n     */\r\n    query: string;\r\n    commandId?: string;\r\n    option?: {\r\n      skip: number;\r\n      count: number;\r\n    };\r\n  }\r\n\r\n  export interface QueryResponse {\r\n    data: Results | Auth;\r\n    type: ResponseType;\r\n  }\r\n\r\n  export interface Results {\r\n    attachments: Attachment[];\r\n    layout: any;\r\n    botId: string;\r\n  }\r\n\r\n  export interface Auth {\r\n    url: string;\r\n    title: string;\r\n  }\r\n\r\n  export interface AuthQueryRequest extends QueryRequest {\r\n    url: string;\r\n  }\r\n\r\n  export interface Attachment {\r\n    card: any;\r\n    previewCard: any;\r\n    previewRawPayload: any;\r\n    rawPayload: any;\r\n  }\r\n\r\n  export interface Command {\r\n    title: string;\r\n    id: string;\r\n    initialRun: boolean;\r\n  }\r\n\r\n  export enum ResponseType {\r\n    Results = 'Results',\r\n    Auth = 'Auth',\r\n  }\r\n}\r\n","var v1 = require('./v1');\nvar v4 = require('./v4');\n\nvar uuid = v4;\nuuid.v1 = v1;\nuuid.v4 = v4;\n\nmodule.exports = uuid;\n","var rng = require('./lib/rng');\nvar bytesToUuid = require('./lib/bytesToUuid');\n\n// **`v1()` - Generate time-based UUID**\n//\n// Inspired by https://github.com/LiosK/UUID.js\n// and http://docs.python.org/library/uuid.html\n\nvar _nodeId;\nvar _clockseq;\n\n// Previous uuid creation time\nvar _lastMSecs = 0;\nvar _lastNSecs = 0;\n\n// See https://github.com/broofa/node-uuid for API details\nfunction v1(options, buf, offset) {\n  var i = buf && offset || 0;\n  var b = buf || [];\n\n  options = options || {};\n  var node = options.node || _nodeId;\n  var clockseq = options.clockseq !== undefined ? options.clockseq : _clockseq;\n\n  // node and clockseq need to be initialized to random values if they're not\n  // specified.  We do this lazily to minimize issues related to insufficient\n  // system entropy.  See #189\n  if (node == null || clockseq == null) {\n    var seedBytes = rng();\n    if (node == null) {\n      // Per 4.5, create and 48-bit node id, (47 random bits + multicast bit = 1)\n      node = _nodeId = [\n        seedBytes[0] | 0x01,\n        seedBytes[1], seedBytes[2], seedBytes[3], seedBytes[4], seedBytes[5]\n      ];\n    }\n    if (clockseq == null) {\n      // Per 4.2.2, randomize (14 bit) clockseq\n      clockseq = _clockseq = (seedBytes[6] << 8 | seedBytes[7]) & 0x3fff;\n    }\n  }\n\n  // UUID timestamps are 100 nano-second units since the Gregorian epoch,\n  // (1582-10-15 00:00).  JSNumbers aren't precise enough for this, so\n  // time is handled internally as 'msecs' (integer milliseconds) and 'nsecs'\n  // (100-nanoseconds offset from msecs) since unix epoch, 1970-01-01 00:00.\n  var msecs = options.msecs !== undefined ? options.msecs : new Date().getTime();\n\n  // Per 4.2.1.2, use count of uuid's generated during the current clock\n  // cycle to simulate higher resolution clock\n  var nsecs = options.nsecs !== undefined ? options.nsecs : _lastNSecs + 1;\n\n  // Time since last uuid creation (in msecs)\n  var dt = (msecs - _lastMSecs) + (nsecs - _lastNSecs)/10000;\n\n  // Per 4.2.1.2, Bump clockseq on clock regression\n  if (dt < 0 && options.clockseq === undefined) {\n    clockseq = clockseq + 1 & 0x3fff;\n  }\n\n  // Reset nsecs if clock regresses (new clockseq) or we've moved onto a new\n  // time interval\n  if ((dt < 0 || msecs > _lastMSecs) && options.nsecs === undefined) {\n    nsecs = 0;\n  }\n\n  // Per 4.2.1.2 Throw error if too many uuids are requested\n  if (nsecs >= 10000) {\n    throw new Error('uuid.v1(): Can\\'t create more than 10M uuids/sec');\n  }\n\n  _lastMSecs = msecs;\n  _lastNSecs = nsecs;\n  _clockseq = clockseq;\n\n  // Per 4.1.4 - Convert from unix epoch to Gregorian epoch\n  msecs += 12219292800000;\n\n  // `time_low`\n  var tl = ((msecs & 0xfffffff) * 10000 + nsecs) % 0x100000000;\n  b[i++] = tl >>> 24 & 0xff;\n  b[i++] = tl >>> 16 & 0xff;\n  b[i++] = tl >>> 8 & 0xff;\n  b[i++] = tl & 0xff;\n\n  // `time_mid`\n  var tmh = (msecs / 0x100000000 * 10000) & 0xfffffff;\n  b[i++] = tmh >>> 8 & 0xff;\n  b[i++] = tmh & 0xff;\n\n  // `time_high_and_version`\n  b[i++] = tmh >>> 24 & 0xf | 0x10; // include version\n  b[i++] = tmh >>> 16 & 0xff;\n\n  // `clock_seq_hi_and_reserved` (Per 4.2.2 - include variant)\n  b[i++] = clockseq >>> 8 | 0x80;\n\n  // `clock_seq_low`\n  b[i++] = clockseq & 0xff;\n\n  // `node`\n  for (var n = 0; n < 6; ++n) {\n    b[i + n] = node[n];\n  }\n\n  return buf ? buf : bytesToUuid(b);\n}\n\nmodule.exports = v1;\n","var rng = require('./lib/rng');\nvar bytesToUuid = require('./lib/bytesToUuid');\n\nfunction v4(options, buf, offset) {\n  var i = buf && offset || 0;\n\n  if (typeof(options) == 'string') {\n    buf = options === 'binary' ? new Array(16) : null;\n    options = null;\n  }\n  options = options || {};\n\n  var rnds = options.random || (options.rng || rng)();\n\n  // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n  rnds[6] = (rnds[6] & 0x0f) | 0x40;\n  rnds[8] = (rnds[8] & 0x3f) | 0x80;\n\n  // Copy bytes to buffer, if provided\n  if (buf) {\n    for (var ii = 0; ii < 16; ++ii) {\n      buf[i + ii] = rnds[ii];\n    }\n  }\n\n  return buf || bytesToUuid(rnds);\n}\n\nmodule.exports = v4;\n","import { ensureInitialized } from '../internal/internalAPIs';\r\nimport { version } from '../internal/constants';\r\nimport { sendMessageToParent } from '../internal/communication';\r\n\r\nexport namespace appInitialization {\r\n  export const Messages = {\r\n    AppLoaded: 'appInitialization.appLoaded',\r\n    Success: 'appInitialization.success',\r\n    Failure: 'appInitialization.failure',\r\n    ExpectedFailure: 'appInitialization.expectedFailure',\r\n  };\r\n\r\n  export enum FailedReason {\r\n    AuthFailed = 'AuthFailed',\r\n    Timeout = 'Timeout',\r\n    Other = 'Other',\r\n  }\r\n\r\n  export enum ExpectedFailureReason {\r\n    PermissionError = 'PermissionError',\r\n    NotFound = 'NotFound',\r\n    Throttling = 'Throttling',\r\n    Offline = 'Offline',\r\n    Other = 'Other',\r\n  }\r\n\r\n  export interface IFailedRequest {\r\n    reason: FailedReason;\r\n    message?: string;\r\n  }\r\n\r\n  export interface IExpectedFailureRequest {\r\n    reason: ExpectedFailureReason;\r\n    message?: string;\r\n  }\r\n\r\n  /**\r\n   * Notifies the frame that app has loaded and to hide the loading indicator if one is shown.\r\n   */\r\n  export function notifyAppLoaded(): void {\r\n    ensureInitialized();\r\n    sendMessageToParent(Messages.AppLoaded, [version]);\r\n  }\r\n\r\n  /**\r\n   * Notifies the frame that app initialization is successful and is ready for user interaction.\r\n   */\r\n  export function notifySuccess(): void {\r\n    ensureInitialized();\r\n    sendMessageToParent(Messages.Success, [version]);\r\n  }\r\n\r\n  /**\r\n   * Notifies the frame that app initialization has failed and to show an error page in its place.\r\n   */\r\n  export function notifyFailure(appInitializationFailedRequest: IFailedRequest): void {\r\n    ensureInitialized();\r\n    sendMessageToParent(Messages.Failure, [\r\n      appInitializationFailedRequest.reason,\r\n      appInitializationFailedRequest.message,\r\n    ]);\r\n  }\r\n\r\n  /**\r\n   * Notifies the frame that app initialized with some expected errors.\r\n   */\r\n  export function notifyExpectedFailure(expectedFailureRequest: IExpectedFailureRequest): void {\r\n    ensureInitialized();\r\n    sendMessageToParent(Messages.ExpectedFailure, [expectedFailureRequest.reason, expectedFailureRequest.message]);\r\n  }\r\n}\r\n","import { ensureInitialized, processAdditionalValidOrigins } from '../internal/internalAPIs';\r\nimport { GlobalVars } from '../internal/globalVars';\r\nimport { defaultSDKVersionForCompatCheck } from '../internal/constants';\r\nimport { settings } from './settings';\r\nimport {\r\n  TabInformation,\r\n  TabInstanceParameters,\r\n  DeepLinkParameters,\r\n  Context,\r\n  LoadContext,\r\n  FrameContext,\r\n} from './interfaces';\r\nimport { getGenericOnCompleteHandler } from '../internal/utils';\r\nimport { logs } from '../private/logs';\r\nimport { FrameContexts } from './constants';\r\nimport {\r\n  Communication,\r\n  initializeCommunication,\r\n  sendMessageToParent,\r\n  uninitializeCommunication,\r\n} from '../internal/communication';\r\nimport { authentication } from './authentication';\r\nimport { initializePrivateApis } from '../private/privateAPIs';\r\nimport * as Handlers from '../internal/handlers'; // Conflict with some names\r\n\r\n// ::::::::::::::::::::::: MicrosoftTeams SDK public API ::::::::::::::::::::\r\n/**\r\n * Initializes the library. This must be called before any other SDK calls\r\n * but after the frame is loaded successfully.\r\n * @param callback Optionally specify a callback to invoke when Teams SDK has successfully initialized\r\n * @param validMessageOrigins Optionally specify a list of cross frame message origins. There must have\r\n * https: protocol otherwise they will be ignored. Example: https://www.example.com\r\n */\r\nexport function initialize(callback?: () => void, validMessageOrigins?: string[]): void {\r\n  // Independent components might not know whether the SDK is initialized so might call it to be safe.\r\n  // Just no-op if that happens to make it easier to use.\r\n  if (!GlobalVars.initializeCalled) {\r\n    GlobalVars.initializeCalled = true;\r\n\r\n    Handlers.initializeHandlers();\r\n    initializeCommunication(\r\n      (\r\n        context: FrameContexts,\r\n        clientType: string,\r\n        clientSupportedSDKVersion: string = defaultSDKVersionForCompatCheck,\r\n      ) => {\r\n        GlobalVars.frameContext = context;\r\n        GlobalVars.hostClientType = clientType;\r\n        GlobalVars.clientSupportedSDKVersion = clientSupportedSDKVersion;\r\n\r\n        // Notify all waiting callers that the initialization has completed\r\n        GlobalVars.initializeCallbacks.forEach(initCallback => initCallback());\r\n        GlobalVars.initializeCallbacks = [];\r\n        GlobalVars.initializeCompleted = true;\r\n      },\r\n      validMessageOrigins,\r\n    );\r\n\r\n    authentication.initialize();\r\n    settings.initialize();\r\n    initializePrivateApis();\r\n\r\n    // Undocumented function used to clear state between unit tests\r\n    this._uninitialize = () => {\r\n      if (GlobalVars.frameContext) {\r\n        registerOnThemeChangeHandler(null);\r\n        registerFullScreenHandler(null);\r\n        registerBackButtonHandler(null);\r\n        registerBeforeUnloadHandler(null);\r\n        registerFocusEnterHandler(null);\r\n        registerOnLoadHandler(null);\r\n        logs.registerGetLogHandler(null);\r\n      }\r\n\r\n      if (GlobalVars.frameContext === FrameContexts.settings) {\r\n        settings.registerOnSaveHandler(null);\r\n      }\r\n\r\n      if (GlobalVars.frameContext === FrameContexts.remove) {\r\n        settings.registerOnRemoveHandler(null);\r\n      }\r\n\r\n      GlobalVars.initializeCalled = false;\r\n      GlobalVars.initializeCompleted = false;\r\n      GlobalVars.initializeCallbacks = [];\r\n      GlobalVars.additionalValidOrigins = [];\r\n      GlobalVars.frameContext = null;\r\n      GlobalVars.hostClientType = null;\r\n      GlobalVars.isFramelessWindow = false;\r\n\r\n      uninitializeCommunication();\r\n    };\r\n  }\r\n\r\n  // Handle additional valid message origins if specified\r\n  if (Array.isArray(validMessageOrigins)) {\r\n    processAdditionalValidOrigins(validMessageOrigins);\r\n  }\r\n\r\n  // Handle the callback if specified:\r\n  // 1. If initialization has already completed then just call it right away\r\n  // 2. If initialization hasn't completed then add it to the array of callbacks\r\n  //    that should be invoked once initialization does complete\r\n  if (callback) {\r\n    GlobalVars.initializeCompleted ? callback() : GlobalVars.initializeCallbacks.push(callback);\r\n  }\r\n}\r\n\r\n/**\r\n * @private\r\n * Hide from docs.\r\n * ------\r\n * Undocumented function used to set a mock window for unit tests\r\n */\r\nexport function _initialize(hostWindow: any): void {\r\n  Communication.currentWindow = hostWindow;\r\n}\r\n\r\n/**\r\n * @private\r\n * Hide from docs.\r\n * ------\r\n * Undocumented function used to clear state between unit tests\r\n */\r\nexport function _uninitialize(): void {}\r\n\r\n/**\r\n * Enable print capability to support printing page using Ctrl+P and cmd+P\r\n */\r\nexport function enablePrintCapability(): void {\r\n  if (!GlobalVars.printCapabilityEnabled) {\r\n    GlobalVars.printCapabilityEnabled = true;\r\n    ensureInitialized();\r\n    // adding ctrl+P and cmd+P handler\r\n    document.addEventListener('keydown', (event: KeyboardEvent) => {\r\n      if ((event.ctrlKey || event.metaKey) && event.keyCode === 80) {\r\n        print();\r\n        event.cancelBubble = true;\r\n        event.preventDefault();\r\n        event.stopImmediatePropagation();\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\n/**\r\n * default print handler\r\n */\r\nexport function print(): void {\r\n  window.print();\r\n}\r\n\r\n/**\r\n * Retrieves the current context the frame is running in.\r\n * @param callback The callback to invoke when the {@link Context} object is retrieved.\r\n */\r\nexport function getContext(callback: (context: Context) => void): void {\r\n  ensureInitialized();\r\n\r\n  sendMessageToParent('getContext', (context: Context) => {\r\n    if (!context.frameContext) {\r\n      // Fallback logic for frameContext properties\r\n      context.frameContext = GlobalVars.frameContext;\r\n    }\r\n    callback(context);\r\n  });\r\n}\r\n\r\n/**\r\n * Registers a handler for theme changes.\r\n * Only one handler can be registered at a time. A subsequent registration replaces an existing registration.\r\n * @param handler The handler to invoke when the user changes their theme.\r\n */\r\nexport function registerOnThemeChangeHandler(handler: (theme: string) => void): void {\r\n  ensureInitialized();\r\n  Handlers.registerOnThemeChangeHandler(handler);\r\n}\r\n\r\n/**\r\n * Registers a handler for changes from or to full-screen view for a tab.\r\n * Only one handler can be registered at a time. A subsequent registration replaces an existing registration.\r\n * @param handler The handler to invoke when the user toggles full-screen view for a tab.\r\n */\r\nexport function registerFullScreenHandler(handler: (isFullScreen: boolean) => void): void {\r\n  ensureInitialized();\r\n  Handlers.registerHandler('fullScreenChange', handler);\r\n}\r\n\r\n/**\r\n * Registers a handler for clicking the app button.\r\n * Only one handler can be registered at a time. A subsequent registration replaces an existing registration.\r\n * @param handler The handler to invoke when the personal app button is clicked in the app bar.\r\n */\r\nexport function registerAppButtonClickHandler(handler: () => void): void {\r\n  ensureInitialized(FrameContexts.content);\r\n  Handlers.registerHandler('appButtonClick', handler);\r\n}\r\n\r\n/**\r\n * Registers a handler for entering hover of the app button.\r\n * Only one handler can be registered at a time. A subsequent registration replaces an existing registration.\r\n * @param handler The handler to invoke when entering hover of the personal app button in the app bar.\r\n */\r\nexport function registerAppButtonHoverEnterHandler(handler: () => void): void {\r\n  ensureInitialized(FrameContexts.content);\r\n  Handlers.registerHandler('appButtonHoverEnter', handler);\r\n}\r\n\r\n/**\r\n * Registers a handler for exiting hover of the app button.\r\n * Only one handler can be registered at a time. A subsequent registration replaces an existing registration.\r\n * @param handler The handler to invoke when exiting hover of the personal app button in the app bar.\r\n */\r\nexport function registerAppButtonHoverLeaveHandler(handler: () => void): void {\r\n  ensureInitialized(FrameContexts.content);\r\n  Handlers.registerHandler('appButtonHoverLeave', handler);\r\n}\r\n\r\n/**\r\n * Registers a handler for user presses of the Team client's back button. Experiences that maintain an internal\r\n * navigation stack should use this handler to navigate the user back within their frame. If an app finds\r\n * that after running its back button handler it cannot handle the event it should call the navigateBack\r\n * method to ask the Teams client to handle it instead.\r\n * @param handler The handler to invoke when the user presses their Team client's back button.\r\n */\r\nexport function registerBackButtonHandler(handler: () => boolean): void {\r\n  ensureInitialized();\r\n  Handlers.registerBackButtonHandler(handler);\r\n}\r\n\r\n/**\r\n * @private\r\n * Registers a handler to be called when the page has been requested to load.\r\n * @param handler The handler to invoke when the page is loaded.\r\n */\r\nexport function registerOnLoadHandler(handler: (context: LoadContext) => void): void {\r\n  ensureInitialized();\r\n  Handlers.registerOnLoadHandler(handler);\r\n}\r\n\r\n/**\r\n * @private\r\n * Registers a handler to be called before the page is unloaded.\r\n * @param handler The handler to invoke before the page is unloaded. If this handler returns true the page should\r\n * invoke the readyToUnload function provided to it once it's ready to be unloaded.\r\n */\r\nexport function registerBeforeUnloadHandler(handler: (readyToUnload: () => void) => boolean): void {\r\n  ensureInitialized();\r\n  Handlers.registerBeforeUnloadHandler(handler);\r\n}\r\n\r\n/**\r\n * @private\r\n * Registers a handler when focus needs to be passed from teams to the place of choice on app.\r\n * @param handler The handler to invoked by the app when they want the focus to be in the place of their choice.\r\n */\r\nexport function registerFocusEnterHandler(handler: (navigateForward: boolean) => void): void {\r\n  ensureInitialized();\r\n  Handlers.registerFocusEnterHandler(handler);\r\n}\r\n\r\n/**\r\n * Registers a handler for when the user reconfigurated tab\r\n * @param handler The handler to invoke when the user click on Settings.\r\n */\r\nexport function registerEnterSettingsHandler(handler: () => void): void {\r\n  ensureInitialized(FrameContexts.content);\r\n  Handlers.registerHandler('changeSettings', handler);\r\n}\r\n\r\n/**\r\n * Allows an app to retrieve for this user tabs that are owned by this app.\r\n * If no TabInstanceParameters are passed, the app defaults to favorite teams and favorite channels.\r\n * @param callback The callback to invoke when the {@link TabInstanceParameters} object is retrieved.\r\n * @param tabInstanceParameters OPTIONAL Flags that specify whether to scope call to favorite teams or channels.\r\n */\r\nexport function getTabInstances(\r\n  callback: (tabInfo: TabInformation) => void,\r\n  tabInstanceParameters?: TabInstanceParameters,\r\n): void {\r\n  ensureInitialized();\r\n\r\n  sendMessageToParent('getTabInstances', [tabInstanceParameters], callback);\r\n}\r\n\r\n/**\r\n * Allows an app to retrieve the most recently used tabs for this user.\r\n * @param callback The callback to invoke when the {@link TabInformation} object is retrieved.\r\n * @param tabInstanceParameters OPTIONAL Ignored, kept for future use\r\n */\r\nexport function getMruTabInstances(\r\n  callback: (tabInfo: TabInformation) => void,\r\n  tabInstanceParameters?: TabInstanceParameters,\r\n): void {\r\n  ensureInitialized();\r\n\r\n  sendMessageToParent('getMruTabInstances', [tabInstanceParameters], callback);\r\n}\r\n\r\n/**\r\n * Shares a deep link that a user can use to navigate back to a specific state in this page.\r\n * @param deepLinkParameters ID and label for the link and fallback URL.\r\n */\r\nexport function shareDeepLink(deepLinkParameters: DeepLinkParameters): void {\r\n  ensureInitialized(FrameContexts.content, FrameContexts.sidePanel, FrameContexts.meetingStage);\r\n\r\n  sendMessageToParent('shareDeepLink', [\r\n    deepLinkParameters.subEntityId,\r\n    deepLinkParameters.subEntityLabel,\r\n    deepLinkParameters.subEntityWebUrl,\r\n  ]);\r\n}\r\n\r\n/**\r\n * execute deep link API.\r\n * @param deepLink deep link.\r\n */\r\nexport function executeDeepLink(deepLink: string, onComplete?: (status: boolean, reason?: string) => void): void {\r\n  ensureInitialized(\r\n    FrameContexts.content,\r\n    FrameContexts.sidePanel,\r\n    FrameContexts.settings,\r\n    FrameContexts.task,\r\n    FrameContexts.stage,\r\n    FrameContexts.meetingStage,\r\n  );\r\n  sendMessageToParent('executeDeepLink', [deepLink], onComplete ? onComplete : getGenericOnCompleteHandler());\r\n}\r\n\r\nexport function setFrameContext(frameContext: FrameContext): void {\r\n  ensureInitialized(FrameContexts.content);\r\n  sendMessageToParent('setFrameContext', [frameContext]);\r\n}\r\n\r\nexport function initializeWithFrameContext(\r\n  frameContext: FrameContext,\r\n  callback?: () => void,\r\n  validMessageOrigins?: string[],\r\n): void {\r\n  initialize(callback, validMessageOrigins);\r\n  setFrameContext(frameContext);\r\n}\r\n","import { ensureInitialized } from '../internal/internalAPIs';\r\nimport { getGenericOnCompleteHandler } from '../internal/utils';\r\nimport { TabInstance } from './interfaces';\r\nimport { FrameContexts } from './constants';\r\nimport { sendMessageToParent } from '../internal/communication';\r\n\r\n/**\r\n * Navigation specific part of the SDK.\r\n */\r\n\r\n/**\r\n * Return focus to the main Teams app. Will focus search bar if navigating foward and app bar if navigating back.\r\n * @param navigateForward Determines the direction to focus in teams app.\r\n */\r\nexport function returnFocus(navigateForward?: boolean): void {\r\n  ensureInitialized(FrameContexts.content);\r\n\r\n  sendMessageToParent('returnFocus', [navigateForward]);\r\n}\r\n\r\n/**\r\n * Navigates the Microsoft Teams app to the specified tab instance.\r\n * @param tabInstance The tab instance to navigate to.\r\n */\r\nexport function navigateToTab(tabInstance: TabInstance, onComplete?: (status: boolean, reason?: string) => void): void {\r\n  ensureInitialized();\r\n\r\n  const errorMessage = 'Invalid internalTabInstanceId and/or channelId were/was provided';\r\n  sendMessageToParent(\r\n    'navigateToTab',\r\n    [tabInstance],\r\n    onComplete ? onComplete : getGenericOnCompleteHandler(errorMessage),\r\n  );\r\n}\r\n\r\n/**\r\n * Navigates the frame to a new cross-domain URL. The domain of this URL must match at least one of the\r\n * valid domains specified in the validDomains block of the manifest; otherwise, an exception will be\r\n * thrown. This function needs to be used only when navigating the frame to a URL in a different domain\r\n * than the current one in a way that keeps the app informed of the change and allows the SDK to\r\n * continue working.\r\n * @param url The URL to navigate the frame to.\r\n */\r\nexport function navigateCrossDomain(url: string, onComplete?: (status: boolean, reason?: string) => void): void {\r\n  ensureInitialized(\r\n    FrameContexts.content,\r\n    FrameContexts.sidePanel,\r\n    FrameContexts.settings,\r\n    FrameContexts.remove,\r\n    FrameContexts.task,\r\n    FrameContexts.stage,\r\n    FrameContexts.meetingStage,\r\n  );\r\n\r\n  const errorMessage =\r\n    'Cross-origin navigation is only supported for URLs matching the pattern registered in the manifest.';\r\n  sendMessageToParent(\r\n    'navigateCrossDomain',\r\n    [url],\r\n    onComplete ? onComplete : getGenericOnCompleteHandler(errorMessage),\r\n  );\r\n}\r\n\r\n/**\r\n * Navigates back in the Teams client. See registerBackButtonHandler for more information on when\r\n * it's appropriate to use this method.\r\n */\r\nexport function navigateBack(onComplete?: (status: boolean, reason?: string) => void): void {\r\n  ensureInitialized();\r\n\r\n  const errorMessage = 'Back navigation is not supported in the current client or context.';\r\n  sendMessageToParent('navigateBack', [], onComplete ? onComplete : getGenericOnCompleteHandler(errorMessage));\r\n}\r\n","import { TaskInfo } from './interfaces';\r\nimport { FrameContexts } from './constants';\r\nimport { IAppWindow, ChildAppWindow } from './appWindow';\r\nimport { sendMessageToParent } from '../internal/communication';\r\nimport { ensureInitialized } from '../internal/internalAPIs';\r\n\r\n/**\r\n * Namespace to interact with the task module-specific part of the SDK.\r\n * This object is usable only on the content frame.\r\n */\r\nexport namespace tasks {\r\n  /**\r\n   * Allows an app to open the task module.\r\n   * @param taskInfo An object containing the parameters of the task module\r\n   * @param submitHandler Handler to call when the task module is completed\r\n   */\r\n  export function startTask(taskInfo: TaskInfo, submitHandler?: (err: string, result: string) => void): IAppWindow {\r\n    ensureInitialized(FrameContexts.content, FrameContexts.sidePanel, FrameContexts.meetingStage);\r\n\r\n    sendMessageToParent('tasks.startTask', [taskInfo], submitHandler);\r\n    return new ChildAppWindow();\r\n  }\r\n\r\n  /**\r\n   * Update height/width task info properties.\r\n   * @param taskInfo An object containing width and height properties\r\n   */\r\n  export function updateTask(taskInfo: TaskInfo): void {\r\n    ensureInitialized(FrameContexts.content, FrameContexts.sidePanel, FrameContexts.task, FrameContexts.meetingStage);\r\n    const { width, height, ...extra } = taskInfo;\r\n\r\n    if (!Object.keys(extra).length) {\r\n      sendMessageToParent('tasks.updateTask', [taskInfo]);\r\n    } else {\r\n      throw new Error('updateTask requires a taskInfo argument containing only width and height');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Submit the task module.\r\n   * @param result Contains the result to be sent to the bot or the app. Typically a JSON object or a serialized version of it\r\n   * @param appIds Helps to validate that the call originates from the same appId as the one that invoked the task module\r\n   */\r\n  export function submitTask(result?: string | object, appIds?: string | string[]): void {\r\n    ensureInitialized(FrameContexts.content, FrameContexts.sidePanel, FrameContexts.task, FrameContexts.meetingStage);\r\n\r\n    // Send tasks.completeTask instead of tasks.submitTask message for backward compatibility with Mobile clients\r\n    sendMessageToParent('tasks.completeTask', [result, Array.isArray(appIds) ? appIds : [appIds]]);\r\n  }\r\n}\r\n","import { SdkError, ErrorCode } from './interfaces';\r\nimport { ensureInitialized, isAPISupportedByPlatform } from '../internal/internalAPIs';\r\nimport { FrameContexts } from './constants';\r\nimport { sendMessageToParent } from '../internal/communication';\r\nimport { locationAPIsRequiredVersion } from '../internal/constants';\r\n\r\nexport namespace location {\r\n  export interface LocationProps {\r\n    /**\r\n    whether user can alter location or not\r\n    if false, user will be shown current location \r\n    and wouldn't be allowed to alter it\r\n    */\r\n    allowChooseLocation: boolean;\r\n    /**\r\n    whether selected location should be shown to user on map or not.\r\n    If allowChooseLocation is true, this parameter will be ignored by platform.\r\n    If allowChooseLocation is false, and this paramater is not provided, default \r\n    value will be false.\r\n    */\r\n    showMap?: boolean;\r\n  }\r\n\r\n  export interface Location {\r\n    /**\r\n    Latitude of the location\r\n    */\r\n    latitude: number;\r\n    /**\r\n    Longitude of the location\r\n    */\r\n    longitude: number;\r\n    /**\r\n    Accuracy of the coordinates captured\r\n    */\r\n    accuracy?: number;\r\n    /**\r\n    Time stamp when the location was captured\r\n    */\r\n    timestamp?: number;\r\n  }\r\n\r\n  /**\r\n   * Fetches current user coordinates or allows user to choose location on map\r\n   * @param callback Callback to invoke when current user location is fetched\r\n   */\r\n  export function getLocation(props: LocationProps, callback: (error: SdkError, location: Location) => void): void {\r\n    if (!callback) {\r\n      throw new Error('[location.getLocation] Callback cannot be null');\r\n    }\r\n    ensureInitialized(FrameContexts.content, FrameContexts.task);\r\n\r\n    if (!isAPISupportedByPlatform(locationAPIsRequiredVersion)) {\r\n      const oldPlatformError: SdkError = { errorCode: ErrorCode.OLD_PLATFORM };\r\n      callback(oldPlatformError, undefined);\r\n      return;\r\n    }\r\n    if (!props) {\r\n      const invalidInput: SdkError = { errorCode: ErrorCode.INVALID_ARGUMENTS };\r\n      callback(invalidInput, undefined);\r\n      return;\r\n    }\r\n    sendMessageToParent('location.getLocation', [props], callback);\r\n  }\r\n\r\n  /**\r\n   * Shows the location on map corresponding to the given coordinates\r\n   * @param location {@link Location} which needs to be shown on map\r\n   * @param callback Callback to invoke when the location is opened on map\r\n   */\r\n  export function showLocation(location: Location, callback: (error: SdkError, status: boolean) => void): void {\r\n    if (!callback) {\r\n      throw new Error('[location.showLocation] Callback cannot be null');\r\n    }\r\n    ensureInitialized(FrameContexts.content, FrameContexts.task);\r\n\r\n    if (!isAPISupportedByPlatform(locationAPIsRequiredVersion)) {\r\n      const oldPlatformError: SdkError = { errorCode: ErrorCode.OLD_PLATFORM };\r\n      callback(oldPlatformError, undefined);\r\n      return;\r\n    }\r\n    if (!location) {\r\n      const invalidInput: SdkError = { errorCode: ErrorCode.INVALID_ARGUMENTS };\r\n      callback(invalidInput, undefined);\r\n      return;\r\n    }\r\n    sendMessageToParent('location.showLocation', [location], callback);\r\n  }\r\n}\r\n","import { sendMessageToParent } from '../internal/communication';\r\nimport { registerHandler } from '../internal/handlers';\r\nimport { ensureInitialized } from '../internal/internalAPIs';\r\nimport { SdkError } from './interfaces';\r\nimport { FrameContexts } from './constants';\r\n\r\nexport namespace meeting {\r\n  /**\r\n   * @private\r\n   * Hide from docs\r\n   * Data structure to represent a meeting details.\r\n   */\r\n  export interface IMeetingDetails {\r\n    /**\r\n     * details object\r\n     */\r\n    details: IDetails;\r\n    /**\r\n     * conversation object\r\n     */\r\n    conversation: IConversation;\r\n    /**\r\n     * organizer object\r\n     */\r\n    organizer: IOrganizer;\r\n  }\r\n  /**\r\n   * @private\r\n   * Hide from docs\r\n   * Data structure to represent details.\r\n   */\r\n  export interface IDetails {\r\n    /**\r\n     * Scheduled start time of the meeting\r\n     */\r\n    scheduledStartTime: string;\r\n    /**\r\n     * Scheduled end time of the meeting\r\n     */\r\n    scheduledEndTime: string;\r\n    /**\r\n     * url to join the current meeting\r\n     */\r\n    joinUrl?: string;\r\n    /**\r\n     * meeting title name of the meeting\r\n     */\r\n    title?: string;\r\n    /**\r\n     * type of the meeting\r\n     */\r\n    type?: MeetingType;\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * Hide from docs\r\n   * Data structure to represent a conversation object.\r\n   */\r\n  export interface IConversation {\r\n    /**\r\n     * conversation id of the meeting\r\n     */\r\n    id: string;\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * Hide from docs\r\n   * Data structure to represent an organizer object.\r\n   */\r\n  export interface IOrganizer {\r\n    /**\r\n     * organizer id of the meeting\r\n     */\r\n    id?: string;\r\n    /**\r\n     * tenant id of the meeting\r\n     */\r\n    tenantId?: string;\r\n  }\r\n\r\n  export interface LiveStreamState {\r\n    /**\r\n     * indicates whether meeting is streaming\r\n     */\r\n    isStreaming: boolean;\r\n\r\n    /**\r\n     * error object in case there is a failure\r\n     */\r\n    error?: {\r\n      /** error code from the streaming service, e.g. IngestionFailure */\r\n      code: string;\r\n      /** detailed error message string */\r\n      message?: string;\r\n    };\r\n  }\r\n\r\n  export enum MeetingType {\r\n    Unknown = 'Unknown',\r\n    Adhoc = 'Adhoc',\r\n    Scheduled = 'Scheduled',\r\n    Recurring = 'Recurring',\r\n    Broadcast = 'Broadcast',\r\n    MeetNow = 'MeetNow',\r\n  }\r\n\r\n  /**\r\n   * Allows an app to get the incoming audio speaker setting for the meeting user\r\n   * @param callback Callback contains 2 parameters, error and result.\r\n   * error can either contain an error of type SdkError, incase of an error, or null when fetch is successful\r\n   * result can either contain the true/false value, incase of a successful fetch or null when the fetching fails\r\n   * result: True means incoming audio is muted and false means incoming audio is unmuted\r\n   */\r\n  export function getIncomingClientAudioState(\r\n    callback: (error: SdkError | null, result: boolean | null) => void,\r\n  ): void {\r\n    if (!callback) {\r\n      throw new Error('[get incoming client audio state] Callback cannot be null');\r\n    }\r\n    ensureInitialized(FrameContexts.sidePanel, FrameContexts.meetingStage);\r\n    sendMessageToParent('getIncomingClientAudioState', callback);\r\n  }\r\n\r\n  /**\r\n   * Allows an app to toggle the incoming audio speaker setting for the meeting user from mute to unmute or vice-versa\r\n   * @param callback Callback contains 2 parameters, error and result.\r\n   * error can either contain an error of type SdkError, incase of an error, or null when toggle is successful\r\n   * result can either contain the true/false value, incase of a successful toggle or null when the toggling fails\r\n   * result: True means incoming audio is muted and false means incoming audio is unmuted\r\n   */\r\n  export function toggleIncomingClientAudio(callback: (error: SdkError | null, result: boolean | null) => void): void {\r\n    if (!callback) {\r\n      throw new Error('[toggle incoming client audio] Callback cannot be null');\r\n    }\r\n    ensureInitialized(FrameContexts.sidePanel, FrameContexts.meetingStage);\r\n    sendMessageToParent('toggleIncomingClientAudio', callback);\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * Hide from docs\r\n   * Allows an app to get the meeting details for the meeting\r\n   * @param callback Callback contains 2 parameters, error and meetingDetails.\r\n   * error can either contain an error of type SdkError, incase of an error, or null when get is successful\r\n   * result can either contain a IMeetingDetails value, incase of a successful get or null when the get fails\r\n   */\r\n  export function getMeetingDetails(\r\n    callback: (error: SdkError | null, meetingDetails: IMeetingDetails | null) => void,\r\n  ): void {\r\n    if (!callback) {\r\n      throw new Error('[get meeting details] Callback cannot be null');\r\n    }\r\n    ensureInitialized(\r\n      FrameContexts.sidePanel,\r\n      FrameContexts.meetingStage,\r\n      FrameContexts.settings,\r\n      FrameContexts.content,\r\n    );\r\n    sendMessageToParent('meeting.getMeetingDetails', callback);\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * Allows an app to get the authentication token for the anonymous or guest user in the meeting\r\n   * @param callback Callback contains 2 parameters, error and authenticationTokenOfAnonymousUser.\r\n   * error can either contain an error of type SdkError, incase of an error, or null when get is successful\r\n   * authenticationTokenOfAnonymousUser can either contain a string value, incase of a successful get or null when the get fails\r\n   */\r\n  export function getAuthenticationTokenForAnonymousUser(\r\n    callback: (error: SdkError | null, authenticationTokenOfAnonymousUser: string | null) => void,\r\n  ): void {\r\n    if (!callback) {\r\n      throw new Error('[get Authentication Token For AnonymousUser] Callback cannot be null');\r\n    }\r\n    ensureInitialized(FrameContexts.sidePanel, FrameContexts.meetingStage);\r\n    sendMessageToParent('meeting.getAuthenticationTokenForAnonymousUser', callback);\r\n  }\r\n\r\n  /**\r\n   * Allows an app to get the state of the live stream in the current meeting\r\n   * @param callback Callback contains 2 parameters: error and liveStreamState.\r\n   * error can either contain an error of type SdkError, in case of an error, or null when get is successful\r\n   * liveStreamState can either contain a LiveStreamState value, or null when operation fails\r\n   */\r\n  export function getLiveStreamState(\r\n    callback: (error: SdkError | null, liveStreamState: LiveStreamState | null) => void,\r\n  ): void {\r\n    if (!callback) {\r\n      throw new Error('[get live stream state] Callback cannot be null');\r\n    }\r\n    ensureInitialized(FrameContexts.sidePanel);\r\n    sendMessageToParent('meeting.getLiveStreamState', callback);\r\n  }\r\n\r\n  /**\r\n   * Allows an app to request the live streaming be started at the given streaming url\r\n   * @param streamUrl the url to the stream resource\r\n   * @param streamKey the key to the stream resource\r\n   * @param callback Callback contains error parameter which can be of type SdkError in case of an error, or null when operation is successful\r\n   * Use getLiveStreamState or registerLiveStreamChangedHandler to get updates on the live stream state\r\n   */\r\n  export function requestStartLiveStreaming(\r\n    callback: (error: SdkError | null) => void,\r\n    streamUrl: string,\r\n    streamKey?: string,\r\n  ): void {\r\n    if (!callback) {\r\n      throw new Error('[request start live streaming] Callback cannot be null');\r\n    }\r\n    ensureInitialized(FrameContexts.sidePanel);\r\n    sendMessageToParent('meeting.requestStartLiveStreaming', [streamUrl, streamKey], callback);\r\n  }\r\n\r\n  /**\r\n   * Allows an app to request the live streaming be stopped at the given streaming url\r\n   * @param callback Callback contains error parameter which can be of type SdkError in case of an error, or null when operation is successful\r\n   * Use getLiveStreamState or registerLiveStreamChangedHandler to get updates on the live stream state\r\n   */\r\n  export function requestStopLiveStreaming(callback: (error: SdkError | null) => void): void {\r\n    if (!callback) {\r\n      throw new Error('[request stop live streaming] Callback cannot be null');\r\n    }\r\n    ensureInitialized(FrameContexts.sidePanel);\r\n    sendMessageToParent('meeting.requestStopLiveStreaming', callback);\r\n  }\r\n\r\n  /**\r\n   * Registers a handler for changes to the live stream.\r\n   * Only one handler can be registered at a time. A subsequent registration replaces an existing registration.\r\n   * @param handler The handler to invoke when the live stream state changes\r\n   */\r\n  export function registerLiveStreamChangedHandler(handler: (liveStreamState: LiveStreamState) => void): void {\r\n    if (!handler) {\r\n      throw new Error('[register live stream changed handler] Handler cannot be null');\r\n    }\r\n    ensureInitialized(FrameContexts.sidePanel);\r\n    registerHandler('meeting.liveStreamChanged', handler);\r\n  }\r\n\r\n  /**\r\n   * Allows an app to share contents in the meeting\r\n   * @param callback Callback contains 2 parameters, error and result.\r\n   * error can either contain an error of type SdkError, incase of an error, or null when share is successful\r\n   * result can either contain a true value, incase of a successful share or null when the share fails\r\n   * @param appContentUrl is the input URL which needs to be shared on to the stage\r\n   */\r\n  export function shareAppContentToStage(\r\n    callback: (error: SdkError | null, result: boolean | null) => void,\r\n    appContentUrl: string,\r\n  ): void {\r\n    if (!callback) {\r\n      throw new Error('[share app content to stage] Callback cannot be null');\r\n    }\r\n    ensureInitialized(FrameContexts.sidePanel);\r\n    sendMessageToParent('meeting.shareAppContentToStage', [appContentUrl], callback);\r\n  }\r\n}\r\n","import { sendMessageToParent } from '../internal/communication';\r\nimport { ensureInitialized } from '../internal/internalAPIs';\r\nimport { SdkError } from './interfaces';\r\nimport { FrameContexts } from './constants';\r\n\r\nexport namespace monetization {\r\n  /**\r\n   * @private\r\n   * Hide from docs\r\n   * Data structure to represent a subscription plan.\r\n   */\r\n  export interface PlanInfo {\r\n    /**\r\n     * plan id\r\n     */\r\n    planId: string;\r\n    /**\r\n     * term of the plan\r\n     */\r\n    term: string;\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * Hide from docs\r\n   * Open dialog to start user's purchase experience\r\n   * @param callback Callback contains 1 parameters, error.\r\n   * @param planInfo optional parameter. It contains info of the subscription plan pushed to users.\r\n   * error can either contain an error of type SdkError, incase of an error, or null when get is successful\r\n   */\r\n  export function openPurchaseExperience(callback: (error: SdkError | null) => void, planInfo?: PlanInfo): void {\r\n    if (!callback) {\r\n      throw new Error('[open purchase experience] Callback cannot be null');\r\n    }\r\n    ensureInitialized(FrameContexts.content);\r\n    sendMessageToParent('monetization.openPurchaseExperience', [planInfo], callback);\r\n  }\r\n}\r\n","import { ensureInitialized, isAPISupportedByPlatform } from '../internal/internalAPIs';\r\nimport { FrameContexts } from './constants';\r\nimport { ErrorCode, SdkError } from './interfaces';\r\nimport { validatePeoplePickerInput } from '../internal/mediaUtil';\r\nimport { sendMessageToParent } from '../internal/communication';\r\nimport { peoplePickerRequiredVersion } from '../internal/constants';\r\n\r\nexport namespace people {\r\n  /**\r\n   * Launches a people picker and allows the user to select one or more people from the list\r\n   * If the app is added to personal app scope the people picker launched is org wide and if the app is added to a chat/channel, people picker launched is also limited to the members of chat/channel\r\n   * @param callback Returns list of JSON object of type PeoplePickerResult which consists of AAD IDs, display names and emails of the selected users\r\n   * @param peoplePickerInputs Input parameters to launch customized people picker\r\n   */\r\n  export function selectPeople(\r\n    callback: (error: SdkError, people: PeoplePickerResult[]) => void,\r\n    peoplePickerInputs?: PeoplePickerInputs,\r\n  ): void {\r\n    if (!callback) {\r\n      throw new Error('[people picker] Callback cannot be null');\r\n    }\r\n    ensureInitialized(FrameContexts.content, FrameContexts.task, FrameContexts.settings);\r\n\r\n    if (!isAPISupportedByPlatform(peoplePickerRequiredVersion)) {\r\n      const oldPlatformError: SdkError = { errorCode: ErrorCode.OLD_PLATFORM };\r\n      callback(oldPlatformError, undefined);\r\n      return;\r\n    }\r\n\r\n    if (!validatePeoplePickerInput(peoplePickerInputs)) {\r\n      const invalidInput: SdkError = { errorCode: ErrorCode.INVALID_ARGUMENTS };\r\n      callback(invalidInput, null);\r\n      return;\r\n    }\r\n\r\n    sendMessageToParent('people.selectPeople', [peoplePickerInputs], callback);\r\n  }\r\n\r\n  /**\r\n   * Input parameter supplied to the People Picker API\r\n   */\r\n  export interface PeoplePickerInputs {\r\n    /**\r\n     * Optional; Set title for the people picker\r\n     * Default value is \"Select people\" for multiselect and \"Select a person\" for single select\r\n     */\r\n    title?: string;\r\n\r\n    /**\r\n     * Optional; AAD ids of the users to be pre-populated in the search box of people picker control\r\n     * If single select is enabled this value, only the first user in the list will be pre-populated\r\n     * Default value is null\r\n     */\r\n    setSelected?: string[];\r\n\r\n    /**\r\n     * Optional; launches the people picker in org wide scope even if the app is added to a chat or channel\r\n     * Default value is false\r\n     */\r\n    openOrgWideSearchInChatOrChannel?: boolean;\r\n\r\n    /**\r\n     * Optional; launches the people picker for which only 1 person can be selected\r\n     * Default value is false\r\n     */\r\n    singleSelect?: boolean;\r\n  }\r\n\r\n  /**\r\n   * Output user object of people picker API\r\n   */\r\n  export interface PeoplePickerResult {\r\n    /**\r\n     * user object Id (also known as aad id) of the selected user\r\n     */\r\n    objectId: string;\r\n\r\n    /**\r\n     * Optional; display name of the selected user\r\n     */\r\n    displayName?: string;\r\n\r\n    /**\r\n     * Optional; email of the selected user\r\n     */\r\n    email?: string;\r\n  }\r\n}\r\n","import { sendMessageToParent } from '../internal/communication';\r\nimport { ensureInitialized } from '../internal/internalAPIs';\r\nimport { FrameContexts } from './constants';\r\nimport { registerHandler } from '../internal/handlers';\r\n/**\r\n * Namespace to video extensibility of the SDK.\r\n *\r\n */\r\nexport namespace video {\r\n  /**\r\n   * Represents a video frame.\r\n   */\r\n  export interface VideoFrame {\r\n    /**\r\n     * Video frame width.\r\n     */\r\n    width: number;\r\n    /**\r\n     * Video frame height.\r\n     */\r\n    height: number;\r\n    /**\r\n     * Video frame buffer\r\n     */\r\n    data: Uint8ClampedArray;\r\n    /**\r\n     * NV12 luma stride, valid only when video frame format is NV12\r\n     */\r\n    lumaStride?: number;\r\n    /**\r\n     * NV12 chroma stride, valid only when video frame format is NV12\r\n     */\r\n    chromaStride?: number;\r\n    /**\r\n     * RGB stride, valid only when video frame format is RGB\r\n     */\r\n    stride?: number;\r\n  }\r\n  /**\r\n   * Video frame format enum, currentlyl only support NV12\r\n   */\r\n  export enum VideoFrameFormat {\r\n    NV12,\r\n  }\r\n  /**\r\n   * Video frame configuration supplied to Teams to customize the generated video frame parameters, like format.\r\n   */\r\n  export interface VideoFrameConfig {\r\n    /**\r\n     * video format\r\n     */\r\n    format: VideoFrameFormat;\r\n  }\r\n\r\n  /**\r\n   *  Video effect change type enum\r\n   */\r\n  export enum EffectChangeType {\r\n    /**\r\n     * current video effect changed.\r\n     */\r\n    EffectChanged,\r\n    /**\r\n     * disable the video effect\r\n     */\r\n    EffectDisabled,\r\n  }\r\n\r\n  /**\r\n   *  Video frame call back funtion definition\r\n   */\r\n  type VideoFrameCallback = (\r\n    frame: VideoFrame,\r\n    notifyVideoFrameProcessed: () => void,\r\n    notifyError: (errorMessage: string) => void,\r\n  ) => void;\r\n\r\n  /**\r\n   *  Video effect change call back funtion definition\r\n   */\r\n  type VideoEffectCallBack = (effectId: string | undefined) => void;\r\n\r\n  /**\r\n   * register to read the video frames in Permissions section.\r\n   */\r\n  export function registerForVideoFrame(frameCallback: VideoFrameCallback, config: VideoFrameConfig): void {\r\n    ensureInitialized(FrameContexts.sidePanel);\r\n    registerHandler('video.newVideoFrame', (videoFrame: VideoFrame) => {\r\n      if (videoFrame !== undefined) {\r\n        frameCallback(videoFrame, notifyVideoFrameProcessed, notifyError);\r\n      }\r\n    });\r\n    sendMessageToParent('video.registerForVideoFrame', [config]);\r\n  }\r\n\r\n  /**\r\n   * video extension should call this to notify Teams Client current selected effect parameter changed.\r\n   * If it's pre-meeting, Teams client will call videoEffectCallback immediately then use the videoEffect.\r\n   * in-meeting scenario, we will call videoEffectCallback when apply button clicked.\r\n   * @param effectChangeType the effect change type.\r\n   * @param effectId Newly selected effect id.\r\n   */\r\n  export function notifySelectedVideoEffectChanged(\r\n    effectChangeType: EffectChangeType,\r\n    effectId: string | undefined,\r\n  ): void {\r\n    ensureInitialized(FrameContexts.sidePanel);\r\n    sendMessageToParent('video.videoEffectChanged', [effectChangeType, effectId]);\r\n  }\r\n\r\n  /**\r\n   * Register the video effect callback, Teams client uses this to notify the video extension the new video effect will by applied.\r\n   */\r\n  export function registerForVideoEffect(callback: VideoEffectCallBack): void {\r\n    ensureInitialized(FrameContexts.sidePanel);\r\n    registerHandler('video.effectParameterChange', callback);\r\n  }\r\n\r\n  /**\r\n   * sending notification to Teams client finished the video frame processing, now Teams client can render this video frame\r\n   * or pass the video frame to next one in video pipeline.\r\n   */\r\n  function notifyVideoFrameProcessed(): void {\r\n    sendMessageToParent('video.videoFrameProcessed');\r\n  }\r\n\r\n  /**\r\n   * sending error notification to Teams client.\r\n   */\r\n  function notifyError(errorMessage: string): void {\r\n    sendMessageToParent('video.notifyError', [errorMessage]);\r\n  }\r\n} //end of video namespace\r\n","import { ensureInitialized } from '../internal/internalAPIs';\r\nimport { sendMessageToParent } from '../internal/communication';\r\nimport { ErrorCode, SdkError } from './interfaces';\r\nimport { FrameContexts } from './constants';\r\n\r\nexport namespace sharing {\r\n  export const SharingAPIMessages = {\r\n    shareWebContent: 'sharing.shareWebContent',\r\n  };\r\n\r\n  // More types can be added as we expand share capability\r\n  type ContentType = 'URL';\r\n\r\n  interface IBaseSharedContent {\r\n    type: ContentType;\r\n  }\r\n\r\n  // More types can be added as we expand share capability\r\n  export type IShareRequestContentType = IURLContent;\r\n\r\n  export interface IShareRequest<T> {\r\n    content: T[];\r\n  }\r\n\r\n  export interface IURLContent extends IBaseSharedContent {\r\n    type: 'URL';\r\n\r\n    /**\r\n     * Required URL\r\n     */\r\n    url: string;\r\n\r\n    /**\r\n     * Default initial message text\r\n     */\r\n    message?: string;\r\n\r\n    /**\r\n     * Show URL preview, defaults to true\r\n     */\r\n    preview?: boolean;\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * Feature is under development\r\n   *\r\n   * Opens a share dialog for web content\r\n   * @param shareWebContentRequest web content info\r\n   * @param callback optional callback\r\n   */\r\n  export function shareWebContent(\r\n    shareWebContentRequest: IShareRequest<IShareRequestContentType>,\r\n    callback?: (err?: SdkError) => void,\r\n  ): void {\r\n    if (!validateNonEmptyContent(shareWebContentRequest, callback)) {\r\n      return;\r\n    }\r\n\r\n    if (!validateTypeConsistency(shareWebContentRequest, callback)) {\r\n      return;\r\n    }\r\n\r\n    if (!validateContentForSupportedTypes(shareWebContentRequest, callback)) {\r\n      return;\r\n    }\r\n\r\n    ensureInitialized(\r\n      FrameContexts.content,\r\n      FrameContexts.sidePanel,\r\n      FrameContexts.task,\r\n      FrameContexts.stage,\r\n      FrameContexts.meetingStage,\r\n    );\r\n\r\n    sendMessageToParent(SharingAPIMessages.shareWebContent, [shareWebContentRequest], callback);\r\n  }\r\n\r\n  // Error checks\r\n  function validateNonEmptyContent(\r\n    shareRequest: IShareRequest<IShareRequestContentType>,\r\n    callback?: (err?: SdkError) => void,\r\n  ): boolean {\r\n    if (!(shareRequest && shareRequest.content && shareRequest.content.length)) {\r\n      if (callback) {\r\n        callback({\r\n          errorCode: ErrorCode.INVALID_ARGUMENTS,\r\n          message: 'Shared content is missing',\r\n        });\r\n      }\r\n      return false;\r\n    }\r\n    return true;\r\n  }\r\n\r\n  function validateTypeConsistency(\r\n    shareRequest: IShareRequest<IShareRequestContentType>,\r\n    callback?: (err?: SdkError) => void,\r\n  ): boolean {\r\n    if (shareRequest.content.some(item => !item.type)) {\r\n      if (callback) {\r\n        callback({\r\n          errorCode: ErrorCode.INVALID_ARGUMENTS,\r\n          message: 'Shared content type cannot be undefined',\r\n        });\r\n      }\r\n      return false;\r\n    }\r\n\r\n    if (shareRequest.content.some(item => item.type !== shareRequest.content[0].type)) {\r\n      if (callback) {\r\n        callback({\r\n          errorCode: ErrorCode.INVALID_ARGUMENTS,\r\n          message: 'Shared content must be of the same type',\r\n        });\r\n      }\r\n      return false;\r\n    }\r\n    return true;\r\n  }\r\n\r\n  function validateContentForSupportedTypes(\r\n    shareRequest: IShareRequest<IShareRequestContentType>,\r\n    callback?: (err?: SdkError) => void,\r\n  ): boolean {\r\n    if (shareRequest.content[0].type === 'URL') {\r\n      if (shareRequest.content.some(item => !item.url)) {\r\n        if (callback) {\r\n          callback({\r\n            errorCode: ErrorCode.INVALID_ARGUMENTS,\r\n            message: 'URLs are required for URL content types',\r\n          });\r\n        }\r\n        return false;\r\n      }\r\n    } else {\r\n      if (callback) {\r\n        callback({\r\n          errorCode: ErrorCode.INVALID_ARGUMENTS,\r\n          message: 'Content type is unsupported',\r\n        });\r\n      }\r\n      return false;\r\n    }\r\n    return true;\r\n  }\r\n}\r\n","import { FileOpenPreference, TeamInformation } from '../public/interfaces';\r\n/**\r\n * @private\r\n * Hide from docs\r\n * --------\r\n * Information about all members in a chat\r\n */\r\nexport interface ChatMembersInformation {\r\n  members: ThreadMember[];\r\n}\r\n\r\n/**\r\n * @private\r\n * Hide from docs\r\n * --------\r\n * Information about a chat member\r\n */\r\nexport interface ThreadMember {\r\n  /**\r\n   * The member's user principal name in the current tenant.\r\n   */\r\n  upn: string;\r\n}\r\n\r\nexport enum NotificationTypes {\r\n  fileDownloadStart = 'fileDownloadStart',\r\n  fileDownloadComplete = 'fileDownloadComplete',\r\n}\r\n\r\nexport interface ShowNotificationParameters {\r\n  message: string;\r\n  notificationType: NotificationTypes;\r\n}\r\n\r\n/**\r\n * @private\r\n * Hide from docs.\r\n * ------\r\n */\r\nexport enum ViewerActionTypes {\r\n  view = 'view',\r\n  edit = 'edit',\r\n  editNew = 'editNew',\r\n}\r\n\r\n/**\r\n * * @private\r\n * Hide from docs.\r\n * ------\r\n * User setting changes that can be subscribed to,\r\n */\r\nexport enum UserSettingTypes {\r\n  /**\r\n   * Use this key to subscribe to changes in user's file open preference\r\n   */\r\n  fileOpenPreference = 'fileOpenPreference',\r\n  /**\r\n   * Use this key to subscribe to theme changes\r\n   */\r\n  theme = 'theme',\r\n}\r\n\r\n/**\r\n * @private\r\n * Hide from docs.\r\n * ------\r\n */\r\nexport interface FilePreviewParameters {\r\n  /**\r\n   * The developer-defined unique ID for the file.\r\n   */\r\n  entityId: string;\r\n\r\n  /**\r\n   * The display name of the file.\r\n   */\r\n  title: string;\r\n\r\n  /**\r\n   * An optional description of the file.\r\n   */\r\n  description?: string;\r\n\r\n  /**\r\n   * The file extension; e.g. pptx, docx, etc.\r\n   */\r\n  type: string;\r\n\r\n  /**\r\n   * A url to the source of the file, used to open the content in the user's default browser\r\n   */\r\n  objectUrl: string;\r\n\r\n  /**\r\n   * Optional; an alternate self-authenticating url used to preview the file in Mobile clients and offer it for download by the user\r\n   */\r\n  downloadUrl?: string;\r\n\r\n  /**\r\n   * Optional; an alternate url optimized for previewing the file in Teams web and desktop clients\r\n   */\r\n  webPreviewUrl?: string;\r\n\r\n  /**\r\n   * Optional; an alternate url that allows editing of the file in Teams web and desktop clients\r\n   */\r\n  webEditUrl?: string;\r\n\r\n  /**\r\n   * Optional; the base url of the site where the file is hosted\r\n   */\r\n  baseUrl?: string;\r\n\r\n  /**\r\n   * Deprecated; prefer using viewerAction instead\r\n   * Optional; indicates whether the file should be opened in edit mode\r\n   */\r\n  editFile?: boolean;\r\n\r\n  /**\r\n   * Optional; the developer-defined unique ID for the sub-entity to return to when the file stage closes.\r\n   * This field should be used to restore to a specific state within an entity, such as scrolling to or activating a specific piece of content.\r\n   */\r\n  subEntityId?: string;\r\n\r\n  /**\r\n   * Optional; indicates the mode in which file should be opened. Takes precedence over edit mode.\r\n   */\r\n  viewerAction?: ViewerActionTypes;\r\n\r\n  /**\r\n   * Optional; indicates how user prefers to open the file\r\n   */\r\n  fileOpenPreference?: FileOpenPreference;\r\n}\r\n\r\n/**\r\n * @private\r\n * Hide from docs\r\n * --------\r\n * Query parameters used when fetching team information\r\n */\r\nexport interface TeamInstanceParameters {\r\n  /**\r\n   * Flag allowing to select favorite teams only\r\n   */\r\n  favoriteTeamsOnly?: boolean;\r\n}\r\n\r\n/**\r\n * @private\r\n * Hide from docs\r\n * --------\r\n * Information on userJoined Teams\r\n */\r\nexport interface UserJoinedTeamsInformation {\r\n  /**\r\n   * List of team information\r\n   */\r\n  userJoinedTeams: TeamInformation[];\r\n}\r\n","import { ensureInitialized } from '../internal/internalAPIs';\r\nimport { FrameContexts } from '../public/constants';\r\nimport { OpenConversationRequest } from '../public/interfaces';\r\nimport { sendMessageToParent } from '../internal/communication';\r\nimport { registerHandler, removeHandler } from '../internal/handlers';\r\n\r\n/**\r\n * Namespace to interact with the conversational subEntities inside the tab\r\n */\r\nexport namespace conversations {\r\n  /**\r\n   * @private\r\n   * Hide from docs\r\n   * --------------\r\n   * Allows the user to start or continue a conversation with each subentity inside the tab\r\n   */\r\n  export function openConversation(openConversationRequest: OpenConversationRequest): void {\r\n    ensureInitialized(FrameContexts.content);\r\n    sendMessageToParent(\r\n      'conversations.openConversation',\r\n      [\r\n        {\r\n          title: openConversationRequest.title,\r\n          subEntityId: openConversationRequest.subEntityId,\r\n          conversationId: openConversationRequest.conversationId,\r\n          channelId: openConversationRequest.channelId,\r\n          entityId: openConversationRequest.entityId,\r\n        },\r\n      ],\r\n      (status: boolean, reason: string) => {\r\n        if (!status) {\r\n          throw new Error(reason);\r\n        }\r\n      },\r\n    );\r\n    if (openConversationRequest.onStartConversation) {\r\n      registerHandler(\r\n        'startConversation',\r\n        (subEntityId: string, conversationId: string, channelId: string, entityId: string) =>\r\n          openConversationRequest.onStartConversation({\r\n            subEntityId,\r\n            conversationId,\r\n            channelId,\r\n            entityId,\r\n          }),\r\n      );\r\n    }\r\n    if (openConversationRequest.onCloseConversation) {\r\n      registerHandler(\r\n        'closeConversation',\r\n        (subEntityId: string, conversationId?: string, channelId?: string, entityId?: string) =>\r\n          openConversationRequest.onCloseConversation({\r\n            subEntityId,\r\n            conversationId,\r\n            channelId,\r\n            entityId,\r\n          }),\r\n      );\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * Hide from docs\r\n   * --------------\r\n   * Allows the user to close the conversation in the right pane\r\n   */\r\n  export function closeConversation(): void {\r\n    ensureInitialized(FrameContexts.content);\r\n    sendMessageToParent('conversations.closeConversation');\r\n    removeHandler('startConversation');\r\n    removeHandler('closeConversation');\r\n  }\r\n}\r\n","import { ensureInitialized } from '../internal/internalAPIs';\r\nimport { SdkError } from '../public/interfaces';\r\nimport { sendMessageToParent } from '../internal/communication';\r\nimport { registerHandler } from '../internal/handlers';\r\n\r\nexport namespace meetingRoom {\r\n  /**\r\n   * @private\r\n   * Hide from docs\r\n   *\r\n   * Data structure to represent a meeting room.\r\n   */\r\n  export interface MeetingRoomInfo {\r\n    /**\r\n     * Endpoint id of the meeting room.\r\n     */\r\n    endpointId: string;\r\n    /**\r\n     * Device name of the meeting room.\r\n     */\r\n    deviceName: string;\r\n    /**\r\n     * Client type of the meeting room.\r\n     */\r\n    clientType: string;\r\n    /**\r\n     * Client version of the meeting room.\r\n     */\r\n    clientVersion: string;\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * Hide from docs\r\n   *\r\n   * Enum used to indicate meeting room capabilities.\r\n   */\r\n  export enum Capability {\r\n    /**\r\n     * Media control capability: toggle mute.\r\n     */\r\n    toggleMute = 'toggleMute',\r\n    /**\r\n     * Media control capability: toggle camera.\r\n     */\r\n    toggleCamera = 'toggleCamera',\r\n    /**\r\n     * Media control capability: toggle captions.\r\n     */\r\n    toggleCaptions = 'toggleCaptions',\r\n    /**\r\n     * Media control capability: volume ajustion.\r\n     */\r\n    volume = 'volume',\r\n    /**\r\n     * Stage layout control capability: show gallery mode.\r\n     */\r\n    showVideoGallery = 'showVideoGallery',\r\n    /**\r\n     * Stage layout control capability: show content mode.\r\n     */\r\n    showContent = 'showContent',\r\n    /**\r\n     * Stage layout control capability: show content + gallery mode.\r\n     */\r\n    showVideoGalleryAndContent = 'showVideoGalleryAndContent',\r\n    /**\r\n     * Stage layout control capability: show laryge gallery mode.\r\n     */\r\n    showLargeGallery = 'showLargeGallery',\r\n    /**\r\n     * Stage layout control capability: show together mode.\r\n     */\r\n    showTogether = 'showTogether',\r\n    /**\r\n     * Meeting control capability: leave meeting.\r\n     */\r\n    leaveMeeting = 'leaveMeeting',\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * Hide from docs\r\n   *\r\n   * Data structure to represent capabilities of a meeting room.\r\n   */\r\n  export interface MeetingRoomCapability {\r\n    /**\r\n     * Media control capabilities, value can be \"toggleMute\", \"toggleCamera\", \"toggleCaptions\", \"volume\".\r\n     */\r\n    mediaControls: string[];\r\n    /**\r\n     * Main stage layout control capabilities, value can be \"showVideoGallery\", \"showContent\", \"showVideoGalleryAndContent\", \"showLargeGallery\", \"showTogether\".\r\n     */\r\n    stageLayoutControls: string[];\r\n    /**\r\n     * Meeting control capabilities, value can be \"leaveMeeting\".\r\n     */\r\n    meetingControls: string[];\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * Hide from docs\r\n   *\r\n   * Data structure to represent states of a meeting room.\r\n   */\r\n  export interface MeetingRoomState {\r\n    /**\r\n     * Current mute state, true: mute, false: unmute.\r\n     */\r\n    toggleMute: boolean;\r\n    /**\r\n     * Current camera state, true: camera on, false: camera off.\r\n     */\r\n    toggleCamera: boolean;\r\n    /**\r\n     * Current captions state, true: captions on, false: captions off.\r\n     */\r\n    toggleCaptions: boolean;\r\n    /**\r\n     * Current main stage layout state, value can be one of \"Gallery\", \"Content + gallery\", \"Content\", \"Large gallery\" and \"Together mode\".\r\n     */\r\n    stageLayout: string;\r\n    /**\r\n     * Current leaveMeeting state, true: leave, false: no-op.\r\n     */\r\n    leaveMeeting: boolean;\r\n  }\r\n  /**\r\n   * @private\r\n   * Hide from docs\r\n   *\r\n   * Fetch the meeting room info that paired with current client.\r\n   * @param callback Callback to invoke when the meeting room info is fetched.\r\n   */\r\n  export function getPairedMeetingRoomInfo(\r\n    callback: (sdkError: SdkError, meetingRoomInfo: MeetingRoomInfo) => void,\r\n  ): void {\r\n    ensureInitialized();\r\n    sendMessageToParent('meetingRoom.getPairedMeetingRoomInfo', callback);\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * Hide from docs\r\n   *\r\n   * Send a command to paired meeting room.\r\n   * @param commandName The command name.\r\n   * @param callback Callback to invoke when the command response returns.\r\n   */\r\n  export function sendCommandToPairedMeetingRoom(commandName: string, callback: (sdkError: SdkError) => void): void {\r\n    if (!commandName || commandName.length == 0) {\r\n      throw new Error('[meetingRoom.sendCommandToPairedMeetingRoom] Command name cannot be null or empty');\r\n    }\r\n    if (!callback) {\r\n      throw new Error('[meetingRoom.sendCommandToPairedMeetingRoom] Callback cannot be null');\r\n    }\r\n    ensureInitialized();\r\n    sendMessageToParent('meetingRoom.sendCommandToPairedMeetingRoom', [commandName], callback);\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * Hide from docs\r\n   *\r\n   * Registers a handler for meeting room capabilities update.\r\n   * Only one handler can be registered at a time. A subsequent registration replaces an existing registration.\r\n   * @param handler The handler to invoke when the capabilities of meeting room update.\r\n   */\r\n  export function registerMeetingRoomCapabilitiesUpdateHandler(\r\n    handler: (capabilities: MeetingRoomCapability) => void,\r\n  ): void {\r\n    if (!handler) {\r\n      throw new Error('[meetingRoom.registerMeetingRoomCapabilitiesUpdateHandler] Handler cannot be null');\r\n    }\r\n    ensureInitialized();\r\n    registerHandler('meetingRoom.meetingRoomCapabilitiesUpdate', (capabilities: MeetingRoomCapability) => {\r\n      ensureInitialized();\r\n      handler(capabilities);\r\n    });\r\n    // handler && Communication.sendMessageToParent('registerHandler', ['meetingRoom.meetingRoomCapabilitiesUpdate']);\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * Hide from docs\r\n   * Registers a handler for meeting room states update.\r\n   * Only one handler can be registered at a time. A subsequent registration replaces an existing registration.\r\n   * @param handler The handler to invoke when the states of meeting room update.\r\n   */\r\n  export function registerMeetingRoomStatesUpdateHandler(handler: (states: MeetingRoomState) => void): void {\r\n    if (!handler) {\r\n      throw new Error('[meetingRoom.registerMeetingRoomStatesUpdateHandler] Handler cannot be null');\r\n    }\r\n    ensureInitialized();\r\n    registerHandler('meetingRoom.meetingRoomStatesUpdate', (states: MeetingRoomState) => {\r\n      ensureInitialized();\r\n      handler(states);\r\n    });\r\n    // handler && Communication.sendMessageToParent('registerHandler', ['meetingRoom.meetingRoomStatesUpdate']);\r\n  }\r\n}\r\n","import { ensureInitialized } from '../internal/internalAPIs';\r\nimport { SdkError } from '../public/interfaces';\r\nimport { FrameContexts } from '../public/constants';\r\nimport { sendMessageToParent } from '../internal/communication';\r\nimport { registerHandler } from '../internal/handlers';\r\n\r\nexport namespace remoteCamera {\r\n  /**\r\n   * @private\r\n   * Hide from docs\r\n   *\r\n   * Data structure to represent patricipant details needed to request control of camera.\r\n   */\r\n  export interface Participant {\r\n    /**\r\n     * Id of participant.\r\n     */\r\n    id: string;\r\n    /**\r\n     * Display name of participant.\r\n     */\r\n    displayName?: string;\r\n    /**\r\n     * Active indicates whether the participant's device is actively being controlled.\r\n     */\r\n    active?: boolean;\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * Hide from docs\r\n   *\r\n   * Enum used to indicate possible camera control commands.\r\n   */\r\n  export enum ControlCommand {\r\n    Reset = 'Reset',\r\n    ZoomIn = 'ZoomIn',\r\n    ZoomOut = 'ZoomOut',\r\n    PanLeft = 'PanLeft',\r\n    PanRight = 'PanRight',\r\n    TiltUp = 'TiltUp',\r\n    TiltDown = 'TiltDown',\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * Hide from docs\r\n   *\r\n   * Data structure to indicate the current state of the device.\r\n   */\r\n  export interface DeviceState {\r\n    /**\r\n     * Alloperationareavailabletoapply.\r\n     */\r\n    available: boolean;\r\n    /**\r\n     * EithercameradoesntsupporttogetstateorItunabletoapplycommand.\r\n     */\r\n    error: boolean;\r\n    /**\r\n     * Resetmaxoutoralreadyapplied.ClientDisableReset.\r\n     */\r\n    reset: boolean;\r\n    /**\r\n     * ZoomInmaxedout.\r\n     */\r\n    zoomIn: boolean;\r\n    /**\r\n     * ZoomOutmaxedout.\r\n     */\r\n    zoomOut: boolean;\r\n    /**\r\n     * PanLeftreachedmaxleft.\r\n     */\r\n    panLeft: boolean;\r\n    /**\r\n     * PanRightreachedmaxright.\r\n     */\r\n    panRight: boolean;\r\n    /**\r\n     * TiltUpreachedtop.\r\n     */\r\n    tiltUp: boolean;\r\n    /**\r\n     * TiltDownreachedbottom.\r\n     */\r\n    tiltDown: boolean;\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * Hide from docs\r\n   *\r\n   * Enum used to indicate the reason for the error.\r\n   */\r\n  export enum ErrorReason {\r\n    CommandResetError,\r\n    CommandZoomInError,\r\n    CommandZoomOutError,\r\n    CommandPanLeftError,\r\n    CommandPanRightError,\r\n    CommandTiltUpError,\r\n    CommandTiltDownError,\r\n    SendDataError,\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * Hide from docs\r\n   *\r\n   * Data structure to indicate the status of the current session.\r\n   */\r\n  export interface SessionStatus {\r\n    /**\r\n     * Whether the far-end user is controlling a  device.\r\n     */\r\n    inControl: boolean;\r\n    /**\r\n     * Reason the  control session was terminated.\r\n     */\r\n    terminatedReason?: SessionTerminatedReason;\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * Hide from docs\r\n   *\r\n   * Enum used to indicate the reason the session was terminated.\r\n   */\r\n  export enum SessionTerminatedReason {\r\n    None,\r\n    ControlDenied,\r\n    ControlNoResponse,\r\n    ControlBusy,\r\n    AckTimeout,\r\n    ControlTerminated,\r\n    ControllerTerminated,\r\n    DataChannelError,\r\n    ControllerCancelled,\r\n    ControlDisabled,\r\n    ControlTerminatedToAllowOtherController,\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * Hide from docs\r\n   *\r\n   * Fetch a list of the participants with controllable-cameras in a meeting.\r\n   * @param callback Callback contains 2 parameters, error and participants.\r\n   * error can either contain an error of type SdkError, incase of an error, or null when fetch is successful\r\n   * participants can either contain an array of Participant objects, incase of a successful fetch or null when it fails\r\n   * participants: object that contains an array of participants with controllable-cameras\r\n   */\r\n  export function getCapableParticipants(\r\n    callback: (error: SdkError | null, participants: Participant[] | null) => void,\r\n  ): void {\r\n    if (!callback) {\r\n      throw new Error('[remoteCamera.getCapableParticipants] Callback cannot be null');\r\n    }\r\n    ensureInitialized(FrameContexts.sidePanel);\r\n    sendMessageToParent('remoteCamera.getCapableParticipants', callback);\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * Hide from docs\r\n   *\r\n   * Request control of a participant's camera.\r\n   * @param participant Participant specifies the participant to send the request for camera control.\r\n   * @param callback Callback contains 2 parameters, error and requestResponse.\r\n   * error can either contain an error of type SdkError, incase of an error, or null when fetch is successful\r\n   * requestResponse can either contain the true/false value, incase of a successful request or null when it fails\r\n   * requestResponse: True means request was accepted and false means request was denied\r\n   */\r\n  export function requestControl(\r\n    participant: Participant,\r\n    callback: (error: SdkError | null, requestResponse: boolean | null) => void,\r\n  ): void {\r\n    if (!participant) {\r\n      throw new Error('[remoteCamera.requestControl] Participant cannot be null');\r\n    }\r\n    if (!callback) {\r\n      throw new Error('[remoteCamera.requestControl] Callback cannot be null');\r\n    }\r\n    ensureInitialized(FrameContexts.sidePanel);\r\n    sendMessageToParent('remoteCamera.requestControl', [participant], callback);\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * Hide from docs\r\n   *\r\n   * Send control command to the participant's camera.\r\n   * @param ControlCommand ControlCommand specifies the command for controling the camera.\r\n   * @param callback Callback to invoke when the command response returns.\r\n   */\r\n  export function sendControlCommand(ControlCommand: ControlCommand, callback: (error: SdkError | null) => void): void {\r\n    if (!ControlCommand) {\r\n      throw new Error('[remoteCamera.sendControlCommand] ControlCommand cannot be null');\r\n    }\r\n    if (!callback) {\r\n      throw new Error('[remoteCamera.sendControlCommand] Callback cannot be null');\r\n    }\r\n    ensureInitialized(FrameContexts.sidePanel);\r\n    sendMessageToParent('remoteCamera.sendControlCommand', [ControlCommand], callback);\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * Hide from docs\r\n   *\r\n   * Terminate the remote  session\r\n   * @param callback Callback to invoke when the command response returns.\r\n   */\r\n  export function terminateSession(callback: (error: SdkError | null) => void): void {\r\n    if (!callback) {\r\n      throw new Error('[remoteCamera.terminateSession] Callback cannot be null');\r\n    }\r\n    ensureInitialized(FrameContexts.sidePanel);\r\n    sendMessageToParent('remoteCamera.terminateSession', callback);\r\n  }\r\n\r\n  /**\r\n   * Registers a handler for change in participants with controllable-cameras.\r\n   * Only one handler can be registered at a time. A subsequent registration replaces an existing registration.\r\n   * @param handler The handler to invoke when the list of participants with controllable-cameras changes.\r\n   */\r\n  export function registerOnCapableParticipantsChangeHandler(\r\n    handler: (participantChange: Participant[]) => void,\r\n  ): void {\r\n    if (!handler) {\r\n      throw new Error('[remoteCamera.registerOnCapableParticipantsChangeHandler] Handler cannot be null');\r\n    }\r\n    ensureInitialized(FrameContexts.sidePanel);\r\n    registerHandler('remoteCamera.capableParticipantsChange', handler);\r\n  }\r\n\r\n  /**\r\n   * Registers a handler for error.\r\n   * Only one handler can be registered at a time. A subsequent registration replaces an existing registration.\r\n   * @param handler The handler to invoke when there is an error from the camera handler.\r\n   */\r\n  export function registerOnErrorHandler(handler: (error: ErrorReason) => void): void {\r\n    if (!handler) {\r\n      throw new Error('[remoteCamera.registerOnErrorHandler] Handler cannot be null');\r\n    }\r\n    ensureInitialized(FrameContexts.sidePanel);\r\n    registerHandler('remoteCamera.handlerError', handler);\r\n  }\r\n\r\n  /**\r\n   * Registers a handler for device state change.\r\n   * Only one handler can be registered at a time. A subsequent registration replaces an existing registration.\r\n   * @param handler The handler to invoke when the controlled device changes state.\r\n   */\r\n  export function registerOnDeviceStateChangeHandler(handler: (deviceStateChange: DeviceState) => void): void {\r\n    if (!handler) {\r\n      throw new Error('[remoteCamera.registerOnDeviceStateChangeHandler] Handler cannot be null');\r\n    }\r\n    ensureInitialized(FrameContexts.sidePanel);\r\n    registerHandler('remoteCamera.deviceStateChange', handler);\r\n  }\r\n\r\n  /**\r\n   * Registers a handler for session status change.\r\n   * Only one handler can be registered at a time. A subsequent registration replaces an existing registration.\r\n   * @param handler The handler to invoke when the current session status changes.\r\n   */\r\n  export function registerOnSessionStatusChangeHandler(handler: (sessionStatusChange: SessionStatus) => void): void {\r\n    if (!handler) {\r\n      throw new Error('[remoteCamera.registerOnSessionStatusChangeHandler] Handler cannot be null');\r\n    }\r\n    ensureInitialized(FrameContexts.sidePanel);\r\n    registerHandler('remoteCamera.sessionStatusChange', handler);\r\n  }\r\n}\r\n","import { sendMessageToParent } from '../internal/communication';\r\nimport { ensureInitialized } from '../internal/internalAPIs';\r\nimport { FileOpenPreference, FrameContexts, SdkError } from '../public';\r\n\r\n/**\r\n * Namespace to interact with the files specific part of the SDK.\r\n *\r\n * @private\r\n * Hide from docs\r\n */\r\nexport namespace files {\r\n  /**\r\n   * @private\r\n   * Hide from docs\r\n   *\r\n   * Cloud storage providers registered with Microsoft Teams\r\n   */\r\n  export enum CloudStorageProvider {\r\n    Dropbox = 'DROPBOX',\r\n    Box = 'BOX',\r\n    Sharefile = 'SHAREFILE',\r\n    GoogleDrive = 'GOOGLEDRIVE',\r\n    Egnyte = 'EGNYTE',\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * Hide from docs\r\n   *\r\n   * Cloud storage provider integration type\r\n   */\r\n  export enum CloudStorageProviderType {\r\n    Sharepoint = 0,\r\n    WopiIntegration = 1,\r\n    Google = 2,\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * Hide from docs\r\n   *\r\n   * Cloud storage folder interface\r\n   */\r\n  export interface CloudStorageFolder {\r\n    /**\r\n     * ID of the cloud storage folder\r\n     */\r\n    id: string;\r\n    /**\r\n     * Display Name/Title of the cloud storage folder\r\n     */\r\n    title: string;\r\n    /**\r\n     * ID of the cloud storage folder in the provider\r\n     */\r\n    folderId: string;\r\n    /**\r\n     * Type of the cloud storage folder provider integration\r\n     */\r\n    providerType: CloudStorageProviderType;\r\n    /**\r\n     * Code of the supported cloud storage folder provider\r\n     */\r\n    providerCode: CloudStorageProvider;\r\n    /**\r\n     * Display name of the owner of the cloud storage folder provider\r\n     */\r\n    ownerDisplayName: string;\r\n    /**\r\n     * Sharepoint specific siteURL of the folder\r\n     */\r\n    siteUrl?: string;\r\n    /**\r\n     * Sharepoint specific serverRelativeUrl of the folder\r\n     */\r\n    serverRelativeUrl?: string;\r\n    /**\r\n     * Sharepoint specific libraryType of the folder\r\n     */\r\n    libraryType?: string;\r\n    /**\r\n     * Sharepoint specific accessType of the folder\r\n     */\r\n    accessType?: string;\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * Hide from docs\r\n   *\r\n   * Cloud storage item interface\r\n   */\r\n  export interface CloudStorageFolderItem {\r\n    /**\r\n     * ID of the item in the provider\r\n     */\r\n    id: string;\r\n    /**\r\n     * Display name/title\r\n     */\r\n    title: string;\r\n    /**\r\n     * Key to differentiate files and subdirectory\r\n     */\r\n    isSubdirectory: boolean;\r\n    /**\r\n     * File extension\r\n     */\r\n    type: string;\r\n    /**\r\n     * Last modifed time of the item\r\n     */\r\n    lastModifiedTime: string;\r\n    /**\r\n     * Display size of the items in bytes\r\n     */\r\n    size: number;\r\n    /**\r\n     * URL of the file\r\n     */\r\n    objectUrl: string;\r\n    /**\r\n     * Temporary access token for the item\r\n     */\r\n    accessToken?: string;\r\n  }\r\n  /**\r\n   * @private\r\n   * Hide from docs\r\n   *\r\n   * Gets a list of cloud storage folders added to the channel\r\n   * @param channelId ID of the channel whose cloud storage folders should be retrieved\r\n   * @param callback Callback that will be triggered post folders load\r\n   */\r\n  export function getCloudStorageFolders(\r\n    channelId: string,\r\n    callback: (error: SdkError, folders: CloudStorageFolder[]) => void,\r\n  ): void {\r\n    ensureInitialized(FrameContexts.content);\r\n\r\n    if (!channelId || channelId.length == 0) {\r\n      throw new Error('[files.getCloudStorageFolders] channelId name cannot be null or empty');\r\n    }\r\n    if (!callback) {\r\n      throw new Error('[files.getCloudStorageFolders] Callback cannot be null');\r\n    }\r\n\r\n    sendMessageToParent('files.getCloudStorageFolders', [channelId], callback);\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * Hide from docs\r\n   *\r\n   * Initiates the add cloud storage folder flow\r\n   * @param channelId ID of the channel to add cloud storage folder\r\n   * @param callback Callback that will be triggered post add folder flow is compelete\r\n   */\r\n  export function addCloudStorageFolder(\r\n    channelId: string,\r\n    callback: (error: SdkError, isFolderAdded: boolean, folders: CloudStorageFolder[]) => void,\r\n  ): void {\r\n    ensureInitialized(FrameContexts.content);\r\n\r\n    if (!channelId || channelId.length == 0) {\r\n      throw new Error('[files.addCloudStorageFolder] channelId name cannot be null or empty');\r\n    }\r\n    if (!callback) {\r\n      throw new Error('[files.addCloudStorageFolder] Callback cannot be null');\r\n    }\r\n\r\n    sendMessageToParent('files.addCloudStorageFolder', [channelId], callback);\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * Hide from docs\r\n   *\r\n   * Deletes a cloud storage folder from channel\r\n   * @param channelId ID of the channel where folder is to be deleted\r\n   * @param folderToDelete cloud storage folder to be deleted\r\n   * @param callback Callback that will be triggered post delete\r\n   */\r\n  export function deleteCloudStorageFolder(\r\n    channelId: string,\r\n    folderToDelete: CloudStorageFolder,\r\n    callback: (error: SdkError, isFolderDeleted: boolean) => void,\r\n  ): void {\r\n    ensureInitialized(FrameContexts.content);\r\n\r\n    if (!channelId) {\r\n      throw new Error('[files.deleteCloudStorageFolder] channelId name cannot be null or empty');\r\n    }\r\n    if (!folderToDelete) {\r\n      throw new Error('[files.deleteCloudStorageFolder] folderToDelete cannot be null or empty');\r\n    }\r\n    if (!callback) {\r\n      throw new Error('[files.deleteCloudStorageFolder] Callback cannot be null');\r\n    }\r\n\r\n    sendMessageToParent('files.deleteCloudStorageFolder', [channelId, folderToDelete], callback);\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * Hide from docs\r\n   *\r\n   * Fetches the contents of a Cloud storage folder (CloudStorageFolder) / sub directory\r\n   * @param folder Cloud storage folder (CloudStorageFolder) / sub directory (CloudStorageFolderItem)\r\n   * @param providerCode Code of the cloud storage folder provider\r\n   * @param callback Callback that will be triggered post contents are loaded\r\n   */\r\n  export function getCloudStorageFolderContents(\r\n    folder: CloudStorageFolder | CloudStorageFolderItem,\r\n    providerCode: CloudStorageProvider,\r\n    callback: (error: SdkError, items: CloudStorageFolderItem[]) => void,\r\n  ): void {\r\n    ensureInitialized(FrameContexts.content);\r\n\r\n    if (!folder || !providerCode) {\r\n      throw new Error('[files.getCloudStorageFolderContents] folder/providerCode name cannot be null or empty');\r\n    }\r\n\r\n    if (!callback) {\r\n      throw new Error('[files.getCloudStorageFolderContents] Callback cannot be null');\r\n    }\r\n\r\n    if ('isSubdirectory' in folder && !folder.isSubdirectory) {\r\n      throw new Error('[files.getCloudStorageFolderContents] provided folder is not a subDirectory');\r\n    }\r\n\r\n    sendMessageToParent('files.getCloudStorageFolderContents', [folder, providerCode], callback);\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * Hide from docs\r\n   *\r\n   * Open a cloud storage file in teams\r\n   * @param file cloud storage file that should be opened\r\n   * @param providerCode Code of the cloud storage folder provider\r\n   * @param fileOpenPreference Whether file should be opened in web/inline\r\n   */\r\n  export function openCloudStorageFile(\r\n    file: CloudStorageFolderItem,\r\n    providerCode: CloudStorageProvider,\r\n    fileOpenPreference?: FileOpenPreference.Web | FileOpenPreference.Inline,\r\n  ): void {\r\n    ensureInitialized(FrameContexts.content);\r\n\r\n    if (!file || !providerCode) {\r\n      throw new Error('[files.openCloudStorageFile] file/providerCode cannot be null or empty');\r\n    }\r\n\r\n    if (file.isSubdirectory) {\r\n      throw new Error('[files.openCloudStorageFile] provided file is a subDirectory');\r\n    }\r\n\r\n    sendMessageToParent('files.openCloudStorageFile', [file, providerCode, fileOpenPreference]);\r\n  }\r\n}\r\n","import { sendMessageToParent } from '../internal/communication';\r\nimport { ensureInitialized } from '../internal/internalAPIs';\r\nimport { FrameContexts, SdkError } from '../public';\r\n\r\n/**\r\n * Namespace to interact with the application entities specific part of the SDK.\r\n *\r\n * @private\r\n * Hide from docs\r\n */\r\nexport namespace appEntity {\r\n  /**\r\n   * @private\r\n   * Hide from docs\r\n   * --------\r\n   * Information on an app entity\r\n   */\r\n  export interface AppEntity {\r\n    /**\r\n     * App ID of the application\r\n     */\r\n    appId: string;\r\n\r\n    /**\r\n     * URL for the application's icon\r\n     */\r\n    appIconUrl: string;\r\n\r\n    /**\r\n     * Content URL for the app entity\r\n     */\r\n    contentUrl: string;\r\n\r\n    /**\r\n     * The display name for the app entity\r\n     */\r\n    displayName: string;\r\n\r\n    /**\r\n     * Website URL for the app entity. It is meant to be opened by the user in a browser.\r\n     */\r\n    websiteUrl: string;\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * Hide from docs\r\n   *\r\n   * Open the Tab Gallery and retrieve the app entity\r\n   * @param threadId ID of the thread where the app entity will be created\r\n   * @param categories A list of app categories that will be displayed in the open tab gallery\r\n   * @param callback Callback that will be triggered once the app entity information is available.\r\n   *                 The callback takes two arguments: the app entity configuration, if available and\r\n   *                 an optional SdkError in case something happened (i.e. the window was closed)\r\n   */\r\n  export function selectAppEntity(\r\n    threadId: string,\r\n    categories: string[],\r\n    callback: (appEntity: AppEntity, sdkError?: SdkError) => void,\r\n  ): void {\r\n    ensureInitialized(FrameContexts.content);\r\n\r\n    if (!threadId || threadId.length == 0) {\r\n      throw new Error('[appEntity.selectAppEntity] threadId name cannot be null or empty');\r\n    }\r\n\r\n    if (!callback) {\r\n      throw new Error('[appEntity.selectAppEntity] Callback cannot be null');\r\n    }\r\n\r\n    sendMessageToParent('appEntity.selectAppEntity', [threadId, categories], callback);\r\n  }\r\n}\r\n","import { sendMessageToParent } from '../internal/communication';\r\nimport { ensureInitialized } from '../internal/internalAPIs';\r\nimport { FrameContexts, SdkError } from '../public';\r\n\r\n/**\r\n * Namespace to interact with the `teams` specific part of the SDK.\r\n *\r\n * @private\r\n * Hide from docs\r\n */\r\nexport namespace teams {\r\n  export enum ChannelType {\r\n    Regular = 0,\r\n    Private = 1,\r\n    Shared = 2,\r\n  }\r\n\r\n  export interface ChannelInfo {\r\n    siteUrl: string;\r\n    objectId: string;\r\n    folderRelativeUrl: string;\r\n    displayName: string;\r\n    channelType: ChannelType;\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * Hide from docs\r\n   *\r\n   * Get a list of channels belong to a Team\r\n   * @param groupId a team's objectId\r\n   */\r\n  export function getTeamChannels(groupId: string, callback: (error: SdkError, channels: ChannelInfo[]) => void): void {\r\n    ensureInitialized(FrameContexts.content);\r\n\r\n    if (!groupId) {\r\n      throw new Error('[teams.getTeamChannels] groupId cannot be null or empty');\r\n    }\r\n\r\n    if (!callback) {\r\n      throw new Error('[teams.getTeamChannels] Callback cannot be null');\r\n    }\r\n\r\n    sendMessageToParent('teams.getTeamChannels', [groupId], callback);\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * Allow 1st party apps to call this function when they receive migrated errors to inform Teams refresh siteurl\r\n   * when site admin renames siteurl.\r\n   * @param threadId ID of the thread where the app entity will be created; if threadId is not\r\n   * provided, the threadId from route params will be used.\r\n   */\r\n  export function refreshSiteUrl(callback: (error: SdkError) => void, threadId?: string): void {\r\n    ensureInitialized();\r\n\r\n    if (!callback) {\r\n      throw new Error('[teams.refreshSiteUrl] Callback cannot be null');\r\n    }\r\n\r\n    sendMessageToParent(threadId);\r\n  }\r\n}\r\n"],"sourceRoot":""}